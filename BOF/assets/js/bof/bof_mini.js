"use strict"
window.bof={isReady:!1,serviceWorker:!1,required_extensions:[{name:"app",path:"app/minified/app.js"},{name:"ui",path:"bof/minified/ui.js",base:"bof_assets"},{name:"becli",path:"bof/minified/becli.js",base:"bof_assets"},{name:"render",path:"bof/minified/render.js",base:"bof_assets"},{name:"cache",path:"bof/helper/minified/cache.js",base:"bof_assets"},{name:"user",path:"bof/helper/minified/user.js",base:"bof_assets"},{name:"chapar",path:"bof/helper/minified/chapar.js",base:"bof_assets"},{path:"https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js",name:"cryptojs",dir:!1,skipNameCheck:!0,version:!1}],loaded_extensions:[],loaded_csses:[],log:function($text,$level,$args){var args=$.extend({css:null},$args);$level=$level===undefined?1:$level;var timeRelativeToStart=(new Date().getTime()-window.bof.startTime)/1000;var logArgs=[];logArgs.push("%c"+(Math.round(timeRelativeToStart*100)/100)+"  ");logArgs.push("color: #aaa");logArgs[0]=logArgs[0]+"%c"+$text;logArgs.push(args.css?args.css:"");console.log.apply($,logArgs)},load:function(){if(window.bof_disable_autoload===!0)
return;var st=new Date().getTime();window.bof.startTime=st;window.bof.waitForJquery().done(function(doneTime){window.bof.log("Awaiting jquery -> Done in "+(doneTime)+" ms");window.bof.waitForServiceWorkers().always(function(doneTime){window.bof.log("Awaiting service workers -> Done in "+(doneTime)+" ms");window.bof.waitForConfig().done(function(doneTime){window.bof.log("Awaiting config -> Done in "+(doneTime)+" ms");$.when(window.bof.waitForDevice(),window.bof.waitForBrowser()).done(function(doneTime){window.bof.log("Awaiting device/browser -> Done in "+(doneTime)+" ms");window.bof.loadExtensions().done(function(doneTime){window.bof.log("Loading Extensions -> Done in "+(doneTime)+" ms");window.bof.ready(window._g._pt(st))}).fail(function(){window.bof.log("Loading Extensions -> Failed")})}).fail(function(){window.bof.log("Awaiting device/browser -> Failed")})}).fail(function(){window.bof.log("Awaiting config -> Failed")})})}).fail(function(){window.bof.log("Awaiting jquery -> Failed")})},waitForJquery:function($reCheck,$promise,$st,$tryCount){$reCheck=$reCheck===!0;$tryCount=!$reCheck?0:$tryCount;if(!$reCheck){var st=new Date().getTime();var promise=$.Deferred()}else{var st=$st;var promise=$promise}
if(window.jQuery){promise.resolve(new Date().getTime()-st)}else if($tryCount>100){promise.reject()}else{setTimeout(function(){window.bof.waitForJquery(!0,promise,st,$tryCount+1)},100)}
return promise},waitForConfig:function(){var st=new Date().getTime();var promise=$.Deferred();$.when(window.bof._loadExtension({name:"config",path:"app/config.js",version:!1,cache:!1}),).done(function(){window.bof._loadExtension({name:"general",path:"bof/helper/general.js",base:"bof_assets"}).done(function(){promise.resolve(new Date().getTime()-st)}).fail(function(){promise.reject()})}).fail(function(){promise.reject()});return promise},waitForDevice:function(){var st=new Date().getTime();var promise=$.Deferred();if(config.platform=="web"){promise.resolve(new Date().getTime()-st)}else{document.addEventListener("deviceready",function(){StatusBar.overlaysWebView(!0);promise.resolve(new Date().getTime()-st)})}
return promise},waitForBrowser:function(){var st=new Date().getTime();var promise=$.Deferred();$(document).ready(function(){promise.resolve(new Date().getTime()-st)});return promise},waitForServiceWorkers:function(){var promise=$.Deferred();window.bof.serviceWorker=promise;if('serviceWorker' in navigator){navigator.serviceWorker.register($_bof_config.web_address+"serviceworker.js").then(reg=>{window.bof.log('SW: Registration Successful');promise.resolve()},reason=>{window.bof.log('SW: Registration Successful:'+reason);promise.reject()})}else{window.bof.log('SW: Registration Failed: Ancient Browser || HTTP Connection');promise.reject()}
return promise},loadExtensions:function(){var st=new Date().getTime()
var extensions_promises=[];for(const required_extension of bof.required_extensions){if(!$_bof_config.production?(required_extension?required_extension.path.includes("minified/"):!1):!1)
required_extension.path=required_extension.path.replace("minified/","")
extensions_promises.push(bof._loadExtension(required_extension));}
var promise=$.Deferred();$.when.apply($,extensions_promises).done(function(){promise.resolve(new Date().getTime()-st)}).fail(function(){promise.reject()});return promise},_loadExtension:function($args){if(!$args.name||!$args.path)
return!1;if($_bof_config.production&&(window[$args.name])){var p=$.Deferred();p.resolve();return p}
$args.dir=$args.dir===undefined?"js":$args.js;$args.base=$args.base?$args.base:"";if(!$args.base&&$args.path.substr(0,4)!="http")
$args.base=$_bof_config.assets_address;if($args.base=="bof_assets")
$args.base=$_bof_config.bof_assets_address;var $version=null;if(Object.keys($args).includes("version"))$version=$args.version;else if(window.config?window.config.version:!1)$version=window.config.version;if($args.cache===!1)$version="dont_cache";if(window.config?(!window.config.production&&$version):!1)$version="dont_cache";var promise=$.Deferred();if(window.bof.loaded_extensions.includes($args.name)){promise.resolve();return promise}
var st=new Date().getTime()
var address=$args.base+($args.dir?$args.dir+"/":"")+$args.path;let scriptUrl=address;if($version){scriptUrl+="?bof_version="+$version;if($version==="dont_cache"&&!address.includes("assets/js/app/config.js")){scriptUrl+="&bof_dont_cache="+st}}
$.ajax({url:scriptUrl,dataType:"script",cache:$version!=="dont_cache"}).done(function(){bof.log("Loading Extension `"+$args.name+"` done in "+(new Date().getTime()-st)+" ms");if(typeof(window[$args.name])==="object"||$args.skipNameCheck===!0){bof.loaded_extensions.push($args.name);promise.resolve();if($args.ini){$args.ini()}}else{bof.log("Failed to set extension: "+$args.name);promise.reject()}}).fail(function(jqxhr,settings,exception){bof.log("Failed to load extension: "+$args.name+" Error: "+exception);promise.reject()});return promise},_loadCSS:function($args){if(!$args.name||!$args.path)
return!1;$args.dir=$args.dir===undefined?"css":$args.js;$args.base=$args.base?$args.base:"";if(!$args.base&&$args.path.substr(0,4)!="http")
$args.base=$_bof_config.assets_address;if($args.base=="bof_assets")$args.base=$_bof_config.bof_assets_address;var $version=null;if(Object.keys($args).includes("version"))$version=$args.version;else if(window.config?window.config.version:!1)$version=window.config.version;if($args.cache===!1)$version="dont_cache";if(window.config?(!window.config.production&&$version):!1)$version="dont_cache";var promise=$.Deferred();if(window.bof.loaded_csses.includes($args.name)){promise.resolve();return promise}
var st=new Date().getTime()
var address=$args.base+($args.dir?$args.dir+"/":"")+$args.path;var css_link=document.createElement('link');css_link.rel="stylesheet";css_link.type="text/css";css_link.href=address+($version?"?bof_version="+$version+($version=="dont_cache"?"&bof_dont_cache="+st:""):"");document.head.appendChild(css_link);promise.resolve();return promise},_isExtensionLoaded:function($name){return window.bof.loaded_extensions.includes($name)},ready:function(doneTime){window.bof.isReady=!0;bof.log("----> Ready in "+doneTime);window.app.events.bof_ready()},}

window.becli={$active_query:!1,$timer:!1,$default_exe_args:{ID:null,liquid:!1,pageAttachment:!1,url:null,type:'json',post:null,timeout:30000,callBack:null,callBack_param:null,callBefore:null,arrayCallback_param:null,background:!0,expectedHeader:200,donePromises:[],sign:!0},cache:{},render_item:function($item,$args){var promise=$.Deferred();var endpoint=$item.endpoint;window.render.mix(endpoint,$args).done(function(renderedData){var new_endpoint=renderedData;promise.resolve(jQuery.extend({endpoint:"false"},$item,{endpoint:new_endpoint}))})
return promise},render_array:function($arr,$args){var promise=$.Deferred();var promises=[];var $new_arr=[];for(var i=0;i<$arr.length;i++){var arr_item=$arr[i];var arr_item_promise=$.Deferred();window.becli.render_item(arr_item,$args).done(function(arr_item_rendered){$new_arr.push(arr_item_rendered);arr_item_promise.resolve()});promises.push(arr_item_promise)}
$.when.apply($,promises).done(function(){promise.resolve($new_arr)});return promise},exe_array:function($arr,$args){var promise=$.Deferred();if(!$arr)
promise.resolve();else{window.becli.render_array($arr,$args).done(function($renderer_arr){var results=[];var promises=[];for(var i=0;i<$renderer_arr.length;i++){var becli_args=$renderer_arr[i];var becli_promise=$.Deferred();becli_args.expectedHeader=!1;becli_args.callBack_param=becli_promise;becli_args.callBack=function(sta,data,$a){if(!sta)
$a.callBack_param.reject();else $a.callBack_param.resolve({args:$a.args,result:data})}
window.becli.exe(becli_args);promises.push(becli_promise)}
$.when.apply($,promises).done(function(){var results_raw=Array.prototype.slice.call(arguments,0);var results={};for(var i=0;i<results_raw.length;i++){var result_raw=results_raw[i];results[result_raw.args.key]=result_raw.result}
promise.resolve(results)}).fail(function(){var results_raw=Array.prototype.slice.call(arguments,0);promise.reject()})})}
return promise},exe:function($args){var promise=$.Deferred();var $a={};var $args_default=becli.$default_exe_args;$args_default.url=window.config.endpoint_address;$args_default.domTarget=$args_default.domTarget=="becli.native_response_handler"?becli.native_response_handler:$args_default.domTarget;for(const[key,default_value]of Object.entries($args_default))
$a[key]=$args[key]===undefined?default_value:$args[key];if($a.ID)$a.ID=$a.ID.toString();$a.args=$args;if(!$a.background&&becli.$active_query)return;if(!$a.background)becli.$active_query=!0;$a.st=window._g._mt();if($args.endpoint)
$a.url=$a.url+$args.endpoint;if($_bof_config?$_bof_config.cfc===!0:!1){var sep="";if(!$a.url.includes("?"))
sep="?";else if($a.url.substr($a.url.length-1)!="?")
sep="&";$a.url=$a.url+sep+"cfc="+Date.now()}
var __build={url:$a.url,type:$a.post?"POST":"GET",data:$a.post,timeout:$a.timeout,beforeSend:function(xhr,s){if($a.sign)
window.becli.sign(xhr,s);$(document).trigger("becli_beforeSend");$("body").addClass("becli_loading");if(typeof($a.domTarget)=="string"){$("body").find($a.domTarget).removeClass("success").removeClass("failure").addClass("loading").html("<div class='text'>Loading</div>")}else if(typeof($a.domTarget)=="function"){var $__ID=Math.random().toString(36).substring(7);$a.waterMarkIDs=[$__ID];$a.domTarget("start",null,null,$a)}
if($a.callBefore){var callBefore_result=null;if(typeof($a.callBefore)=="string"){var passedCallBeforeFunction=$a.callBefore.split(".").reduce((o,k)=>o[k],window);if(typeof(passedCallBeforeFunction)=="function")
callBefore_result=passedCallBeforeFunction($a)}else callBefore_result=$a.callBefore($a)
if(callBefore_result=="BOF_HALT")
xhr.abort();}},success:function(data,status,responseData){$a.dt=window._g._pt($a.st);becli.check_response($a,status,responseData,promise,)},error:function(responseData,status,err){$a.dt=window._g._pt($a.st);if(status!="abort"){console.log(responseData);console.log(status);console.log(err)}
becli.check_response($a,status,responseData,promise,err)},};if($a.type=="file"){__build.contentType=!1;__build.processData=!1}else if($a.type=="json"){__build.dataType='json'}else{__build.dataType='html'}
var xhr_client=$.ajax(__build);if($a.ID){if(Object.keys(window.becli.cache).includes($a.ID)){window.becli.cache[$a.ID].abort();window.becli.cache[$a.ID]=null}
window.becli.cache[$a.ID]=xhr_client}
if($a.liquid!==!0){window.ui.page.cache.becli.push(xhr_client)}
return{client:xhr_client,promise:promise,build:__build,args:$a}},check_response:function($a,status,responseData,promise,err){$("body").removeClass("becli_loading");if(!$a.background)becli.$active_query=!1;if($a.ID?Object.keys(window.becli.cache).includes($a.ID):!1)
delete window.becli.cache[$a.ID]
var sta=(status=="success"||(status=="error"&&err=="Not Found"))&&($a.expectedHeader?responseData.status==$a.expectedHeader:!0);var data=responseData.responseText?responseData.responseText:"Failed";if($a.type=="json"||$a.type=="file"){var decoded=null;try{decoded=JSON.parse(data)}catch(e){decoded=!1}
if(!decoded){if(err=="abort"){promise.reject("aobrt");window.becli.callback($a.callBack,$a,sta,{messages:["Aborted"],aborted:!0});return}else{promise.reject("not_json");window.becli.callback($a.callBack,$a,!1,{messages:["Invalid Json"]});return}}
sta=sta?decoded.success:!1;data=decoded;if(!sta?(decoded.messages?decoded.messages[0]=="403":!1):!1){window.user.setLoginDestination(window.location.href);window.user.loggedOut(!0)}}
if(sta)
promise.resolve({data:data,args:$a});else promise.reject(data[0]?data[0]:err,sta,data);window.bof.log("BECLI: "+$a.url+" ==> "+(sta?"Success":"Failure")+" in "+$a.dt,4,{css:sta?'color:#aaa':'color:red'});if(!sta){console.log($a,status,responseData,err)}
if(typeof($a.domTarget)=="string"){$("body").find($a.domTarget).removeClass("success").removeClass("failure").removeClass("loading").html("<div class='text'>"+data+"</div>");if(sta)$("body").find($a.domTarget).addClass("success");else $("body").find($a.domTarget).addClass("failure")}else if(typeof($a.domTarget)=="function"){$a.domTarget("finish",sta,data,$a)}
if($a.callBack){window.becli.callback($a.callBack,$a,sta,data)}},callback:function($_callback,$a,sta,data){var $continue=null;if(typeof($_callback)=="string"){var passedCallBackFunction=$_callback.split(".").reduce((o,k)=>o[k],window);if(typeof(passedCallBackFunction)=="function"){$continue=passedCallBackFunction(sta,data,$a)}}else if(typeof $_callback=='function')
$continue=$_callback(sta,data,$a);else{console.log("BECLI: invalid callback");console.log($_callback)}},sign:function(xhr,s){var CryptoJSAesJson={stringify:function(cipherParams){var cipherText=cipherParams.ciphertext.toString(CryptoJS.enc.Base64);var cipherIV=cipherParams.iv.toString();var cipherSalt=cipherParams.salt.toString();return{text:cipherText,iv:cipherIV,salt:cipherSalt}},}
if(s?s.data&&s.processData:!1){var l1=CryptoJS.HmacSHA256(s.data,$_bof_config.sign_key);var l2=CryptoJS.MD5(l1.toString());s.data=s.data+"&bof_signature="+l2.toString()}
xhr.setRequestHeader('x-bof-request-code','BusyOwlFrameWorkVersion201');xhr.setRequestHeader('x-bof-platform',window.config.platform);xhr.setRequestHeader('x-bof-version',window.config.version);try{if(window.ui.page.curr().name)
xhr.setRequestHeader('x-bof-page-name',window.ui.page.curr().name);if(window.ui.page.curr().data.becli?(window.ui.page.curr().data.becli.single?window.ui.page.curr().data.becli.single.data:!1):!1)
xhr.setRequestHeader('x-bof-page-ot',window.ui.page.curr().data.becli.single.data.ot);if(window.ui.page.curr().data.becli?(window.ui.page.curr().data.becli.single?window.ui.page.curr().data.becli.single.data:!1):!1)
xhr.setRequestHeader('x-bof-page-hash',window.ui.page.curr().data.becli.single.data.hash);}catch(error){}
if(window.config.platform!="web"){xhr.setRequestHeader('x-bof-device-cordova',device.cordova);xhr.setRequestHeader('x-bof-device-model',device.model);xhr.setRequestHeader('x-bof-device-platform',device.platform);xhr.setRequestHeader('x-bof-device-uuid',device.uuid);xhr.setRequestHeader('x-bof-device-version',device.version);xhr.setRequestHeader('x-bof-device-manufacturer',device.manufacturer);xhr.setRequestHeader('x-bof-device-is-virtual',device.isVirtual);xhr.setRequestHeader('x-bof-device-serial',device.serial)}
if(window.user.logged()){xhr.setRequestHeader('x-bof-sess-id',cache.get("sess_id"));xhr.setRequestHeader('x-bof-sess-key',cache.get("sess_key"))}
if(window.cache.get("push_id"))
xhr.setRequestHeader('x-bof-push-id',window.cache.get("push_id"));if(window.cache.get("ref_code"))
xhr.setRequestHeader('x-bof-ref-code',window.cache.get("ref_code"));if(window.cache.get("language"))
xhr.setRequestHeader('x-bof-language-code',window.cache.get("language"));}}
$(document).on("submit","form.bof",function(e){e.preventDefault();var $__url=$(this).data("url")?$(this).data("url"):undefined;var $__hasFile=$(this).data("hasFile")?!0:!1;var $__type=$(this).data("type")?$(this).data("type"):"json";var $__target=$(this).data("target");var $__endpoint=$(this).data("endpoint");var $__callback=$(this).data("callback");var $__callback_param=$(this).data("callback_param");var $__callbefore=$(this).data("callbefore");var $__formData=null;if($__type=="file"){$__formData=new FormData(this)}else{$__formData=$(this).serialize()}
becli.exe({url:$__url,type:$__type,post:$__formData,callBack:$__callback,callBack_param:$__callback_param,callBefore:$__callbefore,domTarget:$__target,hasFile:$__hasFile,endpoint:$__endpoint,background:!1})})
window.render={mix:function(HtmlData,DataBecli,$args){$args=$args?$args:{};var promise=$.Deferred();window.render._exe.run(HtmlData,DataBecli,promise,{Becli:DataBecli,Bof:{device_width:$(window).width()},Config:window.app.config,UrlData:$args.urlData});return promise},_exe:{has:function(string){if(typeof(string)==="undefined")return!1;return string.indexOf("$bof")>-1},readTheCommandArgs:function(String,DataPool,Args){var command_args=[];var command_e_args={};if(String.split(" ").length>3){var command_args_raw_string=String.split(" ").splice(3).join(" ");var command_args_escaped_strings=command_args_raw_string.match(new RegExp('"(.*?)"','g'));if(command_args_escaped_strings?command_args_escaped_strings.length:!1){for(var i=0;i<command_args_escaped_strings.length;i++){var command_args_escaped_string=command_args_escaped_strings[i];var new_command_args_escaped_string=window.general.replace(command_args_escaped_string," ","BOFBOFBOFBOFBOF");command_args_raw_string=command_args_raw_string.replace(command_args_escaped_string,new_command_args_escaped_string.substr(1,new_command_args_escaped_string.length-2))}
var command_args_with_unedited_escpaed_args=command_args_raw_string.split(" ");for(var i=0;i<command_args_with_unedited_escpaed_args.length;i++){command_args_with_unedited_escpaed_args[i]=window.general.replace(command_args_with_unedited_escpaed_args[i],"BOFBOFBOFBOFBOF"," ")}
command_args=command_args_with_unedited_escpaed_args}else{command_args=command_args_raw_string.split(" ")}
if(command_args){for(var i=0;i<command_args.length;i++){var _dyna_args=command_args[i].match(new RegExp("\#bof (.*?)\#","g"));if(_dyna_args){for(var z=0;z<_dyna_args.length;z++){var _dyna_arg_pointer=_dyna_args[z].substr(5,_dyna_args[z].length-6).split("^");var _dyna_arg_pointer_data=_dyna_arg_pointer.reduce(function(prev,curr){return curr=="?"?prev:(prev?prev[curr]:null)},DataPool);command_args[i]=command_args[i].replace(_dyna_args[z],_dyna_arg_pointer_data)}}
if(command_args[i].split("=").length!=2)continue;var _arg_k=command_args[i].split("=")[0];var _arg_v=command_args[i].split("=")[1];if(_arg_k&&_arg_v)
command_e_args[_arg_k]=_arg_v}}}
return{Args:command_args,Args_e:command_e_args}},readTheBlock:function(String,DataPool,Args){var command_start=String.indexOf("$bof");var command_length=String.substr(command_start+1).indexOf("$")+2;var command_string_raw=String.substr(command_start,command_length);var command_string=String.substr(command_start+1,command_length-2);var command_end=command_start+command_length;var command_type=command_string.split(" ")[1];var command_data_pointer_string=command_string.split(" ")[2];var command_data_pointer_array=command_data_pointer_string.split("^");var command_args_and_argse=window.render._exe.readTheCommandArgs(command_string,DataPool,Args);var command_args=command_args_and_argse.Args;var command_args_e=command_args_and_argse.Args_e
var block_start=command_start;var block_end=null;var block_string=null;if(command_type=="?"||command_type=="html"){block_end=command_end}else{var command_end_string_raw="$!"+command_string+"$";var command_end_start=String.indexOf(command_end_string_raw);var command_end_end=command_end_start+command_end_string_raw.length;block_end=command_end_end;block_string=String.substr(command_end,command_end_start-command_end)}
var block_before=String.substr(0,block_start);var block_after=String.substr(block_end);return{command:{type:command_type,pointer:command_data_pointer_array,string:command_string,args:command_args,args_e:command_args_e},block:{start:block_start,end:block_end,before:block_before,inside:block_string,after:block_after,}}},getPointerData:function(Source,Pointer,rawPool){var requested_arg=["Bof","Becli","Block","Command","Parent","Shared","DataPool","UrlData","Lang","Config"].includes(Pointer[0])?Pointer[0]:!1;var dataPool=requested_arg!==!1||rawPool===!0?Source:Source.DataPool;if(Pointer[0]=="Lang"&&window.lang?window.lang.cache:!1)dataPool.Lang=window.lang.cache;if(typeof(dataPool)!="object"){if(Pointer[0]=="?")
return dataPool}
if(Pointer[0]=="Lang"&1==2){window.becli.exe({endpoint:"client_translations_record",post:{hook:Pointer[1]}})}
var pointer_data=Pointer.reduce(function(prev,curr){return curr=="?"?prev:(prev?prev[curr]:null)},dataPool);return pointer_data},run:function(HtmlPartial,DataPool,Promise,Args){var promise_toFinish_allRuns=Promise;var promise_toFinish_thisRun=$.Deferred();promise_toFinish_thisRun.done(function(_renderedHtml){if(window.render._exe.has(_renderedHtml)){window.render._exe.run(_renderedHtml,DataPool,Promise,Args)}else{promise_toFinish_allRuns.resolve(_renderedHtml)}});if(!window.render._exe.has(HtmlPartial)){promise_toFinish_thisRun.resolve(HtmlPartial)}else{var blockData=window.render._exe.readTheBlock(HtmlPartial,DataPool,Args);Args.Block=blockData.block;Args.Command=blockData.command;Args.DataPool=DataPool;Args.Shared=Args.Shared?Args.Shared:{};var pointerData=window.render._exe.getPointerData(Args,blockData.command.pointer);Args.Pointer=pointerData;window.render._exe.runTheBlock(pointerData,Args).done(function(_renderedBlock){promise_toFinish_thisRun.resolve(_renderedBlock)})}
return promise_toFinish_thisRun},runTheBlock:function(PointerData,Args){var promise_toFinish_block=$.Deferred();var promise_toFinish_command=null;if(Args.Command.type=="?")
promise_toFinish_command=window.render._exe.runTheBlock_basic(PointerData,Args);else if(Args.Command.type=="foreach")
promise_toFinish_command=window.render._exe.runTheBlock_foreach(PointerData,Args);else if(Args.Command.type=="if")
promise_toFinish_command=window.render._exe.runTheBlock_if(PointerData,Args);else if(Args.Command.type=="html")
promise_toFinish_command=window.render._exe.runTheBlock_html(PointerData,Args);var ID=window._g._mt();promise_toFinish_command.done(function(_renderedCommand){var newBlockData=Args.Block.before+_renderedCommand+Args.Block.after;window.testt=window.testt+window._g.passed_time(ID);promise_toFinish_block.resolve(newBlockData.trim())});return promise_toFinish_block},runTheBlock_basic:function(PointerData,Args){var promise=$.Deferred();var _args=Args.Command.args_e;var displayData=!1;if(typeof(PointerData)=="object"){displayData=JSON.stringify(PointerData)}else{displayData=PointerData;if(_args.__turn&&displayData&&typeof(displayData)=="string")
displayData=window.lang.return(displayData)
if(_args.__uc&&displayData&&typeof(displayData)=="string")
displayData=displayData.charAt(0).toUpperCase()+displayData.slice(1);}
if((displayData&&PointerData)||(displayData==0&&PointerData==0)){promise.resolve(displayData)}else{promise.resolve("")}
return promise},runTheBlock_foreach:function(PointerData,Args){var promise=$.Deferred();var promiseEachs=[];if(PointerData){PointerData=Object.values(PointerData);for(var i=0;i<PointerData.length;i++){var promiseEach=$.Deferred();var eachData=PointerData[i];window.render._exe.run(Args.Block.inside,eachData,promiseEach,{Becli:Args.Becli,Bof:Args.Bof,Parent:Args,Shared:Object.keys(Args.Command.args_e).length?$.extend(Args.Shared,Args.Command.args_e):Args.Shared});promiseEachs.push(promiseEach)}
$.when.apply($,promiseEachs).done(function(){var foreachs_results=Array.prototype.slice.call(arguments,0);promise.resolve(promiseEachs.length==1?foreachs_results:foreachs_results.join("\n"))})}else{promise.resolve("")}
return promise},runTheBlock_if:function(PointerData,Args){var promise=$.Deferred();var _cond=Args.Command.args[0]?Args.Command.args[0]:"exists";var _eval=Args.Command.args[1];if(_eval?_eval.substr(0,4)=="BOF_":!1){_eval=window.render._exe.getPointerData(Args,_eval.substr(4).split("^"),!0)}
var checkedOut=!1;if(_cond=="="){if(_eval==PointerData)
checkedOut=!0}
if(_cond=="!="){if(_eval!=PointerData)
checkedOut=!0}
if(_cond=="+"){if(PointerData){if(typeof(PointerData)=="object")
checkedOut=Object.keys(PointerData).length>0
else if(PointerData!=0&&PointerData!="0")
checkedOut=!0}}
if(_cond=="-"){if(!PointerData){checkedOut=!0}}
if(_cond=="in_array"){if(typeof(_eval)==="string")_eval=[_eval];if(_eval?_eval.indexOf(PointerData)>-1:!1)
checkedOut=!0}
if(_cond=="false"){if(PointerData==!1||PointerData===undefined)
checkedOut=!0}
if(_cond=="exists"){if(PointerData){if(typeof(PointerData)=="object")
checkedOut=Object.keys(PointerData).length>0
else checkedOut=!0}}
if(checkedOut){window.render._exe.run(Args.Block.inside,PointerData,promise,{Becli:Args.Becli,Bof:Args.Bof,Parent:Args,Shared:Object.keys(Args.Command.args_e).length?$.extend(Args.Shared,Args.Command.args_e):Args.Shared})}else{promise.resolve("")}
return promise},runTheBlock_html:function(PointerData,Args){var promise=$.Deferred();var _args=Args.Command.args_e;var base=$_bof_config.assets_address;if(_args.__base=="endpoint")
base=$_bof_config.endpoint_address;else if(_args.__base)
base=_args.__base;window.ui.theme.part(_args.__path?_args.__path:"parts/"+_args.__name,{target:!1,dir:_args.__dir=="no"?!1:"theme",base:base,use_base:_args.__use_base==="no"?!1:!0}).done(function(_htmlData){window.render._exe.run(_htmlData,PointerData,promise,{Becli:Args.Becli,Bof:Args.Bof,Parent:Args,Shared:Object.keys(Args.Command.args_e).length?$.extend(Args.Shared,Args.Command.args_e):Args.Shared})}).fail(function(err){window.bof.log("Render.BlockHTML Failure");console.log(err)});return promise}}}
window.ui={page:{name:!1,args:null,data:{},cache:{becli:[]},set:function($name,$args){window.ui.page.name=$name;window.ui.page.args=$args},add_data:function($key,$val){window.ui.page.data[$key]=$val},get_data:function($key){return window.ui.page.data[$key]},curr:function(){return{name:window.ui.page.name,o_args:window.app.pages[window.ui.page.name],u_args:window.ui.page.args,args:$.extend(window.app.pages[window.ui.page.name],window.ui.page.args),data:window.ui.page.data,cache:window.ui.page.cache,stateID:window.ui.history._state,stateData:window.ui.history.get()}},event:function($page,$event,$args){if(typeof($page)==="string")
$page=window.app.pages[$page];var $promise=$.Deferred();var $nativePromise=$.Deferred();var $pagePromise=$.Deferred();var $globPromise=$.Deferred();$(document).trigger("ui_page_event",{event:$event,page:$page})
if($page?$page.events[$event]:!1){var event_holder=$page.events[$event];var pageEvent=null;if(typeof(event_holder)=="string"){var event_holder_parsed=event_holder.split(".").reduce(function(prev,curr){if(prev)
return prev[curr]},window);if(event_holder_parsed)
pageEvent=event_holder_parsed($args);}else{pageEvent=event_holder($args)}
if(pageEvent!==null&&typeof(pageEvent)=="object"){pageEvent.done(function(eventResult){$pagePromise.resolve(eventResult)}).fail(function(eventErr){$pagePromise.reject(eventErr)})}else{$pagePromise.resolve(pageEvent)}}else{$pagePromise.resolve("none")}
if(window.app.events["page_"+$event]){var globEvent=window.app.events["page_"+$event]($args);if(typeof(globEvent)=="object"){globEvent.done(function(eventResult){$globPromise.resolve(eventResult)}).fail(function(eventErr){$globPromise.reject(eventErr)})}else{$globPromise.resolve(globEvent)}}else{$globPromise.resolve("none")}
if($event=="ready"){if(window.location.hash){var Hash=window.location.hash.substr(1);if($(document).find("#"+Hash).length)
$(document).find("#main").scrollTop($(document).find("#"+Hash).offset().top);}}
if($event=="preloading"){if($page?$page.extenders:!1){var $extenders_promises=[];for(var $i=0;$i<Object.keys($page.extenders).length;$i++){var $extender_k=Object.keys($page.extenders)[$i];var $extender=$page.extenders[$extender_k];$extenders_promises.push(window.app._extension_new($extender_k,$extender,!0))}
$.when.apply($,$extenders_promises).done(function(){$nativePromise.resolve()}).fail(function(){$nativePromise.reject()})}else{$nativePromise.resolve()}}else{$nativePromise.resolve()}
$.when($nativePromise,$pagePromise,$globPromise).done(function($nativeResult,$pageResult,$globResult){$promise.resolve({page:$pageResult,glob:$globResult,native:$nativeResult})}).fail(function($nativeError,$pageError,$globError){$promise.reject({page:$pageError,glob:$globError,native:$nativeError})})
return $promise},load:function($name,$args){$args=$args?$args:{};$args.name=$name;var promise=$.Deferred();var currentPage=window.app.pages[window.ui.page.name];var requestedPage=window.app.pages[$name];window.ui.lock.on($name);window.ui.page.event(currentPage,"unloading",$args).done(function(){window.ui.page.abortConnections();window.ui.page.event(requestedPage,"preloading",$args).done(function(){$.when(window.ui.theme.load(requestedPage.theme_file,requestedPage.theme_args),window.becli.exe_array(requestedPage.becli,$args)).done(function(themeLoadResult,becliExeResult){window.ui.page.add_data("becli",becliExeResult);window.ui.page.event(requestedPage,"rendering",$args).done(function(){window.render.mix(themeLoadResult,window.ui.page.get_data("becli"),$args).done(function(renderingResult){window.ui.page.event(requestedPage,"displaying",$args).done(function(){window.ui.page.display(renderingResult,$args).done(function(){window.ui.page.event(requestedPage,"loaded",$args).done(function(){window.ui.page.event(currentPage,"unloaded",$args).fail(function(currentPageUnloadedFailReason){promise.reject("currentPageUnloadedFailReason: "+currentPageUnloadedFailReason)});window.ui.page.set($name,$args);window.ui.lock.off($name);window.ui.body.setClasses();if($args.history!==!1&&requestedPage.ignore_history!==!0){window.ui.history.add();$(document).find("#main").scrollTop(0)}else if(requestedPage.ignore_history_restore!==!0){window.ui.history._state=$args.stateID
window.ui.history.restoreState()}
window.ui.page.event(requestedPage,"ready",$args).fail(function(requestedPageReadyFailReason){promise.reject("requestedPageReadyFailReason: "+requestedPageReadyFailReason)});promise.resolve();window.bof.log("UI.page.load: Done loading "+$name)}).fail(function(requestedPageLoadedFailedReason){promise.reject("requestedPageLoadedFailedReason: "+requestedPageLoadedFailedReason)})}).fail(function(){})}).fail(function(requestedPageDisplayingFailedReason){promise.reject("requestedPageDisplayingFailedReason: "+requestedPageDisplayingFailedReason)})}).fail(function(){})}).fail(function(requestedPageRenderingFailedReason){promise.reject("requestedPageRenderingFailedReason: "+requestedPageRenderingFailedReason.native)})}).fail(function(){promise.reject("Ui.Page.Load: becli&theme failed: "+JSON.stringify(Array.prototype.slice.call(arguments,0)))})}).fail(function(requestedPagePreloadingFailedReason){promise.reject("requestedPagePreloadingFailedReason: "+requestedPagePreloadingFailedReason)})}).fail(function(currPageUnloadingFailedReason){promise.reject("currPageUnloadingFailedReason: "+currPageUnloadingFailedReason)})
promise.fail(function(Reason){window.bof.log(Reason);window.ui.lock.off($name);$("body").trigger("ui_page_load_failure",{name:$name,reason:Reason,args:$args})});return promise},reload:function(){var cur_args=window.ui.page.curr().u_args;cur_args=cur_args?cur_args:{};return window.ui.page.load(window.ui.page.name,$.extend(cur_args,{history:!1,stateID:window.ui.page.curr().stateID}))},display:function(content,$args){$("body #main .content").html(content);var promise=$.Deferred();promise.resolve();return promise},abortConnections:function(){if(!window.ui.page.cache.becli)return;for(var i=0;i<window.ui.page.cache.becli.length;i++){var _page_a=window.ui.page.cache.becli[i];_page_a.abort()}
window.ui.page.cache.becli=[]},},lock:{activeLocks:[],on:function($name){if(window.ui.lock.activeLocks.length==0){window.app.events.lock.first_on($name);window.ui.body.addClass("loading",!0)}
window.ui.lock.activeLocks.push($name);window.app.events.lock.on($name)},off:function($name){window.ui.lock.activeLocks=jQuery.grep(window.ui.lock.activeLocks,function(value){return value!=$name});window.app.events.lock.off($name);if(window.ui.lock.activeLocks.length==0){window.app.events.lock.all_off($name);window.ui.body.removeClass("loading",!0)}},offAll:function(){window.ui.lock.activeLocks=[];window.app.events.lock.all_off();window.ui.body.removeClass("loading",!0)}},history:{_state:null,_states:{},listen:function(){window.onpopstate=function(e){if(window.app.events.historyPopState){if(window.app.events.historyPopState()=="HALT"){e.preventDefault();e.stopPropagation();return!1}}
if($("body").hasClass("active_modal")){window.bof_modal.close();e.preventDefault();e.stopPropagation();return!1}
var stateData=null;if(e.state?e.state.ID:!1)
stateData=window.ui.history.get(e.state.ID);if(stateData){window.ui.link.navigate(stateData.link,{history:!1,stateID:e.state?e.state.ID:!1,})}
e.stopPropagation();return!1}},add:function($link,$title){var link=window.ui.page.curr().args.link;var title=window.ui.page.curr().args.title;var title_hook=window.ui.page.curr().args.title_hook;if(window.ui.page.curr().args.urlData)
link=window.ui.page.curr().args.urlData.url.full;if($link)link=$link;if($title)title=$title;if(window.ui.page.curr().data.becli?(window.ui.page.curr().data.becli.single?(window.ui.page.curr().data.becli.single.seo):!1):!1){title=window.ui.page.curr().data.becli.single.seo.title}
if(window.ui.page.curr().data.becli?(window.ui.page.curr().data.becli.upload?(window.ui.page.curr().data.becli.upload.seo):!1):!1){title=window.ui.page.curr().data.becli.upload.seo.title}
if(window.ui.page.curr().data.becli?(window.ui.page.curr().data.becli.auth?(window.ui.page.curr().data.becli.auth.title):!1):!1){title=window.ui.page.curr().data.becli.auth.title}
var ID=window._g._mt()+"_"+(link&&link!==!0?link.substr(link.length-6):"")+"_"+Math.round(Math.random()*1000);if(!title&&title_hook)
title=window.lang.return(title_hook,{ucfirst:!0})
window.ui.history._states[ID]={link:link,title:title,time:window._g._mt()};window.history.pushState({ID:ID},title,window.config.platform=="web"&&typeof(link)==="string"?link:null);document.title=title;window.ui.history._state=ID;return ID},record:function(Var,Val,StateID){if(window.ui.history._states[StateID?StateID:window.ui.history._state])
window.ui.history._states[StateID?StateID:window.ui.history._state][Var]=Val},get:function(StateID){return window.ui.history._states[StateID?StateID:window.ui.history._state]},hasPre:function(StateID){StateID=StateID?StateID:window.ui.history._state;return Object.keys(window.ui.history._states).indexOf(window.ui.history._state)>0},removePre:function(StateID){StateID=StateID?StateID:window.ui.history._state;if(Object.keys(window.ui.history._states).indexOf(window.ui.history._state)>0){var keys=Object.keys(window.ui.history._states);var preKey=keys[keys.indexOf(window.ui.history._state)-1];delete window.ui.history._states[preKey]}},restoreState:function(){var state=window.ui.history.get();if(state.scrollTop)
$(document).find("#main").scrollTop(state.scrollTop);}},theme:{_loading:{},_cached:{},load:function($path,$args){$args=$args?$args:{};$args.extension=$args.extension?$args.extension:"html";$args.dir=$args.dir?$args.dir:!1;$args.base=$args.base?$args.base:"theme";$args.use_base=$args.use_base===!1?!1:!0;$args.reload=$args.reload===!0;var promise=$.Deferred();if(Object.keys(window.ui.theme._cached).includes($path)&&!$args.reload){promise.resolve(window.ui.theme._cached[$path]);return promise}
if(Object.keys(window.ui.theme._loading).includes($path))
return window.ui.theme._loading[$path];window.ui.theme._loading[$path]=promise;var $version=null;if(Object.keys($args).includes("version"))$version=$args.version;else if(window.config?window.config.version:!1)$version=window.config.version;if($args.cache===!1)$version="dont_cache";if(window.config?(!window.config.production&&$version):!1)$version="dont_cache";$.ajax({url:($args.use_base?$args.base+"/":"")+($args.dir?$args.dir+"/":"")+$path+"."+$args.extension+($version?("?bof_version="+$version+($version=="dont_cache"?"&bof_dont_cache="+new Date().getTime():"")):""),timeout:10000}).done(function(data){window.ui.theme._cached[$path]=data;promise.resolve(data);delete window.ui.theme._loading[$path]}).fail(function(){promise.reject("Loading "+$path+" failed");window.bof.log("Ui.Theme.Load: Loading "+$path+" failed")});return promise},part:function($path,$args){var promise=$.Deferred();$args=$args?$args:{};$args=$.extend({target:"body"},$args);window.ui.theme.load($path,$args).done(function(loadedPart){if($args.render){window.render.mix(loadedPart,{}).done(function(loadedPartParsed){if($args.target)
$($args.target).prepend("<div class='bof_part'>"+loadedPartParsed+"</div>");promise.resolve(loadedPartParsed)})}else{if($args.target)
$($args.target).prepend("<div class='bof_part'>"+loadedPart+"</div>");promise.resolve(loadedPart)}});return promise}},body:{_classes:["unloaded","splash"],getClasses:function(){var classes=window.ui.body._classes;var bodyClasses=window.ui.page.curr().args.body_class;if(bodyClasses)classes=classes.concat(bodyClasses);if(window.ui.page.curr().data?(window.ui.page.curr().data.becli?(window.ui.page.curr().data.becli.single?(window.ui.page.curr().data.becli.single.page?window.ui.page.curr().data.becli.single.page.classes:!1):!1):!1):!1){var pageClasses=window.ui.page.curr().data.becli.single.page.classes;if(pageClasses)classes=classes.concat(pageClasses);}
var logged=window.user.logged();if(logged)classes=classes.concat("logged");else classes=classes.concat("notLogged");return classes.concat(["page_"+window.ui.page.name])},setClasses:function(){var classes=window.ui.body.getClasses();$("body").attr("class",classes.join(" "))},addClass:function($name,$permanent){if(!$("body").hasClass($name))
$("body").addClass($name);if($permanent&&!window.ui.body._classes.includes($name))
window.ui.body._classes.push($name);return window.ui.body},removeClass:function($name,$permanent){if($("body").hasClass($name))
$("body").removeClass($name);if($permanent&&window.ui.body._classes.includes($name))
window.ui.body._classes=jQuery.grep(window.ui.body._classes,function(value){return value!=$name});return window.ui.body},removeSplashClasses:function(){window.ui.body.removeClass("splash",!0);window.ui.body.removeClass("unloaded",!0)},},link:{listen:function(){$(document).on("click","a",function(e){if($(this).attr("target")=="_blank")
return!0;var $url=$(this).attr("href");if($url?$url.startsWith("mailto:"):!1)
return!0;if($url?($url.substr(0,'http'.length)=='http'?$url.substr(0,window.config.web.address.length)!=window.config.web.address:!1)||$url.endsWith(".pdf"):!1){e.stopPropagation();window.open($url,'_blank').focus();return!1}
e.stopPropagation();window.ui.link.navigate($url);return!1})},navigate:function($url,$args){$args=$args?$args:{};var url_parsed=window.ui.link.parse($url);if(!url_parsed)return;return window.ui.page.load(url_parsed.page,$.extend({urlData:url_parsed},$args))},parse:function($url){if(!$url)
return;if($url.substr(0,window.config.web.address.length)==window.config.web.address)
$url=$url.substr(window.config.web.address.length)
if($url.substr(0,'http'.length)=='http')
return;var $base_url_parsed=new URL(window.config.web.address);var $base_sub_folder=$base_url_parsed.pathname!="/"?$base_url_parsed.pathname.substr(1):!1;var $full_url=window.config.web.address+$url;var $parsed_url=new URL($full_url);var $requested_path=$parsed_url.pathname.substr(1);if($base_sub_folder?$base_sub_folder==$requested_path.substr(0,$base_sub_folder.length):!1){$requested_path=$requested_path.substr($base_sub_folder.length)}
var $requested_queries=Object.fromEntries($parsed_url.searchParams.entries());var $requested_queries_string="";if($requested_queries){var $requested_queries_OBJ=new URLSearchParams($requested_queries);$requested_queries_string=$requested_queries_OBJ.toString()}
var pages=window.app.pages;for(var i=0;i<Object.keys(pages).length;i++){var page_name=Object.keys(pages)[i];var page_args=pages[page_name];if(!page_args.url)continue;var regExp=new RegExp(page_args.url,"i");var matchRegExp=$requested_path.match(regExp);if(matchRegExp&&page_args.url!==!0){return{url:{full:$url,path:$requested_path,query:$requested_queries,query_s:$requested_queries_string,match:matchRegExp.splice(1),hash:$parsed_url.hash},page:page_name}}}
return!1}},pull_up:{listen:function(){$(document).on("mousedown",function(ev){if($("#main").scrollTop()>0)
return;var iniY=ev.pageY;$(document).on("mousemove",function(e){var movementY=e.pageY-iniY;if(movementY>0){window.ui.pull_up.checkMovement(movementY)}})});$(document).on("mouseup",function(){window.ui.pull_up.stopListeningToMovement()});$(document).on("mouseleave",function(){window.ui.pull_up.stopListeningToMovement()});$(document).on("touchstart",function(ev){if($("#main").scrollTop()>0)
return;var iniY=ev.touches[0].pageY;$(document).on("touchmove",function(e){var movementY=e.touches[0].pageY-iniY;if(movementY>0){window.ui.pull_up.checkMovement(movementY)}})});$(document).on("touchend",function(){window.ui.pull_up.stopListeningToMovement()});$(document).on("touchcancel",function(){window.ui.pull_up.stopListeningToMovement()})},checkMovement:function($movementY){if($("body").hasClass("reloading"))
return;if($movementY>=100){$("body").addClass("reloading");window.ui.page.reload().done(function(){$("body").removeClass("reloading")});window.ui.pull_up.stopListeningToMovement();return}
$("body").css("margin-top",$movementY+"px");$("#reloader").css("height",$movementY+"px")},stopListening:function(){window.ui.pull_up.stopListeningToMovement();$(document).unbind("mousedown");$(document).unbind("mouseup");$(document).unbind("mouseleave");$(document).unbind("touchstart");$(document).unbind("touchend");$(document).unbind("touchcancel")},stopListeningToMovement:function(){$("body").css("margin-top","0px");$("#reloader").css("height","0px");$(document).unbind("mousemove");$(document).unbind("touchmove")},},}
window.cache={set:function(name,value,acceptZero){if(!value)
return window.cache.remove(name);return window.localStorage.setItem(window.config.cache_prefix+name,value)},get:function(name,defaultValue){defaultValue=defaultValue?defaultValue:!1;var output=!1;output=window.localStorage.getItem(window.config.cache_prefix+name);if(output)return output;return defaultValue},remove:function(name){return window.localStorage.removeItem(window.config.cache_prefix+name)},removeAll:function(){return window.localStorage.clear()}}
window.chapar={push_supported:function(){if(!'Notification' in window||!("ServiceWorker" in window)||!window.app.config.setting.vapid_public){window.bof.log("--> Push notification not supported",5,{css:"color:red"});return!1}
window.bof.log("--> Push notification supported");return!0},push_check:function(){if('Notification' in window?Notification.permission==='granted'&&window.cache.get("push_enabled"):!1){window.bof.log("--> Push notification registered");return!0}
window.bof.log("--> Push notification not registered");return!1},push_suggest_registering:function(){var dont_suggest=window.cache.get("push_dont_suggest",!1);if(!dont_suggest)
return!0;if('Notification' in window?Notification.permission!=='denied':!1)
return!1;if(window._g._mt()-dont_suggest>(6*60*60*1000))
return!0;return!1},push_register:function(){if(!window.chapar.push_supported())
return;if(!window.user.logged()){window.ui.link.navigate("userAuth")
return}
if(Notification.permission!=='granted'){Notification.requestPermission().then((permission)=>{if(permission==="granted"){window.chapar.push_register()}});return}
navigator.serviceWorker.ready.then(function(registration){return registration.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:window.app.config.setting.vapid_public,})}).then(function(pushSubscription){window.becli.exe({endpoint:"user_push_register",post:{push_subscription:JSON.stringify(pushSubscription)},callBack:function(sta,data){if(sta){window.app.becli.alert(!0,window.lang.return("activated",{ucfirst:!0}));window.cache.set("push_enabled",!0);$(document).find(".chapar_msgs .chapar_register").remove();$(document).find(".chapar_msgs").addClass("push_enabled")}}})})},load_messages:function($args){$args=$.extend({page:1,type:"list"},$args);if($args.type=="list"){$(document).find(".chapar_msgs").addClass("loading");$(document).find(".chapar_msgs .list").html("<div class='ph_skel_wrapper ph_ts'>\
        <div class='skel'><div class='avatar'></div><div class='line'></div></div>\
        <div class='skel'><div class='avatar'></div><div class='line'></div></div>\
        <div class='skel'><div class='avatar'></div><div class='line'></div></div>\
      </div>")}
window.becli.exe({liquid:!0,endpoint:"user_chapar",post:{page:$args.page,type:$args.type},callBack:function(sta,data){if(data.type=="list"){$(document).find(".chapar_msgs").removeClass("loading has_unseen").addClass("loaded");if(sta?(data?(data.items?data.items.length:!1):!1):!1){var nots_html="";nots_html+="<div id='chapar_list'>";for(var z=0;z<data.items.length;z++){var not=data.items[z];if(!not)continue;nots_html+="<div class='payam_wrapper'>";nots_html+="<div class='payam type_"+not.type+" img_"+(not.image?"yes":"no")+" seen_"+(not.seen?"yes":"no")+"' data-link='"+not.link+"'>";if(not.image)nots_html+="<div class='img_wrapper'><img src='"+not.image+"'></div>";nots_html+="<div class='c'>"+not.title+"</div>";nots_html+="<div class='time'>"+not.time+"</div>";nots_html+="</div>";nots_html+="</div>"}
nots_html+="</div>";if(data.has_more){nots_html+="<div class='more chapar_more' data-page='"+data.has_more+"'>"+window.lang.return("more",{ucfirst:!0})+"</div>"}
$(document).find(".chapar_msgs .list").html(nots_html)}else{$(document).find(".chapar_msgs .list").html("<div class='empty'>\
              <span class='mdi mdi-emoticon-sad-outline'></span>\
              <span class='_t'>"+window.lang.return("msngr_nada",{ucfirst:!0})+"</span>\
              <span class='_te'>"+window.lang.return("msngr_nada_tip",{ucfirst:!0})+"</span>\
            </div>")}}
$(document).find(".chapar_menu_wrapper").removeClass("has_unseen").find("._count").remove();if(sta?data.unseen:!1){$(document).find(".chapar_menu_wrapper").addClass("has_unseen").append("<span class='_count'>"+data.unseen+"</span>")
$(document).find(".chapar_msgs").addClass("has_unseen")}}})},listen:function(){$(document).on("click",".dropdown_button.chapar_menu_wrapper",function(){var push_supported=window.chapar.push_supported();var push_enabled=window.chapar.push_check();var push_suggest_registering=push_enabled||!push_supported?!1:window.chapar.push_suggest_registering();$(document).find(".chapar_msgs").removeClass("push_supported push_enabled push_suggest_registering loaded").addClass("loading");if(push_supported)$(document).find(".chapar_msgs").addClass("push_supported")
if(push_enabled)$(document).find(".chapar_msgs").addClass("push_enabled")
if(push_suggest_registering)$(document).find(".chapar_msgs").addClass("push_suggest_registering")
if(window.user.logged())
window.chapar.load_messages();else{$(document).find(".chapar_msgs").addClass("not_logged");$(document).find(".chapar_msgs .list").html("<div class='empty'>\
          <span class='mdi mdi-emoticon-sad-outline'></span>\
          <span class='_t'>"+window.lang.return("msngr_nada",{ucfirst:!0})+"</span>\
          <span class='_te'>"+window.lang.return("msngr_nada_tip",{ucfirst:!0})+"</span>\
        </div>")}});$(document).on("click",".chapar_msgs #chapar_list .payam_wrapper",function(){var payam=$(this).find(".payam");if(payam){var link=payam.data("link");if(link){window.ui.link.navigate(link)}}});$(document).on("click",".chapar_msgs .more.chapar_more",function(){var newPage=$(document).find(".chapar_msgs .more.chapar_more").data("page");window.chapar.load_messages({page:newPage})});$(document).on("click",".chapar_msgs.has_unseen .titles ._maar",function(){window.chapar.load_messages({type:"set",})});$(document).on("click",".chapar_msgs .chapar_register ._actions ._act#chapar_do_register",function(){window.chapar.push_register()});$(document).on("click",".chapar_msgs.push_supported.push_enabled .titles ._ic.push._en",function(){window.chapar.push_register()});$(document).on("click",".chapar_msgs .chapar_register ._actions ._act.later",function(){$(document).find(".chapar_msgs .chapar_register").remove();$(document).find(".chapar_msgs").removeClass("push_suggest_registering");window.cache.set("push_dont_suggest",window._g._mt())});if(window.user.logged())
window.chapar.load_messages({type:"get"})
window.chapar.sw()},sw:function(){window.bof.log("Chapar:SW: Checking",4,{css:'color:#ccc'});if(window.chapar.push_check()){var DB=localforage.createInstance({name:"chapar"});DB.getItem("sw_new").then(item=>{if(item==="yes"){DB.setItem("sw_new","no");if(window.user.logged()){window.chapar.load_messages({type:"get"})}}})}else if(window.user.logged()){window.chapar.load_messages({type:"get"})}
setTimeout(function(){window.chapar.sw()},5*60*1000)},}
window.general={round:function($int,$percision){if($percision===0||$percision==="0"||$percision===!1||$percision===null||$percision===undefined)
return Math.round($int);else if($percision>0)
return Math.round(($int)*Math.pow(10,$percision))/Math.pow(10,$percision)
else return Math.round(($int)/Math.pow(10,$percision))*Math.pow(10,$percision)},rand:function($min,$max){$min=$min===undefined||$min===null?1:$min;$max=$max===undefined||$max===null?1:$max;return Math.floor(Math.random()*($max-$min+1)+$min)},milli_time:function(){return new Date().getTime()},passed_time:function($start_in_milli){return window.general.milli_time()-$start_in_milli},passed_time_hr:function($start_in_milli,$prefered_unit){var passed_time=window.general.passed_time($start_in_milli)/1000;return window.general.round(passed_time,2)+" seconds"},replace:function(string,needle,newbie){if(string.indexOf(needle)==-1)
return string;while(string.indexOf(needle)>-1){string=string.replace(needle,newbie)}
return string},uniqid:function(length){var dec2hex=[];for(var i=0;i<=15;i++){dec2hex[i]=i.toString(16)}
var uuid='';for(var i=1;i<=36;i++){uuid+=dec2hex[(Math.random()*16|0)]}
if(length)uuid=uuid.substring(0,length);return uuid},removeValFromArray:function(arr,value,strict){var i=0;while(i<arr.length){if(strict===!0?arr[i]===value:arr[i]==value){arr.splice(i,1)}else{++i}}
return arr},duration_hr:function($seconds){if(typeof($seconds)=="number"&&$seconds!==Infinity&&$seconds>60){var $minutes=Math.floor($seconds/60);$seconds=$seconds-($minutes*60);if($seconds.toString().length==1)$seconds="0"+$seconds;if($minutes.toString().length==1)$minutes="0"+$minutes;return $minutes+":"+$seconds}else if(typeof($seconds)=="number"&&$seconds!==Infinity){if($seconds.toString().length==1)$seconds="0"+$seconds;$seconds="00:"+$seconds;return $seconds}else{$seconds="∞"}
return $seconds},array_shuffle:function(array){var newArray=[].concat(array);for(let i=array.length-1;i>0;i--){const j=Math.floor(Math.random()*(i+1));[newArray[i],newArray[j]]=[newArray[j],newArray[i]]}
return newArray},decode_htmlspecialchars:function(text){text=$("<div/>").html(text).text();var map={'&amp;':'&','&#038;':"&",'&#38;':"&",'&lt;':'<','&gt;':'>','&quot;':'"','&#039;':"'",'&#39;':"'",'&#8217;':"’",'&#8216;':"‘",'&#8211;':"–",'&#8212;':"—",'&#8230;':"…",'&#8221;':'”'};return text.replace(/\&[\w\d\#]{2,5}\;/g,function(m){return map[m]})},humanFileSize:function(bytes,si=!1,dp=1){const thresh=si?1000:1024;if(Math.abs(bytes)<thresh){return bytes+' B'}
const units=si?['kB','MB','GB','TB','PB','EB','ZB','YB']:['KiB','MiB','GiB','TiB','PiB','EiB','ZiB','YiB'];let u=-1;const r=10**dp;do{bytes/=thresh;++u}while(Math.round(Math.abs(bytes)*r)/r>=thresh&&u<units.length-1);return bytes.toFixed(dp)+' '+units[u]},rgbToHex:function(rgb){rgb=rgb.split(',');let r=(+rgb[0]).toString(16),g=(+rgb[1]).toString(16),b=(+rgb[2]).toString(16);if(r.length==1)
r="0"+r;if(g.length==1)
g="0"+g;if(b.length==1)
b="0"+b;return r+g+b},isNumeric:function(n){return!isNaN(parseFloat(n))&&isFinite(n)}};window._g=window.general;window._g._mt=window.general.milli_time;window._g._pt=window.general.passed_time_hr
window.user={logged:function(){var hasSessionID=cache.get("sess_id");if(hasSessionID)
return hasSessionID;return!1},loggedOut:function(loadLogin){if(cache.get("sess_id"))
cache.remove("sess_id");if(cache.get("muse_que_i"))
cache.remove("muse_que_i");if(cache.get("muse_que"))
cache.remove("muse_que");if(loadLogin){try{window.ui.page.load("user_auth").done(function(){window.ui.lock.offAll();window.ui.body.removeSplashClasses()})}catch(err){console.log(err)}}},online:function(){return navigator.onLine},_loginDesctionation:null,setLoginDestination:function($url){if($url.substr(0,$_bof_config.web_address.length)==$_bof_config.web_address)
this._loginDesctionation=$url.substr($_bof_config.web_address.length);},getLoginDestionation:function(){return this._loginDesctionation}}
window.app={config:null,translations:null,cache:{color:"dark",location:null,defaultClickAction:'direct'},events:{bof_ready:function(){window.app.events.setGlobalListeners();$.when(window.app.getConfig(),window.bof._loadExtension({name:"lang",path:"app/lang.js",})).done(function(configResult){var loadPlatformJss=window.app._loadPlatformJavas();var loadAppJSs=window.app._loadAppJavas();var loadThemeStylesStart=window._g._mt();var loadThemeStylesArray=[];var loadThemeStyles=$.Deferred();if(window.app.config?.theme?.assets?.css){for(var i=0;i<window.app.config.theme.assets.css.length;i++){var themeStyle=window.app.config.theme.assets.css[i];if(!themeStyle)continue;loadThemeStylesArray.push(window.bof._loadCSS(themeStyle))}}else{loadThemeStyles.resolve(0)}
if(loadThemeStylesArray){$.when.apply($,loadThemeStylesArray).done(function(){loadThemeStyles.resolve(window._g._pt(loadThemeStylesStart))})}
var loadThemeJavasStart=window._g._mt();var loadThemeJavasArray=[];var loadThemeJavas=$.Deferred();if(window.app.config?.theme?.assets?.js){for(var i=0;i<window.app.config.theme.assets.js.length;i++){var themeJava=window.app.config.theme.assets.js[i];loadThemeJavasArray.push(window.bof._loadExtension(themeJava))}}else{loadThemeJavas.resolve(0)}
if(loadThemeJavasArray){$.when.apply($,loadThemeJavasArray).done(function(){loadThemeJavas.resolve(window._g._pt(loadThemeJavasStart))})}
if(window.app.config?.theme?.css_variables){for(var i=0;i<Object.keys(window.app.config.theme.css_variables).length;i++)
var css_variable_name=Object.keys(window.app.config.theme.css_variables)[i];var css_variable_value=window.app.config.theme.css_variables[css_variable_name];document.documentElement.style.setProperty('--'+css_variable_name,css_variable_value)}
var loadTranslations=window.lang.get();var loadThemeParts=$.Deferred();loadTranslations.done(function(){window.app._loadParts().done(function(result){loadThemeParts.resolve(result)}).fail(function(err){loadThemeParts.reject(err)})});$.when(loadAppJSs,loadThemeParts,loadThemeStyles,loadThemeJavas,loadTranslations,loadPlatformJss).done(function(loadPartTime,loadStyleTime,loadJavaTime){window.bof.log("Loading Theme: "+window.app.config.theme.name+" HTML done in "+loadPartTime);window.bof.log("Loading Theme: "+window.app.config.theme.name+" CSS done in "+loadStyleTime);window.bof.log("Loading Theme: "+window.app.config.theme.name+" JS done in "+loadJavaTime);if(!window.app.config.user.logged&&window.user.logged)
window.user.loggedOut(!1);var initialPageAction;if(!window.user.online()){initialPageAction=$.Deferred();initialPageAction.resolve();window.ui.body.addClass("offline_start",!0);window.bof_offline.mode.on()}else if(!window.user.logged()&&window.app.config.setting.private&&($_bof_config?.requested_page?$_bof_config.requested_page!="user_auth":!0)){initialPageAction=window.ui.page.load("user_auth")}else if($_bof_config.requested_url){if(window.location)
window.app.cache.location=JSON.stringify(window.location);if($_bof_config.requested_page=="404")
initialPageAction=window.ui.page.load("404")
else if($_bof_config.requested_page=="403")
initialPageAction=window.ui.page.load("403")
else initialPageAction=window.ui.link.navigate($_bof_config.requested_url);}else{initialPageAction=window.ui.link.navigate("/")}
initialPageAction.always(function(){var loadMenus=window.app._loadMenus();$.when.apply($,loadMenus).done(function(){window.app.events.setSidebarSta(!0);window.ui.link.listen();window.ui.history.listen();window.bof_input.listen();window.bof_dropdown.listen();window.ui.body.removeSplashClasses();if(window.m2){window.m2.app_ready()
window.m2.user.listen()}
if(window.bof_offline)
window.bof_offline.listen();window.chapar.listen();window.app.events.setGlobalListeners2();window.app.actions.search.listen();$(document).trigger("app_ready");document.querySelector(':root').style.setProperty('--window_height',$(window).height()+"px");$(window).on("resize",function(e){document.querySelector(':root').style.setProperty('--window_height',$(window).height()+"px")});var color=null;if(window.cache.get("color"))
color=window.cache.get("color");if(color){window.ui.body.addClass(color,!0);window.app.cache.color=color}
if(window.app.config?.setting?.additional_body_classes){for(var z=0;z<window.app.config.setting.additional_body_classes.length;z++){window.ui.body.addClass(window.app.config.setting.additional_body_classes[z],!0)}}})})})})},lock:{first_on:function($name){},on:function($name){},off:function($name){},all_off:function($name){}},page_unloading:function($args){window.config.events.page_unloading();$(document).trigger("page_unloading")},page_rendering:function($args){var becli=window.ui.page.get_data("becli");if(becli){for(var i=0;i<Object.keys(becli).length;i++){var _k=Object.keys(becli)[i];var _v=becli[_k];if(_v.messages?_v.messages[0]=="404":!1){window.ui.lock.off($args.name);var promise=$.Deferred();promise.reject();setTimeout(function(){window.ui.page.load("404")},100);return promise}}}
window.config.events.page_rendering()},page_ready:function($args){window.config.events.page_ready();$(document).trigger("page_ready")},historyPopState:function(){if(window.m2_queue.ui.isOpen()){window.m2_queue.ui.destroy()
return"HALT"}
if(window.pageBuilder.widget.item.open){window.pageBuilder.widget.item.closeMenu();return"HALT"}
if($("body").hasClass("mobile")&&$("body").hasClass("open_menu")){$("body").removeClass("open_menu");$(document).find(".sidebar .menu_parent .link_wrapper.parent.active").removeClass("active");return"HALT"}},setGlobalListeners:function(){$(document).on("contextmenu",function(e){e.preventDefault()});$(document).on("click","form .btn.submit",function(e){var button=$(this);var form=$(this).parents("form");var validated=null;if(button.hasClass("loading"))return;form.find(".message_holder").removeClass("display");form.find(".message_holder .message").html(" ");if(form.hasClass("validate"))validated=form.valid();else validated=!0;if(validated){button.removeClass("failure").removeClass("success").addClass("loading");form.removeClass("failure").removeClass("success").addClass("loading").submit()}});$(document).on("click",".header .i .icon.pre",function(){if(window.ui.history.hasPre())
window.history.back();});$(document).on("click","body.no_sidebar .header .i.openSidebar",function(){$("body").toggleClass("overlay_sidebar")});$(document).on("click",".widget.type_slider.liquid .arrows .arrow",function(e){var $_dir="ltr";var direction=$(this).attr("class").includes("next")?"right":"left";var widget=$(this).parents(".widget");var slider=widget.find(".slider_wrapper")[0];var total_width=slider.scrollWidth;var visible_width=slider.offsetWidth;var item_width=$(slider).find(".item").outerWidth(!0);var scroll_position=slider.scrollLeft;var visible_items=Math.floor(visible_width/item_width)>1?Math.floor(visible_width/item_width):1;var to_right=($_dir=="ltr"?+1:-1)*(direction=="right"?+1:-1)*(visible_items*item_width);var new_scroll_position=scroll_position+to_right;var max_scroll_position=total_width-visible_width;var final_scroll_position=9999;var possible_scroll_poisitions=[];for(var x=0;x<=max_scroll_position;x=x+item_width){possible_scroll_poisitions.push(x)}possible_scroll_poisitions.push(max_scroll_position);possible_scroll_poisitions.forEach(function(x){var __c=Math.abs(new_scroll_position-x);var __b=Math.abs(final_scroll_position-new_scroll_position);if(__b>__c)final_scroll_position=x});if(visible_width+scroll_position==total_width&&to_right>0)final_scroll_position=0;if(scroll_position==0&&to_right<0)final_scroll_position=max_scroll_position;$(slider).stop().animate({scrollLeft:final_scroll_position+"px"},800)});$(document).on("click",".lightSwitch",function(e){var colors=["dark","grey","light"];var cur_color=window.app.cache.color;var new_color=colors[colors.indexOf(cur_color)+1>colors.length-1?0:colors.indexOf(cur_color)+1];window.app.cache.color=new_color;window.ui.body.removeClass("dark",!0);window.ui.body.removeClass("grey",!0);window.ui.body.removeClass("light",!0);window.ui.body.addClass(new_color,!0);window.cache.set("color",new_color)});$(document).on("click",".currencySwitch",function(e){window.bof_dropdown.close();var html="<div class='options'>";for(var i=0;i<Object.keys(window.app.config.currencies).length;i++){var currency_code=Object.keys(window.app.config.currencies)[i];var currency_name=window.app.config.currencies[currency_code];var currency_selected=window.app.config.user.currency==currency_code?" selected":"";html+="<div class='option"+currency_selected+"' data-value='"+currency_code+"'>"+currency_name+"</div>"}
html+="</div>";window.bof_modal.create({title:window.lang.return("change_currency",{ucfirst:!0}),content:html,class:"options options_currencies"})});$(document).on("click",".languageSwitch",function(e){window.bof_dropdown.close();var html="<div class='options'>";for(var i=0;i<Object.keys(window.app.config.languages).length;i++){var language_code=Object.keys(window.app.config.languages)[i];var language_name=window.app.config.languages[language_code];var language_selected=window.app.config.user.language==language_code?" selected":"";html+="<div class='option"+language_selected+"' data-value='"+language_code+"'>"+language_name+"</div>"}
html+="</div>";window.bof_modal.create({title:window.lang.return("change_language",{ucfirst:!0}),content:html,class:"options options_languages"})});$(document).on("click",".modal.options_languages .options .option",function(e){if($(this).hasClass("selected"))
return;if(window.bof_offline_sw){window.bof_offline_sw.deleteBofClient()}
if(!window.user.logged()){window.cache.set("language",$(this).data("value"));window.location.reload()}
window.becli.exe({endpoint:"change_language",post:{code:$(this).data("value")},callBack:function(sta,data){if(sta){window.location.reload()}}})});$(document).on("click",".modal.options_currencies .options .option",function(e){if($(this).hasClass("selected"))
return;window.becli.exe({endpoint:"change_currency",post:{code:$(this).data("value")},callBack:function(sta,data){if(sta){window.location.reload()}}})});$(document).on("click",".bof_alert",function(e){var ID=$(this).data("alert-id");$(document).find(".bof_alert.ID_"+ID).remove();delete window.app.becli.__cache.alert[ID];window.app.becli._alert_sort()});$(document).on("click",".bofForm ._submit",function(e){var formDom=$(this).parents(".bofForm");var ID=formDom.attr("ID");var formData=null;var allBeclis=window.ui.page.data.becli;for(var i=0;i<Object.keys(allBeclis).length;i++){var _becliKey=Object.keys(allBeclis)[i];var _becliData=allBeclis[_becliKey];if(_becliData.bofForm||_becliData.bofForms){var _becliForms=_becliData.bofForms?_becliData.bofForms:[_becliData.bofForm];if(_becliForms){for(var z=0;z<_becliForms.length;z++){var _becliForm=_becliForms[z];if(_becliForm.ID===ID&&_becliForm.becli){formData=_becliForm}}}}}
if(formData){if(formDom.hasClass("_loading"))
return;window.app.ui.bofForm.loading(ID);var becliData=formData.becli;window.becli.exe({endpoint:becliData.endpoint,post:formDom.find("form").serialize(),callBack:function(sta,data){if(sta)
window.app.ui.bofForm.done(ID,{},data);else window.app.ui.bofForm.failed(ID,{},data)}})}});$(document).on("click",".logout_handler",window.app.actions.user.logout)
$("#main").scroll(function(e){var pos_top=$("#main").scrollTop();window.ui.history.record("scrollTop",pos_top);if(pos_top>60)
$(document).find(".header").removeClass("resting").addClass("floating")
else $(document).find(".header").addClass("resting").removeClass("floating")
if(pos_top>400)
$(document).find(".header").addClass("big_floating")
else $(document).find(".header").removeClass("big_floating")});$(document).on("ui_page_load_failure",function(e,args){if(!args.reason.endsWith("HALT"))
window.app.becli.alert(!1,window.lang.return("pageload_failed",{ucfirst:!0}))})
$(document).on("click",".modal.user_list .content ._user",function(e){if($(e.target).hasClass("btn"))
return;window.bof_modal.close();window.ui.link.navigate($(this).data("url"))});$(document).on("click",".modal.purchase .unlock_options .ugp .upi .btn",function(e){if($(this).hasClass("loading"))
return;var btn=$(this);btn.addClass("loading")
var item=btn.parents(".upi");var ot=item.data("ot");var hash=item.data("hash");if(ot=="user_subs_plan"){window.bof_modal.close();window.ui.link.navigate("subscription_plans?plan="+hash);return}
window.app.actions.purchase(ot,hash,(sta,data)=>{btn.removeClass("loading");var resultModalButtons=[];if(sta){resultModalButtons.push(["btn-primary",window.lang.return("purchases",{ucfirst:!0}),"window.ui.link.navigate( \"user_library?tab=purchased\" ); window.bof_modal.close(); window.bof_modal.close();"])}else{resultModalButtons.push(["btn-primary",window.lang.return("add_funds",{ucfirst:!0}),"window.ui.link.navigate( \"user_pay\" ); window.bof_modal.close(); window.bof_modal.close();"])}
window.bof_modal.create({class:"purchase_modal",title:data.messages[0],content:data.more,layer:2,buttons:resultModalButtons})})});$(document).on("change",".modal.share .embed_wrapper .options_wrapper .option ._i",function(e){var _ot=$(document).find(".modal_wrapper .modal .content .embed_wrapper").data("ot");var _hash=$(document).find(".modal_wrapper .modal .content .embed_wrapper").data("hash");var _m=$(document).find(".modal.share .embed_wrapper .options_wrapper .option ._i[name=_media] option:selected").val();var _d=$(document).find(".modal.share .embed_wrapper .options_wrapper .option ._i[name=_theme] option:selected").val()=="dark"?"?_dark&":"?";var _c=$(document).find(".modal.share .embed_wrapper .options_wrapper .option ._i[name=_hex]").val();if(_c.substr(0,1)=="#")_c=_c.substr(1);var _ns="<iframe frameborder='0' height='136px' width='100%' src='"+($_bof_config.endpoint_address+"muse_embed/"+_ot+"/"+_hash+"/"+_d+"_m_color="+_c+"&_type="+_m)+"'></iframe>"
$(document).find(".modal.share .embed_wrapper #iframe_code").val(_ns);$(document).find(".modal_wrapper .modal .content .embed_wrapper #iframe_holder").html(_ns)});$(document).on("click",".modal.share .sharers .etc",function(e){window.app.actions.share.etc()});$(document).on("mouseover",".bof_tooltip",function(e){if($(this).hasClass("tooltiped"))return;$(this).addClass("tooltiped");$(this).append("<div class='bof_tooltip_wrapper'>"+$(this).data("tip")+"</div>");window.bof_dropdown._exe($(this),$(this).find(".bof_tooltip_wrapper"));$(document).find(".bof_tooltip_wrapper").addClass("active")})
$(document).on("mouseleave",".bof_tooltip",function(e){if(!$(this).hasClass("tooltiped"))return;$(this).removeClass("tooltiped");$(document).find(".bof_tooltip_wrapper").remove()})},setGlobalListeners2:function(){if(!window.app.config.mobile){$(document).on("contextmenu",".item",function(e){window.app.ui.clickReact(e,$(this),"desktop","rightclick")});$(document).on("click",".item",function(e){window.app.ui.clickReact(e,$(this),"desktop","click")})}else{$(document).on("click",".sidebar .menu_parent .link_wrapper.parent a.parent",function(e){if(!$(this).hasClass("download_menu_wrapper"))
$(document).find(".bof_dropdown.file_list.active").removeClass("active")
if(!$(this).hasClass("chapar_menu_wrapper"))
$(document).find(".bof_dropdown.chapar_msgs.active").removeClass("active")
var linkWrapper=$(this).parents(".link_wrapper.parent")
if(linkWrapper.hasClass("with_child")){e.preventDefault();if(!$("body").hasClass("open_menu")){$("body").addClass("open_menu");linkWrapper.addClass("active");return!1}else{$("body").removeClass("open_menu");$(document).find(".sidebar .menu_parent .link_wrapper.parent.active").removeClass("active");return!1}}});$(document).on("click",".sidebar .menu_parent .link_wrapper.parent a.child",function(e){$("body").removeClass("open_menu");$(document).find(".sidebar .menu_parent .link_wrapper.parent.active").removeClass("active")})}
window.pageBuilder.widget.item.listen()},setSidebarSta:function($ini){$ini=$ini===!0;if(window.app.config.mobile)
return;if($ini){$(window).on("resize",function(){window.app.events.setSidebarSta()})}
if(window.innerWidth<1050)
window.ui.body.addClass("no_sidebar",!0);else{var dCs=[];if(window.ui.page.curr()?.data?.becli?.single?.page?.classes)
dCs=window.ui.page.curr().data.becli.single.page.classes.split(" ");if(window.ui.page.curr()?.o_args?.body_class)
dCs=dCs.concat(window.ui.page.curr().o_args.body_class)
if(!dCs.includes("no_sidebar"))
window.ui.body.removeClass("no_sidebar",!0);}}},becli:{__cache:{alert:{}},exe:function($type,$typeArgs,$args){var ID=window._g.uniqid();return window.becli.exe($.extend($args,{callBefore:window.app.becli._before,callBefore_param:{ID:ID,type:$type,typeArgs:$typeArgs},callBack:window.app.becli._after,callBack_param:{ID:ID,type:$type,typeArgs:$typeArgs}}))},alert:function($sta,$text){var ID=window._g.uniqid();window.app.becli._before({args:{callBefore_param:{type:"alert",ID:ID,}}});window.app.becli._after($sta,{messages:[$text]},{callBack_param:{type:"alert",ID:ID},args:{reload_after:!1}})},_before:function($args){var display_args=$args.args.callBefore_param;if(display_args.type=="button"){if(display_args.typeArgs.dom.hasClass("bof_processing"))return"BOF_HALT"
display_args.typeArgs.dom.removeClass("bof_done").removeClass("bof_fail").addClass("bof_processing").attr("disabled","disabled")
$(document).find(".groups_wrapper .group.failed_inputs").removeClass("failed_inputs");}else if(display_args.type=="alert"){$(document).find("body").append("<div class='bof_alert sta_loading unshown ID_"+display_args.ID+"' data-alert-id='"+display_args.ID+"'>\
          <span class='mdi mdi-"+(display_args.mdi?display_args.mdi:"airplane-takeoff")+" _icon'></span>\
          <span class='text'>"+window.lang.return("processing_dots",{ucfirst:!0})+"</span>\
        </div>");window.app.becli.__cache.alert[display_args.ID]="loading";window.app.becli._alert_sort()}
$(document).find(".bof_input.failed").removeClass("failed");$(document).find(".setting_wrapper.failed").removeClass("failed");$(document).find(".setting_wrapper .error").remove()},_after:function(sta,data,$args){var display_args=$args.callBack_param;if(display_args.type=="button"){display_args.typeArgs.dom.removeClass("bof_processing").addClass(sta?"bof_done":"bof_fail").attr("disabled",!1).text(data.messages[0]);if(!sta?data.bad_inputs:!1){for(var i=0;i<data.bad_inputs.length;i++){$(document).find(".bof_input[name="+data.bad_inputs[i]+"]").addClass("failed");$(document).find(".setting_wrapper#item_"+data.bad_inputs[i]).addClass("failed");var bi_cs=$(document).find(".setting_wrapper#item_"+data.bad_inputs[i]).attr("class").split(" ");for(var i=0;i<bi_cs.length;i++){var bi_c=bi_cs[i];if(bi_c.startsWith("group_")){$(document).find(".groups_wrapper .group[data-code="+bi_c.substr(6)+"]").addClass("failed_inputs")}}
if(data.inputs?data.inputs.report.fail[data.bad_inputs[i]]:!1){$(document).find(".setting_wrapper#item_"+data.bad_inputs[i]).append("<div class='error'>"+data.inputs.report.fail[data.bad_inputs[i]]+"</div>")}}}else if(sta){if(data.redirect)
window.ui.link.navigate(data.redirect);else if($args.args.reload_after!==!1)
window.ui.page.reload();}}else if(display_args.type=="alert"){var requestID=$args.callBack_param.ID;$(document).find(".bof_alert.ID_"+requestID).removeClass("sta_loading").addClass(sta?"sta_done":"sta_failed").find(".text").text(data.messages[0])
$(document).find(".bof_alert.ID_"+requestID).find("._icon").removeClass("mdi-airplane-takeoff").addClass(sta?"mdi-robot-happy-outline":"mdi-robot-dead-outline")
window.app.becli.__cache.alert[requestID]=sta?"done":"failed";window.app.becli._alert_sort();if(sta&&$args.args.reload_after===!0){window.ui.page.reload()}
setTimeout(function(){$(document).find(".bof_alert.ID_"+requestID).remove();delete window.app.becli.__cache.alert[requestID];window.app.becli._alert_sort()},10000);if(data.messages.length>1){for(var i=1;i<data.messages.length;i++){var extraMessage=data.messages[i];var extraMessageID=window._g.uniqid();$(document).find("body").append("<div class='bof_alert sta_"+(sta?"done":"failed")+" ID_"+extraMessageID+"' data-alert-id='"+extraMessageID+"'>\
              <span class='mdi "+(sta?"mdi-robot-happy-outline":"mdi-robot-dead-outline")+" _icon'></span>\
              <span class='text'>"+extraMessage+"</span>\
            </div>");window.app.becli.__cache.alert[extraMessageID]=sta?"done":"failed";window.app.becli._alert_sort();setTimeout(function(){$(document).find(".bof_alert.ID_"+extraMessageID).remove();delete window.app.becli.__cache.alert[extraMessageID];window.app.becli._alert_sort()},10000)}}}
if($args.args.c_callback){$args.args.c_callback(sta,data,$args)}},_alert_sort:function(){var pos="bottom";var alerts=window.app.becli.__cache.alert;var alerts_offset=0;if($("body").hasClass("mobile")){pos="top"}else{if($("body").hasClass("muse_active")&&!$("body").hasClass("muse_hide"))
alerts_offset=$(document).find("#player").outerHeight();}
for(var i=Object.keys(alerts).length;i>=0;i=i-1){var alert_id=Object.keys(alerts)[i-1];var alert_dom=$(document).find(".bof_alert.ID_"+alert_id);alert_dom.css(pos,alerts_offset+20+"px");alerts_offset+=alert_dom.outerHeight()+10}},_alert_reset:function(){window.app.becli.__cache.alert={};$(document).find(".bof_alert").remove()}},ui:{scrollTo:function(element){$("#main").animate({scrollTop:element[0].offsetTop+"px"})},playHead:{active:!1,set:function(data){$(document).find(".header .playHead .title").text(data.head_play_title)
$(document).find(".header").addClass("hasPlayHead");window.app.ui.playHead.active=!0},unset:function(){if(!window.app.ui.playHead.active)
return;$(document).find(".header").removeClass("hasPlayHead");window.app.ui.playHead.active=!1}},actions:{hideSliderArrows:function(){$(".widget.type_slider.liquid").each(function(index,item){var slider=$(item).find(".slider_wrapper")[0];if(slider.scrollWidth&&slider.offsetWidth?slider.scrollWidth-slider.offsetWidth<50:!0)
$(item).find(".arrows").remove();})},},bofForm:{loading:function($ID,$args){$(document).find("#"+$ID).removeClass("_failed").removeClass("_done").addClass("_loading");$(document).find("#"+$ID).find("._submit").html("<span class='mdi mdi-refresh'></span>")},done:function($ID,$args,$result){$(document).find("#"+$ID).removeClass("_loading").removeClass("_failed").addClass("_done");var _message=$result.messages[0];if(_message.length<30)
$(document).find("#"+$ID).find("._submit").html($result.messages[0]);else{$(document).find("#"+$ID).find("._submit").html(window.lang.return("successful",{ucfirst:!0}));$(document).find("#"+$ID).find("._error").addClass("ok").html($result.messages[0])}},failed:function($ID,$args,$result){$(document).find("#"+$ID).removeClass("_loading").removeClass("_done").addClass("_failed");$(document).find("#"+$ID).find("._submit").html(window.lang.return("retry",{uc:!0}));$(document).find("#"+$ID).find("._error").html("<span class='mdi mdi-alert-circle-outline'></span>"+$result.messages[0])},},modal:{user_list:function($userList,$args){var _content="";for(var i=0;i<$userList.length;i++){var _user=$userList[i];_content+="<div class='_user hash_"+_user.hash+" "+(_user.class?_user.class:"")+"' data-hash='"+_user.hash+"' data-url='"+_user.url+"' "+(_user.attr?_user.attr:"")+">";_content+="<div class='avatar'>"+_user.bof_file_avatar+"</div>";_content+="<div class='name'>"+_user.name_styled+"</div>";_content+="<div class='username'>"+_user.username+"</div>";if(_user.buttons)_content+="<div class='buttons'>"+_user.buttons+"</div>";_content+="</div>"}
window.bof_modal.create({title:$args.title,tip:$args.tip,content:_content,class:"user_list",buttons:[]})}},clickReact:function(e,target,deviceType,eventType){var Actions=window.app.config.setting.touch;var Action=Actions[eventType];var Item=deviceType=="mobile"?target.parents(".item.hammered"):target;var ID=Item.attr("id").substr(4);var Data=window.pageBuilder.widget.item.get(ID);if($(e.target).parents(".button_wrapper").length||$(e.target).hasClass("button_wrapper")){var button=$(e.target).parents(".button_wrapper").length?$(e.target).parents(".button_wrapper"):$(e.target);if(button.hasClass("more")){window.pageBuilder.widget.item.openMenu(ID,e.clientX,e.clientY)}else if(button.hasClass("play")){if(Data.ot&&Data.hash){window.m2.user.request("focus",Data.ot,Data.hash,Data.sources,Data)}}
return}
if(Item.hasClass("no_action"))
Action="none";else if(Action=="play"&&!Data.buttons.items.play)
Action="visit";else if(Data.buttons.play?Data.buttons.play.AsAction:!1)
Action="play"
else if(target.parents(".widget").hasClass("playAsAction")){if(eventType=="click"||eventType=="tap")
Action="play";else if(eventType=="rightclick"||eventType=="hold")
Action="menu"
else Action="visit"}else if(!Data.buttons.items.link)
Action="none"
else if(ID=="main")
Action="menu"
if(Action=="menu")
window.pageBuilder.widget.item.openMenu(ID,e.clientX,e.clientY);else if(Action=="visit")
window.ui.link.navigate(Data.url);else if(Action=="play"){if(Data.ot&&Data.hash)
window.m2.user.request("focus",Data.ot,Data.hash,Data.sources,Data);}
$(document).trigger("clickReact",{Data:Data,Action:Action})}},actions:{user:{like:function(liking,objectType,objectHash){if(liking===null||liking===undefined)
liking=$(document).find("._like.bof_"+objectType+"_"+objectHash).hasClass("liked")?!1:!0;var post={object_type:objectType,object:objectHash};var playing=window.m2_focus.sourceData
if(playing?(playing.data?playing.data.ot==objectType&&playing.data.hash==objectHash&&playing.source.type[0]=="youtube"&&playing.source.type[1].ID:!1):!1){post.yt_id=playing.source.type[1].ID;post.yt_key=window.cache.get("sess_google_key")}
window.app.becli.exe("alert",{},{endpoint:liking?"like":"unlike",post:post,ID:"userLikeOBject",c_callback:function(sta,data,args){if(window.bof_offline_sw){window.bof_offline_sw.deleteBofClient()}
if(sta){$(document).find("._like.bof_"+objectType+"_"+objectHash).removeClass(liking?"unliked":"liked").addClass(liking?"liked":"unliked").attr("data-action",liking?"unlike":"like").find("._t").text(liking?window.lang.return("unlike",{ucfirst:!0}):window.lang.return("like",{ucfirst:!0}));try{if(objectType==window.m2_queue.active.get().data.ot&&objectHash==window.m2_queue.active.get().data.hash){if(!liking){$(document).find("#player .buttons_wrapper .button.muse_like_handler").removeClass("liked").addClass("unliked").find(".mdi").addClass("mdi-heart-outline").removeClass("mdi-heart")}else{$(document).find("#player .buttons_wrapper .button.muse_like_handler").addClass("liked").removeClass("unliked").find(".mdi").removeClass("mdi-heart-outline").addClass("mdi-heart")}}}catch(err){}}}})},subscribe:function(subscribing,objectType,objectHash){if(subscribing===null||subscribing===undefined)
subscribing=$(document).find("._subscribe.bof_"+objectType+"_"+objectHash).hasClass("subscribed")?!1:!0;var post={object_type:objectType,object:objectHash};window.app.becli.exe("alert",{},{endpoint:subscribing?"subscribe":"unsubscribe",post:post,c_callback:function(sta,data,args){if(sta){if(window.bof_offline_sw){window.bof_offline_sw.deleteBofClient()}
$(document).find("._subscribe.bof_"+objectType+"_"+objectHash).removeClass(subscribing?"unsubscribed":"subscribed").addClass(subscribing?"subscribed":"unsubscribed").attr("data-action",subscribing?"unsubscribe":"subscribe").find("._t").text(objectType=="user"?(subscribing?window.lang.return("unfollow",{ucfirst:!0}):window.lang.return("follow",{ucfirst:!0})):(subscribing?window.lang.return("unsubscribe",{ucfirst:!0}):window.lang.return("subscribe",{ucfirst:!0})))}}})},playlist:{delete_confirm:function(playlist_id,data){window.bof_modal.create({title:window.lang.return("confirm",{ucfirst:!0}),tip:window.lang.return("confirm_remove_playlist",{ucfirst:!0}),buttons:[["btn-primary the_loading_button",window.lang.return("confirm",{ucfirst:!0}),"window.app.actions.user.playlist.delete(\""+playlist_id+"\")"]]})},delete:function(playlist_id){window.bof_modal.set_loading("button");window.becli.exe({endpoint:"playlist_remove",post:{id:playlist_id},callBack:function(sta,data,args){if(sta){window.bof_modal.close();window.app.becli.alert(!0,window.lang.return("removed",{ucfirst:!0}));window.app.getConfig(!0)}else{window.bof_modal.finish_loading("button");window.bof_modal.set_error(data.messages[0])}}})},edit_start:function(playlist_id,playlist_ini_data){window.bof_modal.set_loading("initial");window.becli.exe({endpoint:"playlist_edit_ini",post:{id:playlist_id},callBack:function(sta,data,args){if(!sta){window.bof_modal.close();window.app.becli.alert(!0,window.lang.return("not_found",{ucfirst:!0}))}else{var pl=data.playlist;window.bof_modal.close();window.bof_modal.create({title:window.lang.return("edit_playlist",{ucfirst:!0}),tip:pl.name,inputs:{name:{label:window.lang.return("name",{ucfirst:!0}),tip:window.lang.return("choose_name",{ucfirst:!0}),input:{type:"text",name:"name",value:pl.name}},private:{label:window.lang.return("privacy",{ucfirst:!0}),tip:window.lang.return("playlist_privacy",{ucfirst:!0}),input:{type:"select_i",name:"private",options:[["0",window.lang.return("public",{ucfirst:!0})],["1",window.lang.return("private",{ucfirst:!0})],],value:pl.private?1:0}},cover_id:data.cover_input.data,collabs:data.collabs_input.data,},buttons:[["btn-primary the_loading_button",window.lang.return("confirm",{ucfirst:!0}),"window.app.actions.user.playlist.edit(\""+playlist_id+"\")"]]})}}})},edit:function(playlist_id){var modalData=window.bof_modal.get(!0);if(!modalData.name){window.bof_modal.set_error(window.lang.return("enter_a_name",{ucfirst:!0}));return}
modalData.id=playlist_id;modalData.private=modalData.private==="1"?1:0;window.bof_modal.set_loading("button");window.becli.exe({endpoint:"playlist_edit",post:modalData,callBack:function(sta,data,args){if(sta){window.bof_modal.close();window.app.becli.alert(!0,window.lang.return("edited",{ucfirst:!0}));window.app.getConfig(!0)}else{window.bof_modal.finish_loading("button");window.bof_modal.set_error(data.messages[0])}}})},keep:function(playlist_id){window.becli.exe({endpoint:"playlist_keep",post:{id:playlist_id},callBack:function(sta,data,args){if(sta)
window.app.becli.alert(!0,window.lang.return("added",{ucfirst:!0}));else window.bof_modal.set_error(data.messages[0])}})},lose:function(playlist_id){window.becli.exe({endpoint:"playlist_lose",post:{id:playlist_id},callBack:function(sta,data,args){if(sta)
window.app.becli.alert(!0,window.lang.return("removed",{ucfirst:!0}));else window.bof_modal.set_error(data.messages[0])}})},shorten:function(playlist_id,item_ot,item_id,i){window.becli.exe({endpoint:"playlist_shorten",post:{id:playlist_id,ot:item_ot,item:item_id,i:i},callBack:function(sta,data,args){if(sta)
window.app.becli.alert(!0,window.lang.return("removed",{ucfirst:!0}));else window.bof_modal.set_error(data.messages[0])}})},},item_single_edit:{delete_confirm:function(object_type,object_hash,Data){window.bof_modal.create({title:window.lang.return("confirm",{ucfirst:!0}),tip:window.lang.return("confirm_remove_item",{ucfirst:!0}),buttons:[["btn-primary the_loading_button",window.lang.return("confirm",{ucfirst:!0}),"window.app.actions.user.item_single_edit.delete(\""+object_type+"\",\""+object_hash+"\")"]]})},delete:function(object_type,object_hash){window.bof_modal.set_loading("button");window.becli.exe({endpoint:"user_edit_single_item_rem",post:{ot:object_type,oh:object_hash,},callBack:function(sta,data,args){if(sta){if(window.bof_offline_sw){window.bof_offline_sw.deleteBofClient()}
window.bof_modal.close();window.app.becli.alert(!0,window.lang.return("removed",{ucfirst:!0}));window.app.getConfig(!0)}else{window.bof_modal.finish_loading("button");window.bof_modal.set_error(data.messages[0])}}})},edit_start:function(object_type,object_hash,Data){window.bof_modal.set_loading("initial");window.bof_input.load_daterangepicker();window.becli.exe({endpoint:"user_edit_single_item_ini",post:{object_type:object_type,object_hash:object_hash},callBack:function(sta,data,args){if(!sta){window.bof_modal.close();window.app.becli.alert(!0,window.lang.return("not_found",{ucfirst:!0}))}else{window.bof_modal.close();window.bof_modal.create({title:window.lang.return("edit",{ucfirst:!0}),tip:data.inputs.title.input.value,class:"edit_single",inputs:data.inputs,groups:data.groups,buttons:[["btn-primary the_loading_button","Edit","window.app.actions.user.item_single_edit.edit( \""+object_type+"\", \""+object_hash+"\" )"]]});$(document).find(".modal_wrapper .modal .groups .group.basic").click();setTimeout(function(){$(document).find(".modal_wrapper .modal .groups .group_basic").click();window.bof_input.hook_daterangepicker()},400)}}})},edit:function(object_type,object_hash){var modalData=window.bof_modal.get(!0);modalData.object_type=object_type;modalData.object_hash=object_hash;window.bof_modal.set_loading("button");window.becli.exe({endpoint:"user_edit_single_item",post:modalData,callBack:function(sta,data,args){if(sta){window.bof_modal.close();window.app.becli.alert(!0,"Edited")}else{window.bof_modal.finish_loading("button");window.bof_modal.set_error(data.messages[0])}}})},},logout:function(){window.becli.exe({endpoint:"user_logout",callBack:function(){if(window.bof_offline_sw){window.bof_offline_sw.deleteBofClient()}
window.user.loggedOut(!0);window.app.getConfig(!0).done(function(){window.app._loadParts().done(function(){window.app._loadMenus()})})}})},unsubscribe:function($id){window.bof_modal.set_loading("button");window.becli.exe({endpoint:"cancel_subs_plan",post:{id:$id},callBack:function(sta,data){if(window.bof_offline_sw){window.bof_offline_sw.deleteBofClient()}
window.ui.page.reload();window.bof_modal.close()}})}},get_unlock_solution:function(object_type,object_hook,source_type,source_hook,source_id){window.bof_modal.set_loading("initial");window.becli.exe({endpoint:"muse_unlock_solution",post:{object_type:object_type,object_hook:object_hook,source_type:source_type,source_hook:source_hook,source_id:source_id},callBack:function(sta,data,args){if(!sta){window.bof_modal.close();window.app.becli.alert(!1,data.messages[0])}else{window.bof_modal.close();var $html="<div class='unlock_options'>";if(data.items){$html+="<div class='direct ugp'>";for(var i=0;i<data.items.length;i++){var item=data.items[i];$html+="<div class='upi bof_"+(item.ot+"_"+item.hash)+(item.cover?" has_cover":" ")+" direct_i' data-ot='"+item.ot+"' data-hash='"+item.hash+"'>";$html+="<div class='cover'>"+item.cover+"</div>";$html+="<div class='name'>"+item.name+"<span class='type'>"+item.on+"</span></div>";$html+="<div class='price'>"+item.price+"</div>";$html+="<div class='btn btn-primary'>"+window.lang.return("buy",{ucfirst:!0})+"<div class='loader'></div></div>";$html+="</div>"}
$html+="</div>"}
if(data.subs_plans){$html+="<div class='subs_plans ugp'>";$html+="<div class='upg_title'>"+window.lang.return("get_access_by_plans",{ucfirst:!0})+"</div>";for(var i=0;i<data.subs_plans.length;i++){var item=data.subs_plans[i];$html+="<div class='upi bof_"+(item.ot+"_"+item.hash)+(item.cover?" has_cover":" ")+" subs_plans_i' data-ot='"+item.ot+"' data-hash='"+item.hash+"'>";$html+="<div class='cover'>"+item.cover+"</div>";$html+="<div class='name'>"+item.name+"</div>";$html+="<div class='price'>"+item.price+"</div>";$html+="<div class='btn btn-primary'>"+window.lang.return("buy",{ucfirst:!0})+"<div class='loader'></div></div>";$html+="</div>"}
$html+="</div>"}
$html+="</div>";window.bof_modal.create({title:data.title,content:$html,class:"purchase",buttons:[]})}}})},view_bio:function(object_type,object_hash){window.bof_modal.set_loading("initial");window.becli.exe({endpoint:"view_bio",post:{object_type:object_type,object_hook:object_hash,},callBack:function(sta,data,args){if(!sta){window.bof_modal.close();window.app.becli.alert(!1,data.messages[0])}else{var attrs=data.data.attrs;var html="";html+="<div class='bio_wrapper"+(attrs?" hasAttr":"")+"'>";if(attrs){html+="<div class='attrs'>";if(data.data.cover)
html+="<div class='avatar' style='background-image:url(\""+data.data.cover+"\")'></div>";for(var i=0;i<attrs.length;i++){if(attrs[i][1])
html+="<div class='attr'><b>"+attrs[i][0]+"</b> "+attrs[i][1]+"</div>"}
html+="</div>"}
html+="<div class='content_wrapper def_scroll'><h4>"+data.data.name+"</h4>"+data.data.content+"</div>";html+="</div>";window.bof_modal.close();window.bof_modal.create({content:html,class:"biography",})}}})},purchase:function(object_type,object_hash,callBack){var promise=window.becli.exe({endpoint:"purchase",post:{object_type:object_type,object_hash:object_hash},callBack:callBack})["promise"]
promise.done(function(){if(window.bof_offline_sw){window.bof_offline_sw.deleteBofClient()}});return promise},search:{inied:!1,timer:!1,history:!1,suggs:!1,listen:function(){$(document).on("change","#search_query",function(){var query=$(document).find("#search_query").val()});$(document).on("input","#search_query",function(){window.app.actions.search.exe()})},exe:function($addToHistory){if(this.timer)
clearTimeout(this.timer);if($addToHistory!==!1)
$addToHistory=!0;var query=$(document).find("#search_query").val();$(document).find(".widget.searchSuggs").slideUp(200);$(document).find(".widget.search_result_widget").remove();if(query){$(document).find(".widget.type_search_form").addClass("loading");$(document).find("#main .widget:not(.type_search_form)").addClass("hidden").slideUp(150);this.timer=setTimeout(function(){var promises=[];window.becli.exe({ID:"search",endpoint:"search",post:{query:query},callBack:function(sta,data){if(sta){for(var i=0;i<Object.keys(data.widgets).length;i++){var ii=Object.keys(data.widgets)[i];var renderWidgetPromise=window.app.actions.search.renderSearchResultWidget(data.widgets[ii]);promises.push(renderWidgetPromise)}
$.when.apply($,promises).done(function(){$(document).find(".widget.type_search_form").removeClass("loading");$(document).find("#main .widget.hidden:not(.searchSuggs)").removeClass("hidden").slideDown(150);setTimeout(function(){window.app.ui.scrollTo($(document).find(".widget.type_search_form"));window.app.ui.actions.hideSliderArrows()},200)});window.app.actions.search.history=data.history;if($addToHistory)
window.ui.history.add(window.ui.page.curr().o_args.urlData.url.path+'?query='+query);}}})},750)}},renderSearchResultWidget:function($widget){var promise=$.Deferred();window.ui.page.data.becli.single.widgets.push($widget);window.ui.theme.part("theme/parts/widget",{base:$_bof_config.assets_address,target:!1}).done(function(HTML){window.render.mix(HTML,$widget).done(function(Data){$(document).find(".widget.type_search_form").after(Data);promise.resolve()})});return promise},ini:function(){if(this.inied)return;this.inied=!0;$(document).on("clickReact",window.app.actions.search.crf);$(document).on("click",".search_result_widget .item a",function(){var i=window.pageBuilder.widget.item.get($(this).parents(".item").attr("ID").substr(4));window.app.actions.search.submit(i.ot,i.hash)});var hasQuery=!1;if(window.location?window.location.href:!1){var parseWindowHref=new URL(window.location.href);if(parseWindowHref.searchParams.get("query")){$(document).find("#search_query").val(parseWindowHref.searchParams.get("query"))
window.app.actions.search.exe(!1);hasQuery=!0}}
if(!hasQuery){var g=this.getSuggs();g.then(function(){window.app.actions.search.showSuggs()})}},unhook:function(){if(!this.inied)return;this.inied=!1;setTimeout(function(){$(document).off("click",".search_result_widget .item a");$(document).off("clickReact",window.app.actions.search.crf)},500)},submit:function(ot,h){if(!this.history)
return;window.becli.exe({endpoint:"searchSubmit",liquid:!0,post:{history:this.history,ot:ot,hash:h},callBack:function(sta,data){console.log(sta,data)}})},getSuggs:async function(){var p=$.Deferred();window.becli.exe({endpoint:"searchSuggs",post:{type:"ini"},callBack:function(sta,data){if(sta){p.resolve();window.app.actions.search.suggs=data.suggestions}else{p.reject()}}});return p},showSuggs:function(){window.app.actions.search.renderSearchResultWidget(window.app.actions.search.suggs.history).done(function(){window.app.ui.actions.hideSliderArrows()});window.app.actions.search.renderSearchResultWidget(window.app.actions.search.suggs.popular).done(function(){window.app.ui.actions.hideSliderArrows()})},crf:function(e,d){if(d.Action=="menu")return;window.app.actions.search.submit(d.Data.ot,d.Data.hash)}},share:{cache:null,ini:function(ini_data){window.bof_modal.set_loading("initial");window.becli.exe({endpoint:"share",post:{object_type:ini_data.ot,object_hash:ini_data.hash},callBack:function(sta,data,args){if(!sta){window.bof_modal.close();window.app.becli.alert(!1,window.lang.return("failed",{ucfirst:!0}))}else{window.app.actions.share.cache=data.item;var groups=[];if(data.embedable)
groups=[["share","share"],["embed","embed"]];var _html="<div class='a_content share_wrapper group_share "+(data.item.image?"has_img":"no_img")+"'>\
                "+(data.item.image?"<div class='cover_wrapper'><img src='"+data.item.image+"'></div>":"")+"\
                <div class='title_wrapper'>"+data.item.title+"</div>\
                <div class='url_wrapper'><input type='text' value='"+data.item.url+"' readonly></div>\
                <div class='sharers'>\
                  <a class='tw' target='_blank' href='https://twitter.com/intent/tweet?text="+encodeURIComponent(data.item.title)+"&url="+encodeURIComponent(data.item.url)+"'><span class='mdi mdi-twitter'></span></a>\
                  <a class='fb' target='_blank' href='https://www.facebook.com/sharer.php?u="+encodeURIComponent(data.item.url)+"'><span class='mdi mdi-facebook'></span></a>\
                  <a class='pi' target='_blank' href='https://pinterest.com/pin/create/button/?url="+encodeURIComponent(data.item.url)+"&media="+encodeURIComponent(data.item.image)+"&description="+encodeURIComponent(data.item.title)+"'><span class='mdi mdi-pinterest'></span></a>\
                  <a class='rd' target='_blank' href='https://www.reddit.com/submit?title="+encodeURIComponent(data.item.title)+"&url="+encodeURIComponent(data.item.url)+"'><span class='mdi mdi-reddit'></span></a>\
                  <a class='etc' ><span class='mdi mdi-share-variant'></span></a>\
                </div>\
              </div>";if(data.embedable){var dark_mode_string=window.app.cache.color==="light"?"?":"?_dark&";var theme_color=getComputedStyle(document.documentElement).getPropertyValue('--theme_color').trim().replaceAll(", ",",").trim();var theme_color_hex=window._g.rgbToHex(theme_color);var iFrame_string="<iframe frameborder='0' height='136px' width='100%' src='"+($_bof_config.endpoint_address+"muse_embed/"+ini_data.ot+"/"+ini_data.hash+"/"+dark_mode_string+"_m_color="+theme_color_hex)+"'></iframe>";var embedable_string="";for(var _I=0;_I<data.embedable.length;_I++){embedable_string+="<option value='"+data.embedable[_I]+"'>"+window.lang.return(data.embedable[_I],{ucfirst:!0})+"</option>"}
_html+="<div class='a_content embed_wrapper group_embed hideByGroup' data-ot='"+ini_data.ot+"' data-hash='"+ini_data.hash+"'>\
                  <b>Code: </b>\
                  <input type='text' value='' id='iframe_code' readonly>\
                  <b>Options: </b>\
                  <div class='options_wrapper'>\
                    <div class='option'>\
                      <b>Media: </b>\
                      <select name='_media' class='_i'>"+embedable_string+"</select>\
                    </div>\
                    <div class='option'>\
                      <b>Theme: </b>\
                      <select name='_theme' class='_i'><option>dark</option><option>light</option></select>\
                    </div>\
                    <div class='option'>\
                      <b>Color: </b>\
                      <input name='_hex' class='_i' type='text' value='"+theme_color_hex+"'>\
                    </div>\
                  </div>\
                  <b>Preview: </b>\
                  <div id='iframe_holder'>"+iFrame_string+"</div>\
                </div>"}
window.bof_modal.close();window.bof_modal.create({class:"share",title:window.lang.return("share",{ucfirst:!0}),tip:data.tip,content:_html,groups:groups,});setTimeout(function(){$(document).find("#iframe_code").val(iFrame_string)},100)}}})},etc:function(){if(navigator.share){navigator.share({title:window.app.config.brand.name,text:window.app.actions.share.cache.title,url:window.app.actions.share.cache.url,}).catch((error)=>window.app.becli.alert(!1,error))}else{window.app.becli.alert(!1,window.lang.return("failed",{ucfirst:!0}))}}},},ads:{cache:{gaus:[]},hook:function(){if(!window.app.config.setting.has_thingie)
return;var ads=$(document).find("bof_thingie");if(!ads.length)return;var promise=$.Deferred();var promiseToLoadAll=[];for(var i=0;i<ads.length;i++){promiseToLoadAll.push(window.app.ads.loadItem($(ads[i])))}
$.when.apply($,promiseToLoadAll).done(function(){promise.resolve()});return promise},loadItem:function($dom){window.becli.exe({endpoint:"get_the_thingie",post:{placement:$dom.html()},callBack:function(sta,data){if(sta){if(data.html?data.html.type=="gau":!1){var GD=data.html.data;var promiseToLoadJS=$.Deferred();if(!window.app.ads.cache.gaus.includes(GD.client)){window.bof._loadExtension({name:"gau_"+GD.client,path:"adsbygoogle.js?client="+GD.client,base:"https://pagead2.googlesyndication.com/pagead/js/",dir:"",skipNameCheck:!0,version:!1,}).done(function(){promiseToLoadJS.resolve();window.app.ads.cache.gaus.push(GD.client)}).fail(function(){promiseToLoadJS.reject("Loading GoogleAdUnit.js failed")})}else{promiseToLoadJS.resolve()}
promiseToLoadJS.done(function(){$dom.parents(".widget.type_ads").addClass("display");$dom.html('<center><ins class="adsbygoogle" style="display:block" data-ad-client="'+GD.client+'" data-ad-slot="'+GD.ad+'" data-ad-format="auto" data-full-width-responsive="true"></ins></center>');setTimeout(function(){window.adsbygoogle.push({})},200)})}else{$dom.parents(".widget.type_ads").addClass("display")
$dom.html(data.html)}}}})}},_loadMenus:function(){var loadMenus=[];if(window.app.config.theme.menus){var themeMenus=window.app.config.theme.menus;for(var i=0;i<Object.keys(themeMenus).length;i++){var themeMenuKey=Object.keys(themeMenus)[i];var themeMenu=themeMenus[themeMenuKey];var renderMenu=window.app._loadMenu(themeMenuKey,themeMenu);loadMenus.push(renderMenu)}}
if(window.app.config.mobile){$(document).find(".header .chapar_menu_wrapper").remove();$(document).find(".header .chapar_msgs").remove()}else{$(document).find(".sidebar .chapar_menu_wrapper").remove();$(document).find(".sidebar .chapar_msgs").remove()}
$(document).trigger("_loadMenus");return loadMenus},_loadMenu:function(key,data){var renderMenu=window.app.renderMenu(key).done(function(menuContent){$("body").find("._bof_"+key).html(menuContent)});return renderMenu},_loadParts:function(){$(document).find(".bof_part").remove();var loadThemePartsStart=window._g._mt();var loadThemePartsArray=[];var loadThemeParts=$.Deferred();if(window.app.config.theme.parts){for(var i=0;i<window.app.config.theme.parts.length;i++){loadThemePartsArray.push(window.app._loadPart(window.app.config.theme.parts[i]))}}else{loadThemeParts.resolve(0)}
if(loadThemePartsArray){$.when.apply($,loadThemePartsArray).done(function(){loadThemeParts.resolve(window._g._pt(loadThemePartsStart))})}
return loadThemeParts},_loadPart:function(themePart){var promise=$.Deferred();var themeArgs=themePart[1];var loadThemePart=window.ui.theme.part(themePart[0],$.extend({},themePart[1],{target:!1}));loadThemePart.done(function(loadedThemePart){window.render.mix(loadedThemePart).done(function(loadedThemePartRendered){if(!themeArgs.target){$("body").prepend("<div class='bof_part'>"+loadedThemePartRendered+"</div>")}else{$(document).find(themeArgs.target).prepend("<div class='bof_part'>"+loadedThemePartRendered+"</div>")}
setTimeout(function(){$(document).find("#footer ._bof_footer .menu_wrapper .link_wrapper.mobile_only").remove();$(document).find("#footer ._bof_footer .menu_wrapper .bof_dropdown").remove()},300);promise.resolve()})});return promise},_loadAppJavas:function(){return window.config.javas()},_loadPlatformJavas:function(){var promise=$.Deferred();if(window.app.config.mobile){window.ui.body.addClass("mobile",!0);window.bof._loadExtension({name:"hammer_min_js",path:"hammer.min.js",base:"https://hammerjs.github.io/dist/",dir:"",skipNameCheck:!0,version:!1,}).done(function(){promise.resolve()}).fail(function(){promise.reject("Loading hammer.min.js failed")})}else{window.ui.body.addClass("desktop",!0);promise.resolve()}
return promise},pages:{external_music:{events:{rendering:function(){window.ui.lock.off("external_music");var beCli=window.ui.page.get_data("becli");if(beCli?(beCli.single?beCli.single.url:!1):!1){window.ui.link.navigate(beCli.single.url)}else{window.ui.link.navigate("404")}
var promise=$.Deferred();promise.reject("HALT");return promise}}},user_auth:{events:{displaying:function(){var validatePromise=$.Deferred();var validateLanguage=$.Deferred();window.bof._loadExtension({name:"jquery.validate.min.js",path:"jquery.validate.min.js",base:"https://cdnjs.cloudflare.com/ajax/libs/jquery-validate/1.19.3/",dir:"",skipNameCheck:!0,version:!1}).done(function(){validatePromise.resolve();if(window.lang.code=="en"||window.lang.code===null||window.lang.code===undefined){validateLanguage.resolve()}else{var langcodeName=window.lang.code;if(langcodeName=="pt")
langcodeName="pt_PT"
window.bof._loadExtension({name:"jquery.validate.messages_"+langcodeName+".js",path:"messages_"+langcodeName+".js",base:"https://cdn.jsdelivr.net/npm/jquery-validation@1.19.3/dist/localization/",dir:"",skipNameCheck:!0,version:!1}).done(function(){validateLanguage.resolve()}).fail(function(){validateLanguage.resolve();window.bof.log("Loading jquery.validate.language:"+window.lang.code+" failed")})}}).fail(function(){validatePromise.reject("Loading jquery.validate failed")});return $.when(validatePromise,validateLanguage).fail(function(err){window.bof.log(err)})},ready:function(){$(".auth_form form").validate();$(document).on("click",".sl_buttons .sl",function(e){var target=$(this).attr("data-id");window.app.pages.user_auth.social_loginner=window.open($_bof_config.endpoint_address+"login_social_ini?alert=true&target="+target,"social_loginner","left=100,top=100,width=500,height=600")
window.app.pages.user_auth.social_loginner_promise=$.Deferred();window.app.pages.user_auth.social_loginner_promise.done(function(data){window.app.pages.user_auth.functions.checker(!0,JSON.parse(data));window.app.pages.user_auth.social_loginner.close()}).fail(function(error){console.log(error);window.app.pages.user_auth.functions.checker(!1,{messages:[error]});window.app.pages.user_auth.social_loginner.close()})});if(window.app.config.setting.social_login&&$(document).find("body.auth_page .auth_form_wrapper .auth_form .sl_wrapper").length){window.becli.exe({endpoint:"login_social_get",callBack:function(sta,data){if(data.google_off){window.bof._loadCSS({name:"roboto_font",path:"family=Roboto:wght@400;500&display=swap",base:"https://fonts.googleapis.com/css2?",dir:"",skipNameCheck:!0,version:!1})
window.ui.body.addClass("google_off")}
if(!sta){$(document).find("body.auth_page .auth_form_wrapper .auth_form .sl_wrapper").remove()}else{$(document).find("body.auth_page .auth_form_wrapper .auth_form .sl_wrapper").removeClass("loading");var _HTML="<div class=\"sl_buttons\">";for(var i=0;i<data.sls.length;i++){var _sl=data.sls[i];if(_sl.id=="google"&&data.google_off){_HTML+="<div class=\"sl google\" data-id=\""+_sl.id+"\">\
                      <span class=\"google_org\"><img src=\"https://developers.google.com/static/identity/images/g-logo.png\"></span> <span class=\"_t\">Sign in with Google</span>\
                      </div><br>"}else{_HTML+="<div class=\"sl\" data-id=\""+_sl.id+"\">\
                      <span class=\"mdi mdi-"+_sl.icon+"\"></span>\
                    </div>"}}
_HTML+="</div>";_HTML+="<div class=\"seperator_text\">or use your account</div>";$(document).find("body.auth_page .auth_form_wrapper .auth_form .sl_wrapper").html(_HTML);$(document).trigger("user_auth_social_login_loaded")}}})}
if($(document).find("body.auth_page .auth_form_wrapper .auth_form form").data("action")=="verification"){$(document).find("body.auth_page .auth_form_wrapper .auth_form .btn_wrapper .btn-primary").click()}
$.validator.addMethod("check_username",function(value,element){return/^[a-zA-Z0-9_.]+$/.test(value)},window.lang.return("invalid_username",{ucfirst:!0}));$.validator.addMethod("check_password",function(value,element){return $(document).find("#password").val()==value},window.lang.return("pws_dont_match",{ucfirst:!0}))},unloading:function(){$(document).off("click",".sl_buttons .sl")},},social_loginner:null,social_loginner_promise:null,functions:{before:function(){},checker:function(sta,data){var action=$(document).find(".auth_form form").data("action");if(window.bof_offline_sw){window.bof_offline_sw.deleteBofClient()}
if(sta){if(data.sess_id||data.sess_key){cache.set("sess_id",data.sess_id);cache.set("sess_key",data.sess_key);if(data.google_key)cache.set("sess_google_key",data.google_key)
window.app.getConfig(!0).done(function(){window.app._loadParts().done(function(){window.app._loadMenus();if(window.user.getLoginDestionation()){window.ui.link.navigate(window.user.getLoginDestionation())}else{window.ui.link.navigate("user_area")}})});window.app._loadParts();return}
$(document).find(".auth_form form").removeClass("loading").addClass("failure");$(document).find(".auth_form form .btn.submit").remove();$(document).find(".auth_form .message_holder").addClass("display").addClass("successful");$(document).find(".auth_form .message_holder .message").text(data.messages[0]);$(document).find(".auth_form .message_holder .icon").attr("class","icon mdi mdi-alert-circle-outline");return}
$(document).find(".auth_form form").removeClass("loading").addClass("failure");$(document).find(".auth_form form .btn.submit").removeClass("loading");$(document).find(".auth_form form .btn.submit").addClass("failure");$(document).find(".auth_form form .btn.submit .message").text(window.lang.return("retry"));$(document).find(".auth_form .message_holder").addClass("display");$(document).find(".auth_form .message_holder .message").text(data.messages[0]);$(document).find(".auth_form .message_holder .icon").attr("class","icon mdi mdi-alert-circle-outline")}}},user_area:{events:{rendering:function(){window.ui.lock.off("user_area");var userData=window.app.config.user.data;if(userData.username){window.ui.link.navigate("user/"+userData.username)}else{window.user.loggedOut(!0)}
var promise=$.Deferred();promise.reject("HALT");return promise}}},user_library:{events:{ready:function(){var tab=window.ui.page.data.becli.single.tab;$(document).find(".tabs ._"+tab).addClass("active")[0].scrollIntoView()},}},user_edit:{events:{ready:function(){var tab=window.ui.page.data.becli.single.tab;$(document).find(".tabs ._"+tab).addClass("active")
$(document).on("click","#session_list .del_sess",function(e){var sid=$(this).data("sess-id");window.app.becli.exe("alert",{},{endpoint:"user_edit?tab=sessions&action=submit",post:{id:sid},c_callback:function(sta,data,args){window.ui.page.reload()}})});$(document).on("click","body #main .content ._cancel_sub",function(e){var _id=$(this).data("sub-id");window.bof_modal.create({title:window.lang.return("confirm",{ucfirst:!0}),content:window.lang.return("sub_cancel"),buttons:[["btn-primary the_loading_button",window.lang.return("confirm",{ucfirst:!0}),"window.app.actions.user.unsubscribe(\""+_id+"\")"]],cancelHook:"back"})})},unloading:function(){$(document).off("click","#session_list .del_sess");$(document).off("click","body #main .content ._cancel_sub")}}},user_pay:{gateways_data:null,currency_data:null,purchase_data:null,functions:{calc:function(){var gateway_name=window.app.pages.user_pay.selected_gateway;var gateway_data=window.app.pages.user_pay.gateway_data[gateway_name];var input_value=parseFloat($(document).find(".add_fund_wrapper .pgts_wrapper .is_wrapper .bof_input").val());var fee_mul=gateway_data.fee?(1+(gateway_data.fee/100)):1;var fee=input_value?Number((input_value*(fee_mul-1)).toFixed(2)):"?";var final_value=input_value?Number((input_value*fee_mul).toFixed(2)):"?";$(document).find(".add_fund_wrapper .pgts_wrapper .is_wrapper .details span b#amount_fee i").text(fee);$(document).find(".add_fund_wrapper .pgts_wrapper .is_wrapper .details span b#amount_full i").text(final_value);$(document).find(".add_fund_wrapper .pgts_wrapper .btns_wrapper .btn span").text(final_value+" "+window.app.pages.user_pay.currency_data.symbol)}},events:{ready:function(amount){if(window.ui.page.curr().data.becli.single.gateways){window.app.pages.user_pay.gateway_data=window.ui.page.curr().data.becli.single.gateways;window.app.pages.user_pay.currency_data=window.ui.page.curr().data.becli.single.currency;window.app.pages.user_pay.purchase_data=null}
$(document).on("click",".add_fund_wrapper .pgts_wrapper .pgts .pgt",function(e){if($(this).hasClass("selected"))return;$(document).find(".add_fund_wrapper .pgts_wrapper .pgts .pgt.selected").removeClass("selected");$(this).addClass("selected");var name=$(this).data("name");var data=window.app.pages.user_pay.gateway_data[name];window.app.pages.user_pay.selected_gateway=name;window.app.pages.user_pay.functions.calc()});$(document).on("change",".add_fund_wrapper .pgts_wrapper .is_wrapper .bof_input",function(){window.app.pages.user_pay.functions.calc()});$(document).on("input",".add_fund_wrapper .pgts_wrapper .is_wrapper .bof_input",function(){window.app.pages.user_pay.functions.calc()});$(document).on("click",".add_fund_wrapper .pgts_wrapper .btns_wrapper .btn",function(e){window.app.becli.exe("button",{dom:$(this),},{endpoint:"user_pay_get_link",post:{gateway:window.app.pages.user_pay.selected_gateway,amount:$(document).find(".add_fund_wrapper .pgts_wrapper .is_wrapper .bof_input").val(),purchase_data:window.app.pages.user_pay.purchase_data?JSON.stringify(window.app.pages.user_pay.purchase_data):null},c_callback:function(sta,data){if(sta){if(data.type=="html"){$(document).find(".add_fund_wrapper .pgts_wrapper").html("<div class='pay_html'>"+data.content+"</div>")}else if(data.type=="link"){window.location.href=data.link}else if(data.type=="script"){window.bof._loadExtension({name:"bof_gateway_"+window.app.pages.user_pay.selected_gateway,path:data.link,base:"",dir:"",version:!1}).done(function(){window["bof_gateway_"+window.app.pages.user_pay.selected_gateway].setup(data)}).fail(function(){})}}},reload_after:!1})});$(document).find(".add_fund_wrapper .pgts_wrapper .pgts .pgt:first-child").click();if(amount?typeof(amount)=="number":!1){$(document).find(".add_fund_wrapper .pgts_wrapper .is_wrapper .bof_input[name=amount]").val(amount);window.app.pages.user_pay.functions.calc()}},unloading:function(){$(document).off("click",".add_fund_wrapper .pgts_wrapper .pgts .pgt");$(document).off("change",".add_fund_wrapper .pgts_wrapper .is_wrapper .bof_input");$(document).off("click",".add_fund_wrapper .pgts_wrapper .btns_wrapper .btn");$(document).off("input",".add_fund_wrapper .pgts_wrapper .is_wrapper .bof_input")}}},user_verify:{events:{ready:function(){var tab=window.ui.page.data.becli.single.tab;$(document).find(".tabs ._"+tab).addClass("active")}}},user_subs:{cache:{},pay:function(){window.bof_modal.set_loading("initial");window.becli.exe({endpoint:"user_pay_ini",callBack:function(sta,data){if(!sta)return;window.app.pages.user_pay.gateway_data=data.gateways;window.app.pages.user_pay.currency_data=data.currency;window.app.pages.user_pay.purchase_data={type:"user_subs_plan",hook:window.app.pages.user_subs.cache.hash,period:window.app.pages.user_subs.cache.period};window.ui.theme.part("pages/user_pay",{target:!1,dir:"theme",base:$_bof_config.assets_address}).done(function(html){window.render.mix(html,{single:data}).done(function(renderred){window.bof_modal.close();window.bof_modal.create({class:"plan_pay_inline",title:"Pay",content:renderred,});window.app.pages.user_pay.events.ready(parseFloat(window.app.pages.user_subs.cache.price.replace(/[^\d.-]/g,'')))})});$(document).on("modal_destroyed",function(){window.app.pages.user_pay.events.unloading()})}})},events:{displaying:function(){},ready:function(){$(document).on("click","body #main .content #plans .plans_wrapper.simpler .plan_wrapper",function(e){var hash=$(this).data("hash");window.app.pages.user_subs.cache.hash=hash;$(document).find("body #main .content #plans .plans_wrapper.simpler .plan_wrapper").removeClass("active");$(this).addClass("active");$(document).find("body #main .content #plans .plans_wrapper.main_one .plan_wrapper.active").removeClass("active");$(document).find("body #main .content #plans .plans_wrapper.main_one .plan_wrapper.id_"+hash).addClass("active");$(document).find("body #main .content #plans .plans_wrapper.main_one .plan_wrapper.active .periods .period:first-child").click()});$(document).on("click","body #main .content #plans .plans_wrapper.main_one .plan_wrapper .periods .period",function(e){$(document).find("body #main .content #plans .plans_wrapper.main_one .plan_wrapper .periods .period.active").removeClass("active");$(this).addClass("active");var range=$(this).data("range");window.app.pages.user_subs.cache.period=range;var rangeTitle=window.lang.return(range,{ucfirst:!0});var hash=$(this).parents(".plan_wrapper").data("hash");var plan=window.ui.page.curr().data.becli.single.plans[hash];var prices=plan.prices;var price=prices.final_parsed[range];$(document).find("body #main .content #plans .plans_wrapper .plan_wrapper.id_"+hash+" div.price ._n").text(price);$(document).find("body #main .content #plans .plans_wrapper.simpler .plan_wrapper.id_"+hash+" div.price .pname").text(rangeTitle);$(document).find("body #main .content .continue_wrapper .selected_plan .val").text(window.ui.page.curr().data.becli.single.plans[hash].name);$(document).find("body #main .content .continue_wrapper .selected_plan_period .val").text(rangeTitle);$(document).find("body #main .content .continue_wrapper .selected_plan_price .val").text(price);window.app.pages.user_subs.cache.price=price;window.app.pages.user_subs.cache.hash=hash;if(plan.discount){var o_price=prices.original_parsed[range];$(document).find("body #main .content #plans .plans_wrapper .plan_wrapper.id_"+hash+" div.price .old").text(o_price);$(document).find("body #main .content .continue_wrapper .selected_plan_price .val").html("<span class='old'>"+o_price+"</span>"+price)}});$(document).on("click","body #main .content .continue_wrapper .button_wrapper .btn",function(e){var plan=window.app.pages.user_subs.cache;window.bof_modal.set_loading("initial");window.becli.exe({endpoint:"purchase_subs_plan",post:{hash:plan.hash,period:plan.period},callBack:function(sta,data){var resultModalButtons=[];if(sta?(data?.hook=="subscribe_link"):!1){window.location.href=data.link;return}else if(sta){resultModalButtons.push(["btn-primary",window.lang.return("purchases",{ucfirst:!0}),"window.ui.link.navigate( \"user_edit?tab=transactions\" ); window.bof_modal.close(); window.bof_modal.close();"])}else if(data?data.hook=="insufficient_fund":!1){resultModalButtons.push(["btn-primary",window.lang.return("pay",{ucfirst:!0}),"window.app.pages.user_subs.pay(); window.bof_modal.close(); window.bof_modal.close();"])}
window.bof_modal.close();if(data.messages[0]!="403"){window.bof_modal.create({class:"purchase_modal",title:data.messages[0],content:data.more,buttons:resultModalButtons})}}})});$(document).find("body #main .content #plans .plans_wrapper.simpler .plan_wrapper:first-child").click()},unloading:function(){$(document).off("click","body #main .content #plans .plans_wrapper.simpler .plan_wrapper");$(document).off("click","body #main .content #plans .plans_wrapper.main_one .plan_wrapper .periods .period");$(document).off("click","body #main .content .continue_wrapper .button_wrapper .btn")}}},upload:{events:{ready:function(){window.bof_upload.ready()},unloading:function(){window.bof_upload.unloading()},},},object_browse:{inied:!1,events:{displaying:function(){var promise=$.Deferred();var rangePromise=$.Deferred();var rangePromise2=$.Deferred();if(!window.app.pages.object_browse.inied){window.app.pages.object_browse.inied=!0;window.bof._loadExtension({name:"nouislider_js",path:"nouislider.min.js",base:"https://cdnjs.cloudflare.com/ajax/libs/noUiSlider/15.6.0/",dir:"",skipNameCheck:!0,version:!1}).done(function(){rangePromise.resolve()}).fail(function(){rangePromise.reject("Loading nouislider.js failed")});window.bof._loadCSS({name:"nouislider_css",path:"nouislider.min.css",base:"https://cdnjs.cloudflare.com/ajax/libs/noUiSlider/15.6.0/",dir:"",skipNameCheck:!0,version:!1}).done(function(){rangePromise2.resolve()}).fail(function(){rangePromise2.reject("Loading nouislider.css failed")})}else{rangePromise.resolve();rangePromise2.resolve()}
$.when(rangePromise,rangePromise2).done(function(){promise.resolve()}).fail(function(err){promise.reject(err)})
$(document).on("click","body.page_object_browse #main .bb_filters .bb_buttons .btn._apply",function(e){var filters_raw=$(".bb_filters :input").serializeArray();var filters={};for(var i=0;i<filters_raw.length;i++){var filter=filters_raw[i];if(filter.value!==""&&filter.value!=="__all__"){filters[filter.name]=filter.value}}
var url=window.ui.page.args.urlData.url.path;if(Object.keys(filters).length)url+="?"+$.param(filters);window.ui.link.navigate(url)});return promise},unloading:function(args){$(document).off("click","body.page_object_browse #main .bb_filters .bb_buttons .btn._apply");if(window.ui.page.curr().name!=args.name){$(document).find("body.page_object_browse.muse_active #main .bb_filters").remove();$(document).find("body.page_object_browse.muse_active #main .bb_content").remove();window.ui.body.removeClass("page_object_browse")}},ready:function(){var filters=window.ui.page.curr().data.becli.single.filters;for(var i=0;i<Object.keys(filters).length;i++){var filter_name=Object.keys(filters)[i];var filter=filters[filter_name];if(filter.input?filter.input.type=="range_two":!1){var slider=document.getElementById('range_'+filter_name);if(slider){var _smi=filter.input.min;var _sma=filter.input.max;if(filter.input.value){var _vs=filter.input.value.split("-");if(_vs.length==2){_smi=_vs[0];_sma=_vs[1]}}
noUiSlider.create(slider,{start:[_smi,_sma],connect:!0,range:{'min':filter.input.min,'max':filter.input.max},tooltips:{to:function(numericValue){return numericValue.toFixed(0)}},pips:{mode:'count',values:5}});if(slider.noUiSlider){slider.noUiSlider.on("update",function(values,handle,unencoded){var name=this.target.getAttribute("ID").substr("range_".length);var filter=window.ui.page.curr().data.becli.single.filters[name];var filter_0=filter.input.min;var filter_1=filter.input.max;if(unencoded[0]!=filter_0||unencoded[1]!=filter_1){$(document).find("input[name="+name+"]").val(unencoded[0].toFixed(0)+"-"+unencoded[1].toFixed(0))}else{$(document).find("input[name='"+name+"']").val("")}})}}}}
if(Object.keys(window.ui.page.args.urlData.url.query).length)
$("#main")[0].scrollTop=$(".bb_content")[0].offsetTop}}},},_extension_new:function($name,_extension_links,$loadAfter){var promiseToLoadExtension=$.Deferred();if(_extension_links===!1)
return;if(Array.isArray(_extension_links)){var _array_promises=[];for(var i=0;i<_extension_links.length;i++){var _extension_link=_extension_links[i];var _extension_link_exe=_extension_link.type=="js"?window.bof._loadExtension(_extension_link):window.bof._loadCSS(_extension_link);_array_promises.push(_extension_link_exe)}
$.when.apply($,_array_promises).done(function(){promiseToLoadExtension.resolve()}).fail(function(){promiseToLoadExtension.reject();window.bof.log("Extension new: "+_extension_link_exe+" failed")})}else{var _exe=_extension_links.type!="css"?window.bof._loadExtension(_extension_links):window.bof._loadCSS(_extension_links);_exe.done(function(){promiseToLoadExtension.resolve()}).fail(function(){promiseToLoadExtension.reject();window.bof.log("Extension new: "+_extension_link_exe+" failed")})}
return promiseToLoadExtension},getConfig:function($reload){var promise=$.Deferred();if(window.app.config&&!$reload){promise.resolve(window.app.config)}else{window.becli.exe({endpoint:"client_config",liquid:!0,callBack:function(sta,data){if(sta){if(data.pages){for(var i=0;i<Object.keys(data.pages).length;i++){var pageName=Object.keys(data.pages)[i];var pageArgs=data.pages[pageName];pageArgs.events=pageArgs.events?pageArgs.events:{};var oldPageArgs={};if(Object.keys(window.app.pages).includes(pageName))
oldPageArgs=window.app.pages[pageName];window.app.pages[pageName]=$.extend(pageArgs,oldPageArgs)}}
window.app.config=data;promise.resolve(data)}else{promise.reject()}}})}
return promise},renderMenu:function($name){var promise=$.Deferred();var Data=window.app.config.theme.menus[$name];window.ui.theme.part("theme/parts/menu",{base:$_bof_config.assets_address,target:!1}).done(function(Html){window.render.mix(Html,Data).done(function(Output){promise.resolve(Output)})});return promise},}
window.bof_dropdown={listen:function(){$(document).on("click",".dropdown_button",function(e){var base=e.target;var $base=$(base);var did=$base.data("dropdown-id")?$base.data("dropdown-id"):$(this).data("dropdown-id");var target=$(document).find("#"+did);var $target=$(target);$("#main").on("click",window.bof_dropdown.listen_close_click);$("#main").on("scroll",window.bof_dropdown.listen_close_slide);if($target.hasClass("active")){$(document).find(".bof_dropdown.active").removeClass("active").removeClass("active_parent").removeClass("active_child");$("#main").off("click",window.bof_dropdown.listen_close_click);$("#main").off("scroll",window.bof_dropdown.listen_close_slide);return}
$(document).find(".bof_dropdown.active").removeClass("active").removeClass("active_parent").removeClass("active_child");window.bof_dropdown._exe($base,$target);$target.addClass("active").addClass("active_child");$target.parents(".bof_dropdown").addClass("active").addClass("active_parent")})},listen_close_click:function(e){var target=e.target;var $target=$(e.target);if($target.parents(".dropdown_button").length||$target.hasClass("dropdown_button"))
return;if($target.parents(".bof_dropdown").length)
return;window.bof_dropdown.close()},listen_close_slide:function(e){window.bof_dropdown.close()},close:function(){$(document).find(".bof_dropdown.active").removeClass("active");$("#main").off("click",window.bof_dropdown.listen_close_click);$("#main").off("scroll",window.bof_dropdown.listen_close_slide)},_exe:function($base,$target){$target.removeClass("flow");$target.css("left","auto");$target.css("top","auto");$target.css("bottom","auto");var window_width=$(window).width();var window_height=$(window).height();var target_width=$target.width();var target_height=$target.height();var target_top=0;var target_left=0;var base_top=$base.offset().top;var base_left=$base.offset().left;var base_width=$base.width();var base_height=$base.height();target_left=base_left-((target_width-base_width)/2);target_top=base_top+base_height+30;if(target_left+target_width>window_width-60)
target_left=window_width-(target_width+60);if(target_top+target_height>window_height-80)
target_top=base_top-(base_height+target_height);if(target_top<30)
target_top=30;if(target_left<30)
target_left=30;$target.css("right","auto");$target.css("bottom","auto");$target.css("left",target_left+"px");$target.css("top",target_top+"px");if(target_top+target_height>window_height-30){$target.addClass("flow");$target.css("bottom","30px")}}}
window.bof_input={cache:{dropzones:[]},hook:function(){},load_daterangepicker:function(){var assets={moment_js:{type:"js",name:"moment_js",path:"third/daterangepicker/moment.min.js",skipNameCheck:!0,base:"bof_assets",version:!1},daterangepicker:[{type:"js",name:"moment_js",path:"third/daterangepicker/moment.min.js",skipNameCheck:!0,base:"bof_assets",version:!1},{type:"js",name:"daterangepicker_js",path:"third/daterangepicker/daterangepicker.js",skipNameCheck:!0,base:"bof_assets",version:!1},{type:"css",name:"daterangepicker_css",path:"js/third/daterangepicker/daterangepicker.css",dir:!1,base:"bof_assets",version:!1},{type:"css",name:"daterangepicker_custom_css",path:"js/third/daterangepicker/_custom.css",dir:!1,base:"bof_assets",version:!1}],};var promiseToLoadAll=$.Deferred();window.bof._loadExtension(assets.moment_js).done(function(){var _ps=[];for(var i=0;i<assets.daterangepicker.length;i++){var di=assets.daterangepicker[i];if(di.type=="js")
_ps.push(window.bof._loadExtension(di));else _ps.push(window.bof._loadCSS(di))}
$.when.apply($,_ps).done(function(){promiseToLoadAll.resolve()})})
return promiseToLoadAll},hook_daterangepicker:function(){if($('.bof_time_range').length){var t=$('.bof_time_range').daterangepicker({"showDropdowns":!0,"timePicker":!0,"timePicker24Hour":!0,"startDate":moment().subtract(7,'days'),"endDate":moment(),"opens":"center","drops":"auto",autoUpdateInput:!1,locale:{format:'YY-MM-DD hh:mm'}});$('.bof_time_range').on('apply.daterangepicker',function(ev,picker){$(this).val(picker.startDate.format('YYYY-MM-DD hh:mm')+' - '+picker.endDate.format('YYYY-MM-DD hh:mm'))})}
if($('.bof_input[type=datetime]:not(.ymd)').length){$('.bof_input[type=datetime]:not(.ymd)').daterangepicker({"singleDatePicker":!0,"showDropdowns":!0,"timePicker":!0,"timePicker24Hour":!0,"opens":"center","drops":"auto",autoUpdateInput:!1,locale:{format:'YY-MM-DD hh:mm:ss'}});$('.bof_input[type=datetime]:not(.ymd)').on('apply.daterangepicker',function(ev,picker){$(this).val(picker.startDate.format('YYYY-MM-DD hh:mm:ss'))})}
if($('.bof_input.ymd[type=datetime]').length){$('.bof_input.ymd[type=datetime]').daterangepicker({"singleDatePicker":!0,"showDropdowns":!0,"timePicker":!1,"timePicker24Hour":!1,"opens":"center","drops":"auto",autoUpdateInput:!1,locale:{format:'YY-MM-DD'}});$('.bof_input.ymd[type=datetime]').on('apply.daterangepicker',function(ev,picker){$(this).val(picker.startDate.format('YYYY-MM-DD'))})}},unhook:function(){$(document).find("form.dropzone_form").remove();$(document).find(".dz-hidden-input").remove();$(document).find(".daterangepicker.openscenter").remove();if(window.bof_input.cache.dropzones?window.bof_input.cache.dropzones.length:!1){for(var i=0;i<window.bof_input.cache.dropzones.length;i++){var dropZone=window.bof_input.cache.dropzones[i];try{dropZone.destroy()}catch($err){}
window.bof_input.cache.dropzones=[]}}},listen:function(){$(document).on("click",".file_input_wrapper .mask",window.bof_input.callByClick)
$(document).on("click",".file_input_wrapper .preview_buttons .delete",function(){var p=$(this).parents(".file_input_wrapper");p.removeClass("has_preview");p.find("input.ci").val("");p.find("input.cp").val("");p.removeClass("_started").removeClass("_done").removeClass("_doing").removeClass("_failed").find(".mask_text").text("Upload")})
$(document).on("click",".file_input_wrapper .preview_buttons .open",function(){var p=$(this).parents(".file_input_wrapper");var img=p.find(".preview").css("background-image").substr(5,p.find(".preview").css("background-image").length-7);var winOpen=window.open(img,'_blank');if(winOpen)
winOpen.focus();else alert('Please allow popups for this website')})
$(document).on("click",".object_input_wrapper .objects_wrapper .object_wrapper ._close",function(){var ow=$(this).parents(".object_wrapper");var input=$(this).parents(".object_input_wrapper").find("._ids");var ID=ow.data("id").toString();var IDS=input.val()?input.val().split(","):[];if(IDS.includes(ID))
IDS=window._g.removeValFromArray(IDS,ID);input.val(IDS.join(","));$(document).trigger("bofInput_change",[input]);var ows=$(this).parents(".objects_wrapper");if(IDS.length)ows.addClass("has_items");else ows.removeClass("has_items");ow.remove()});$(document).on("click",".bof_dropdown.object_dropdown .search_input_wrapper .btn-primary",function(){var dd=$($(this).parents(".bof_dropdown")[0]);var object_type=dd.find(".search_input_wrapper input.bofInput_object_type").val();var object_sub_type=dd.find(".search_input_wrapper input.bofInput_object_sub_type").val();var extra_query=dd.find(".search_input_wrapper input.bofInput_extra_query").val();var query=dd.find(".search_input_wrapper input.bofInput_bof_query").val();var _add=dd.parents(".object_input_wrapper").find(".dropdown_button._add");dd.find(".search_results_wrapper").html("<span class='loading'>Loading ...</span>")
window.becli.exe({ID:"o_search",pageAttachment:!0,endpoint:"bofInput/object/",post:{bofInput_bof_query:query,bofInput_object_type:object_type,bofInput_object_sub_type:object_sub_type,bofInput_extra_query:extra_query},callBack:function(sta,data){window.ui.theme.part("theme/parts/object_search_result",{target:!1,base:$_bof_config.assets_address}).done(function(htmlData){window.render.mix(htmlData,data.objects).done(function(renderedData){dd.find(".search_results_wrapper").html(renderedData);setTimeout(function(){window.bof_dropdown._exe(_add,dd)},50)})})}})});$(document).on("click",".bof_dropdown.object_dropdown .search_input_wrapper .btn-secondary",function(){$($(this).parents(".bof_dropdown")[0]).removeClass("active")});$(document).on("click",".object_input_wrapper .objects_wrapper .object_wrapper.new ._add",function(){if(!$(this).hasClass("inied"))
$(this).addClass("inied").parents(".object_input_wrapper").find(".search_input_wrapper .btn-primary").click();})
$(document).on("click",".bof_dropdown.object_dropdown .search_results_wrapper .search_object_wrapper ._select",function(){var _ID=$(this).data("id").toString();var ows=$(this).parents(".object_input_wrapper").find(".objects_wrapper");var _title=$(this).data("title");var _image=$(this).data("image");var ids=$(this).parents(".object_input_wrapper").find("._ids").val()?$(this).parents(".object_input_wrapper").find("._ids").val().split(","):[];var _string="";$(this).parents(".search_object_wrapper").addClass("added");if(ids.includes(_ID)){ids=window._g.removeValFromArray(ids,_ID);ids.push(_ID);return}
if(ows.hasClass("single")&&ids.length){ids=[];$(this).parents(".object_input_wrapper").find(".objects_wrapper .object_wrapper:not(.new)").remove()}
if(_image){_string='<div class="object_wrapper has_image" data-id="'+_ID+'">\
            <div class="_image_wrapper">\
              <div class="_image" style="background-image:url(\''+_image+'\')"></div>\
            </div>\
          <div class="_title">'+_title+'</div>\
          <div class="mdi mdi-close _close"></div>\
        </div>'}else{_string='<div class="object_wrapper" data-id="'+_ID+'">\
          <div class="_title">'+_title+'</div>\
          <div class="mdi mdi-close _close"></div>\
        </div>'}
$(this).parents(".object_input_wrapper").find(".objects_wrapper .new").before(_string);ids.push(_ID);$(this).parents(".object_input_wrapper").find("._ids").val(ids.join(","))
$(document).trigger("bofInput_change",[$(this).parents(".object_input_wrapper").find("._ids").val]);if(ids.length)ows.addClass("has_items");else ows.removeClass("has_items")})},callByClick:function(){var ID="form"+window._g.uniqid(5);var clicked_item=$(this);var handler=clicked_item.parents(".file_input_wrapper");handler.addClass(ID);var setting={};setting.type=handler.data("type");setting.object_type=handler.data("object-type");setting.accept=handler.data("accept");setting.chunk=handler.data("chunk")=="yes";setting.chunk_size=handler.data("chunk-size");setting.max_files=handler.data("max_files")?handler.data("max_files"):1;$("body").append("<form style='display:none' class='dropzone_form' ID='"+ID+"' data-endpoint='bofInput/file/' data-hasFile='yes' data-type='file' data-callback='window.bof_input.callback' data-callback_param='"+ID+"'>\
    <input type='file' name='the_file' accept="+(setting.accept?setting.accept:"*")+">\
    </form>");$(document).on("change","form#"+ID+" input",function(){$(document).find("form#"+ID).submit()})
window.bof_input.callbefore(ID);window.bof_input.dropzone_start(ID,setting)},dropzone_start:function(ID,setting,args){args=args?args:{};window.bof._loadExtension({type:"js",name:"dropzone_js",path:"third/dropzone-5.7.0/dist/dropzone.js",base:"bof_assets",skipNameCheck:!0,version:!1,ini:function(){Dropzone.autoDiscover=!1}}).done(function(){var def_args={url:window.config.endpoint_address+"bofInput/file/?type="+setting.type+"&object_type="+setting.object_type,paramName:"$file",acceptedFiles:setting.accept,retryChunksLimit:1,parallelUploads:1,createImageThumbnails:!1,maxFilesize:2000,init:function(){window.bof_input.dropzone_init(this,setting,ID)},}
args=$.extend(def_args,args);if(setting.chunk?setting.chunk!="no":!1){args.chunking=!0;args.retryChunks=!0;args.chunkSize=setting.chunk_size*1000*1000}
args.maxFiles=setting.max_files;var myDropzone=new Dropzone("#"+ID,args);window.bof_input.cache.dropzones.push(myDropzone)})},dropzone_init:function(myDropzone,setting,ID){myDropzone.clickableElements[0].click()
myDropzone.on("canceled",function(file){console.log("canceled")});myDropzone.on("error",function(file){console.log("error")});myDropzone.on("sending",function(file,xhr){window.becli.sign(xhr)});myDropzone.on("addedfile",function(file){window.bof_input.dropzone_progress("addedfile",this,ID);$(document).find(".file_input_wrapper."+ID).addClass("_doing").find(".mask_text").text("0%")});myDropzone.on("uploadprogress",function(file){window.bof_input.dropzone_progress("uploadprogress",this,ID)});myDropzone.on("complete",function(){window.bof_input.dropzone_progress("complete",this,ID)})},dropzone_report:function(myDropzone,ID){var _report={total_files:0,total_done:0,total_fail:0,total_active:0,total_queued:0,total_size:0,total_size_uped:0,_allDone:!1};if(!myDropzone.files?!0:!myDropzone.files.length)
return _report;_report.total_files=myDropzone.files.length;for(var i=0;i<myDropzone.files.length;i++){var __file=myDropzone.files[i];_report.total_size+=__file.size;var total_uped=__file.upload.bytesSent;if(total_uped>__file.size)total_uped=__file.size;if(__file.status=="error"){_report.total_fail+=1;_report.total_size-=__file.size}else if(__file.status=="queued"){_report.total_queued+=1}else if(__file.status=="success"){_report.total_done+=1;_report.total_size_uped+=__file.size}else if(__file.status=="uploading"){_report.total_active+=1;_report.total_size_uped+=total_uped}}
_report.progress=Math.round(_report.total_size_uped/_report.total_size*100);_report.progress=_report.progress>100?100:_report.progress;_report._allDone=_report.total_fail+_report.total_done==_report.total_files&&_report.total_files>=1&&_report.total_active==0;return _report},dropzone_progress:function(event,myDropzone,ID){var _report=window.bof_input.dropzone_report(myDropzone,ID);$(document).find(".file_input_wrapper."+ID).addClass("_doing").find(".mask_text").text(_report.progress+"%")
$(document).find(".file_input_wrapper."+ID+" .mask .progress").css("width",_report.progress+"%");if(_report._allDone){var __done=!0;var __response=null;try{__response=JSON.parse(myDropzone.files[0].xhr.responseText)}catch(e){__done=!1}
window.bof_input.callback(__done,__response,ID)}},callbefore:function(ID){$(document).find(".file_input_wrapper."+ID).addClass("bof_upload").addClass("_started").removeClass("_done").removeClass("_doing").removeClass("_failed").find(".mask_text").text("Wait ...")},callback:function(sta,data,ID){$(document).find("#"+ID).remove();$(document).find(".file_input_wrapper."+ID).removeClass("_doing");$(document).find(".file_input_wrapper."+ID+" .mask .progress").css("width","0");if(sta?(data.messages[0]=="done"||data.messages[0]===window.lang.cache.done):!1){$(document).find(".file_input_wrapper."+ID).addClass("_done").find(".mask_text").text(window.lang.cache.done);$(document).find(".file_input_wrapper."+ID+" .ci").val(data.file_id);$(document).find(".file_input_wrapper."+ID+" .cp").val(data.file_pass);if(data.file_preview){$(document).find(".file_input_wrapper."+ID).addClass("has_preview");$(document).find(".file_input_wrapper."+ID+" .preview").css("background-image","url('"+data.file_preview+"')")}
setTimeout(function(){if($(document).find(".file_input_wrapper."+ID).hasClass("_done")){$(document).find(".file_input_wrapper."+ID).removeClass("_done").find(".mask_text").text("upload")}},2500)}else{$(document).find(".file_input_wrapper."+ID).addClass("_failed").find(".mask_text").text(data.messages[0])}},exe_display_rules:function($inputs){for(var i=0;i<Object.keys($inputs).length;i++){var __input_key=Object.keys($inputs)[i];var __input=$inputs[__input_key];if(__input.display_on){$(document).find("#item_"+__input_key).addClass("hideByRules");var __rules=__input.display_on;var __cond=__input.display_on_cond?__input.display_on_cond:"and";var ___met=null;var ___met_all=!0;var ___met_one=!1;for(var z=0;z<Object.keys(__rules).length;z++){var __rule_key=Object.keys(__rules)[z];var __target_input=$inputs[__rule_key].input;var __target_value=window.bof_input.get_input(__target_input)
var __rule=__rules[__rule_key];var __rule_cond=__rule[0];var __rule_args=__rule[1];if(__rule_cond=="equal"){if(__target_value==__rule_args)
___met_one=!0;else ___met_all=!1}else if(__rule_cond=="in_array"){if(__rule_args.indexOf(__target_value)>-1)
___met_one=!0;else ___met_all=!1}else{bof.log("app.ui.content_single.exe_display_rules => failed to run condition "+__rule_cond)}}
if(__cond=="and"&&___met_all)
___met=!0;else if(__cond=="or"&&___met_one)
___met=!0;else ___met=!1;if(___met){$(document).find("#item_"+__input_key).removeClass("hideByRules")}}}},get_input:function(__target_input){var __target_dom=$(document).find("[name="+__target_input.name+"]");var __target_value=null;if(__target_input.type=="text"||__target_input.type=="textarea"||__target_input.type=="hidden")
__target_value=__target_dom.val();else if(__target_input.type=="select")
__target_value=__target_dom.find("option:selected").val();else if(__target_input.type=="select_i")
__target_value=$(document).find("[name="+__target_input.name+"]:checked").val();else if(__target_input.type=="checkbox")
__target_value=$(document).find("[name="+__target_input.name+"]").is(":checked");else bof.log("app.ui.content_single.exe_display_rules => failed to get __target_value for type:"+__target_input.type);return __target_value},}
window.bof_modal={cache:{inputs:[],groups:[],group:null,btn_text:null,},create:function($args){if(!$args)
return;var $class=$args.class?$args.class:!1;var $title=$args.title?$args.title:!1;var $tip=$args.tip?$args.tip:!1;var $content=$args.content?$args.content:!1;var $content_after=$args.content_after?$args.content_after:!1;var $inputs=$args.inputs?$args.inputs:!1;var $groups=$args.groups?$args.groups:!1;var $buttons=$args.buttons?$args.buttons:!1;var $layer=$args.layer?$args.layer:1;var $cancelHook=$args.cancelHook?$args.cancelHook:"cancel";$("body").addClass("active_modal");if(!$class)
$class="";$class=$class+" "+($buttons?"has_buttons":"no_buttons");var $html="";$html=$html+"<div class='modal_hover close_modal_handle layer_"+$layer+" "+$class+"'></div>";$html=$html+"<div class='modal_wrapper layer_"+$layer+" "+$class+"'><div class='modal layer_"+$layer+" "+$class+"'><form>";if($title)
$html=$html+"<div class='title'>"+$title+"<span class='mdi mdi-close close_modal_handle'></span></div>";if($tip)
$html=$html+"<div class='tip'>"+$tip+"</div>";if($groups){var $groups_html="<div class='groups'>";for(var i=0;i<Object.keys($groups).length;i++){var $group_k=Object.keys($groups)[i];var $group=$groups[$group_k];$groups_html+="<div class='group group_"+$group[0]+"' data-id='"+$group[0]+"'>"+$group[1]+"</div>"}
$groups_html+="</div>";$html+=$groups_html}
if($content)
$html=$html+"<div class='content def_scroll after'>"+$content+"</div>";window.bof_modal.render_inputs($inputs).done(function(inputs_renderred){if(inputs_renderred)
$html=$html+"<div class='inputs'>"+inputs_renderred+"</div>";if($content_after)
$html=$html+"<div class='content def_scroll after'>"+$content_after+"</div>";$html=$html+"<div class='response'></div>";if($buttons){$html=$html+"<div class='buttons'>";for(var i=0;i<$buttons.length;i++){$html=$html+"<div class='button'><a class='btn "+$buttons[i][0]+"' onClick='"+$buttons[i][2]+"'>"+$buttons[i][1]+"</a></div>"}
$html=$html+"<div class='button'><a class='btn btn-secondary close_modal_handle'>"+window.lang.return($cancelHook,{ucfirst:!0})+"</a></div>";$html=$html+"</div>"}
$html=$html+"</form></div></div>";$("body").append($html);if(window.app.config.mobile){$(document).find("body.mobile .modal_wrapper").css("height",$(window).height())}
if($layer==1){$(document).find(".modal .inputs .input").addClass("hideByGroup")
$(document).find(".modal .inputs .input.group_a").removeClass("hideByGroup")
$(document).find(".modal .groups .group.group_a").addClass("active")
window.bof_modal.cache.group="a";$(document).on("click",".modal .groups .group",function(e){var selectedGroup=$(e.target).data("id");window.bof_modal.cache.group=selectedGroup;$(document).find(".modal .inputs .input").addClass("hideByGroup");$(document).find(".modal .inputs .input.group_"+selectedGroup).removeClass("hideByGroup")
$(document).find(".modal .content .a_content").addClass("hideByGroup");$(document).find(".modal .content .a_content.group_"+selectedGroup).removeClass("hideByGroup")
$(document).find(".modal .groups .group.active").removeClass("active");$(document).find(".modal .groups .group.group_"+selectedGroup).addClass("active");window.bof_input.exe_display_rules($inputs);$(document).find(".modal .inputs .input:not(.group_"+selectedGroup+")").addClass("hideByGroup")});$(document).on("click",".close_modal_handle",function(){window.bof_modal.close()});window.bof_input.exe_display_rules($inputs);$(document).find(".modal .inputs .input:not(.group_"+window.bof_modal.cache.group+")").addClass("hideByGroup");if($groups){window.bof_modal.cache.group=$groups[0][0];$(document).find(".modal .inputs .input.group_"+window.bof_modal.cache.group).removeClass("hideByGroup")
$(document).find(".modal .groups .group.group_"+window.bof_modal.cache.group).addClass("active")}
$(document).on("change",".modal .bof_input",function(e){window.bof_input.exe_display_rules($inputs);$(document).find(".modal .inputs .input:not(.group_"+window.bof_modal.cache.group+")").addClass("hideByGroup")})}
$(document).trigger("modal_created");window.bof_input.hook()})},render_inputs:function($inputs){var promiseToRenderAll=$.Deferred();var promises=[];if(!$inputs){promiseToRenderAll.resolve();return promiseToRenderAll}
for(var i=0;i<Object.keys($inputs).length;i++){var $input_k=Object.keys($inputs)[i];var $input_v=$inputs[$input_k];var $input_promise=window.bof_modal.render_input($input_k,$input_v);promises.push($input_promise)}
$.when.apply($,promises).done(function(){var inputs=Array.prototype.slice.call(arguments,0);promiseToRenderAll.resolve(inputs.join("\n"))});return promiseToRenderAll},render_input:function($name,$data){var promiseToRender=$.Deferred();window.ui.theme.part("parts/o_input",{target:!1,dir:"theme",base:$_bof_config.assets_address}).done(function(html){window.render.mix(html,$data.input).done(function(renderred){var html="<div id='item_"+$data.input.name+"' class='setting_wrapper input group_"+$data.group+"' >";if($data.title)
html+="<div class='label'>"+$data.title.replace("<br>","")+"</div>";else if($data.label)
html+="<div class='label'>"+$data.label.replace("<br>","")+"</div>";html+="<div class='input_wrapper'>"+renderred+"</div>";if($data.input.content)
html+="<div class='content'>"+$data.input.content+"</div>";if($data.tip)
html+="<div class='tip'>"+$data.tip+"</div>";html+="</div>";promiseToRender.resolve(html)})});return promiseToRender},close:function(){var l2=$(document).find(".modal_hover.layer_2").length?!0:!1;if(l2){$(document).find(".modal_hover.layer_2").remove();$(document).find(".modal.layer_2").remove();$(document).find(".modal_wrapper.layer_2").remove()}else{$(document).find(".modal_hover").remove();$(document).find(".modal_wrapper").remove();$(document).off("click",".modal .groups .group");$(document).off("click",".close_modal_handle");$("body").removeClass("active_modal")}
$(document).trigger("model_destroyed");$(document).trigger("modal_destroyed")},get:function($turnObject){var formData=$(document).find(".modal").find("form").serializeArray();if(!$turnObject)
return formData;var formObject={};for(var i=0;i<formData.length;i++)
formObject[formData[i].name]=formData[i].value;return formObject},set_loading:function($loadingType){$(document).find(".modal ._error").remove();if($loadingType=="initial"){var $html="";$html=$html+"<div class='modal_hover'></div>";$html=$html+"<div class='modal_wrapper ini_loading'><div class='modal ini_loading'><span class='mdi mdi-refresh'></span></div></div>";$("body").append($html)}else if($loadingType=="button"){window.bof_modal.cache.btn_text=$(document).find(".modal .the_loading_button").html();$(document).find(".modal .the_loading_button").html("<span class='mdi mdi-refresh spin'></span>")}},finish_loading:function($loadingType){if($loadingType=="initial"){}else if($loadingType=="button"){$(document).find(".modal .the_loading_button").html(window.bof_modal.cache.btn_text);window.bof_modal.cache.btn_text=null}},set_error:function($message){$(document).find(".modal ._error").remove();$(document).find(".modal .buttons").after("<div class='_error'><span class='mdi mdi-alert'></span>"+$message+"</div>")}}
window.bof_offline={listen:function(){$(document).on("click",".dropdown_button.download_menu_wrapper",function(){$(document).find("#download_drop .list").html("loading");window.bof_offline.ui.list()});$(document).on("click",".file_list .file",function(e){if($(e.target).parents(".buttons").length)return;window.bof_offline.db.get($(this).data("key")).then(item_w=>{window.m2_queue.set([item_w.item.data.muse])
window.m2_queue.active.setFocus()})});$(document).on("click",".file_list .file .buttons > div",function(e){var key=$(this).parents(".file").data("key");var action=$(this).attr("class");window.bof_offline.db.get(key).then(item_w=>{var item=item_w.item;if(action=="delete"&&item.state=="done"){window.bof_offline_cli.delete(item);window.bof_offline.ui.list()}
if(action=="cancel"&&["failed","paused","pending"].includes(item.state)){window.bof_offline_cli.delete(item);window.bof_offline.ui.list()}
if(action=="pause"&&item.state=="downloading"){window.bof_offline_cli.pause();setTimeout(function(){window.bof_offline_cli._markStop();window.bof_offline_cli.exe()},20)}
if(action=="start"&&(item.state=="paused"||item.state=="failed")){var dl_db=window.bof_offline.db._get();dl_db.getItem(item.key).then(_item=>{_item.state="pending";dl_db.setItem(item.key,_item).then(()=>{window.bof_offline_cli.exe()})})}})});if(window.app.config.mobile){$(document).find(".header .download_menu_wrapper").remove();$(document).find(".header .bof_dropdown.file_list").remove()}else{$(document).find(".sidebar .bof_dropdown.file_list").remove();$(document).find(".sidebar .download_menu_wrapper").remove()}
window.ui.body.addClass("bof_offline_button_"+window.app.config.theme.setting.offline_download_button,!0);window.bof_offline_cli.exe();window.addEventListener('offline',function(event){window.bof_offline.mode.on()});window.addEventListener('online',function(event){window.bof_offline.mode.off()});window.bof_offline.count()},count:function(){window.bof_offline.db.count().done(function(count){if(count>0){window.ui.body.removeClass("bof_offline_count_zero",!0);window.ui.body.addClass("bof_offline_count_plus",!0)}else{window.ui.body.addClass("bof_offline_count_zero",!0);window.ui.body.removeClass("bof_offline_count_plus",!0)}})},download:function(object_type,object_hash,source_hash,type,inBG){if(!"serviceWorker" in navigator){window.app.becli.alert(!1,"Browser doesn't support service workers");return}
var promise=$.Deferred();var dl_code=source_hash+"-"+object_type+"-"+object_hash;if(inBG!==!0)
window.bof_modal.set_loading("initial");window.becli.exe({liquid:!0,endpoint:"muse_request_download",post:{object_type:object_type,object_hash:object_hash,source_hash:source_hash,type:type},callBack:function(sta,data){if(!sta){window.bof_modal.close();if(data.messages[0]=="locked")
window.app.actions.get_unlock_solution(object_type,object_hash,null,null,source_hash)
promise.reject();return}
if(!data.source_data.ID){data.source_data.ID=source_hash
if(!data.source_data.muse.data.ID){data.source_data.muse.data.ID=source_hash}}
if(type=="out"){window.open(data.source_file_list[0],'_blank')}else{window.bof_offline.ui.start_download(dl_code,data.source_data,data.source_file_list).done(function(){promise.resolve()}).fail(function(){promise.reject()})}
if(inBG!==!0)
window.bof_modal.close();}});return promise},downloadGroup:function(items,Ini){if(!items?!0:!items.length)
return;if(!"serviceWorker" in navigator){window.app.becli.alert(!1,"Browser doesn't support service workers");return}
var item=items.shift();window.bof_offline.download(item.real_ot,item.real_oh,item.hash,"in",Ini!==!0).then(function(){if(items?items.length:!1)
window.bof_offline.downloadGroup(items,!1);})},ui:{start_download:function(dl_code,data,file_list){var promise=$.Deferred();var calSize=$.Deferred();if(data.size)
calSize.resolve(data.size);else{fetch(data.web_address,{mode:"no-cors",method:"HEAD"}).then(response=>{if(response.headers.get("content-length"))
calSize.resolve(parseInt(response.headers.get("content-length")));else calSize.resolve(null)})}
calSize.done(function(fileSize){window.bof_offline.db.insert(dl_code,data,file_list).done(function(){window.bof_offline.db.count().done(function(count){$(document).find("body .download_menu_wrapper .icon").addClass("pulse");setTimeout(function(){$(document).find("body .download_menu_wrapper .icon").removeClass("pulse")},8000);if(!$(document).find(".bof_dropdown#download_drop").hasClass("active")){$(document).find("body .download_menu_wrapper").click()}else{window.bof_offline.ui.list()}
window.bof_offline_cli.exe();promise.resolve()})}).fail(function(){window.app.becli.alert(!1,"Can't be downloaded");promise.reject()})}).fail(function(){window.app.becli.alert(!1,"Can't be downloaded");promise.reject()});return promise},list:function($args){$args=$args?$args:{};var promise=$.Deferred();window.bof_offline.db.list().then(function(list){list=list?Object.values(list):list;if(!list?!0:!list.length){promise.resolve("<div class='empty'>\
            <span class='mdi mdi-airplane-landing'></span>\
            <div class='e_title'>"+window.lang.return("download_e_title",{ucfirst:!0})+"</div>\
            <div class='e_desc'>"+window.lang.return("download_e_desc",{ucfirst:!0})+"</div>\
          </div>");return}
var list_htmls=[];for(var i=list.length-1;i>=0;i--){var item=list[i];if(!item.data)continue;var item_html="<div data-key='"+item.key+"' class='file sta_"+item.state+" cover_"+(item.data.cover?"yes":"no")+" sub_title_"+(item.data.sub_title?"yes":"no")+" key_"+item.key+" '>";item_html+="<div class='state'>\
              <div class='pending'><span class='mdi mdi-reload'></span><span class='text'>Pending</span></div>\
              <div class='paused'><span class='mdi mdi-pause-circle-outline'></span><span class='text'>Paused</span></div>\
              <div class='downloading'><span class='mdi mdi-tray-arrow-down'></span><span class='text'>Downloading</span></div>\
              <div class='done'><span class='mdi mdi-check-circle-outline'></span><span class='text'>Done</span></div>\
              <div class='failed'><span class='mdi mdi-alert-circle-outline'></span><span class='text'>Failed</span></div>\
            </div>";if(item.data.cover)
item_html+="<div class='cover_w'><div class='cover' style='background-image:url(\""+item.data.cover+"\")'></div></div>";item_html+="<div class='titles'><div class='main'>"+item.data.title+"</div><div class='second'>"+item.data.sub_title+"</div></div>";item_html+="<div class='size'>"+window._g.humanFileSize(item.data.size)+"</div>";item_html+="<div class='progress_wrapper'>\
              <div class='progress_e' style='width:"+(item.data.percentage_dled?item.data.percentage_dled:0)+"%'></div>\
              <div class='progress_t'>"+(item.data.percentage_dled?item.data.percentage_dled:0)+"%</div>\
            </div>";item_html+="<div class='buttons'>\
              <div class='start'><span class='mdi mdi-download'></span><span class='text'>Start</span></div>\
              <div class='pause'><span class='mdi mdi-pause'></span><span class='text'>Pause</span></div>\
              <div class='cancel'><span class='mdi mdi-close'></span><span class='text'>Cancel</span></div>\
              <div class='delete'><span class='mdi mdi-delete'></span><span class='text'>Delete</span></div>\
            </div>";item_html+="</div>";list_htmls.push(item_html)}
promise.resolve(list_htmls.join(""))});promise.done(function(html){var target=!1;if($args.target===undefined){if($("body").hasClass("offline_mode")){target=".bof_offline_page .file_list"}else{target="#download_drop .list"}}else{target=$args.target}
if(target)
$(document).find(target).html(html);});return promise},},db:{order:{get:function(){var dl_db=window.bof_offline.db._get();var promise=$.Deferred();dl_db.getItem("_bof_dl_list").then(item=>{promise.resolve(item)});return promise},set:function(newOrder){var dl_db=window.bof_offline.db._get();var promise=$.Deferred();dl_db.setItem("_bof_dl_list",newOrder).then(item=>{promise.resolve(item)});return promise}},_get:function(){return localforage.createInstance({name:"downloads"})},insert:function(dl_code,data,file_list){var dl_db=window.bof_offline.db._get();var promise=$.Deferred();var orderPromise=$.Deferred();window.bof_offline.db.order.get().done(function(order_list){order_list=order_list?order_list:[];order_list.push(dl_code);window.bof_offline.db.order.set(order_list).done(function(){dl_db.getItem(dl_code).then(function(Item){Item=Item?Item:{};Item.data=data;Item.files=file_list;dl_db.setItem(dl_code,Item).then(function(){promise.resolve();window.bof_offline.count()})})})});return promise},get:function(dl_code){var dl_db=window.bof_offline.db._get();var promise=$.Deferred();dl_db.getItem(dl_code).then(item=>{if(!item.state)
item.state="pending";if(item.state=="downloading"){if(window.bof_offline_cli.running_cache.item?window.bof_offline_cli.running_cache.item.key!=dl_code:!0)
item.state="pending"}
item.key=dl_code;item.files_pure=[];item.untouched_links=[];if(item.files){for(var i=0;i<item.files.length;i++){var item_full_address=item.files[i];var __u=new URL(item_full_address);var item_pure_address=__u.origin+__u.pathname;item.files_pure.push(item_pure_address);if(item.cached?!item.cached.includes(item_pure_address)&&!item.cached.includes(decodeURI(item_pure_address)):!0){__u.searchParams.delete("bof_offline");__u.searchParams.delete("bof_offline_download");__u.searchParams.delete("bof_offline_hls");var _dq=__u.searchParams.toString();item.untouched_links.push(item_pure_address+(item_pure_address.includes("?")?"&":"?")+"bof_offline="+dl_code+"&bof_offline_download=yes"+(item_pure_address.includes(".key")||item_pure_address.includes(".m3u8")||item_pure_address.includes("/slice_")?"&bof_offline_hls=yes":"")+(_dq?"&"+_dq:""))}}}
promise.resolve({key:dl_code,item:item})});return promise},update:function(dl_code,newItem){var dl_db=window.bof_offline.db._get();return dl_db.setItem(dl_code,newItem)},list:function(){var dl_db=window.bof_offline.db._get();var promise=$.Deferred();var list={};var list_promises=[];window.bof_offline.db.order.get().done(function(order_list){dl_db.keys().then(function(keys){var keys_ordered=[];if(order_list){for(var z=0;z<order_list.length;z++){if(keys.includes(order_list[z])){list_promises.push(window.bof_offline.db.get(order_list[z]));keys_ordered.push(order_list[z])}}}
var unorder_list=$.grep(keys,function(value){return $.inArray(value,keys_ordered.concat(["_bof_dl_list"]))===-1});if(unorder_list?unorder_list.length:!1){for(var z=0;z<unorder_list.length;z++){list_promises.unshift(window.bof_offline.db.get(unorder_list[z]))}}
if(list_promises){$.when.apply($,list_promises).done(function(){var _r=Array.prototype.slice.call(arguments,0);var _l={};if(_r){for(var i=0;i<_r.length;i++){var _i=_r[i];_l[_i.key]=_i.item}}
promise.resolve(_l)})}})});return promise},count:function(){var dl_db=window.bof_offline.db._get();var promise=$.Deferred();var _c=0;dl_db.keys().then(keys=>{if(!keys)
promise.resolve(0);else{for(var z=0;z<keys.length;z++){if(keys[z]!="_bof_dl_list")
_c=_c+1}}
promise.resolve(_c)});return promise},get_objects:function(type,hash){var dl_db=window.bof_offline.db._get();var promise=$.Deferred();var code=type+"-"+hash;dl_db.keys().then(keys=>{var keys_check_promises=[];for(var i=0;i<keys.length;i++){var key=keys[i];if(key.endsWith(code)){var keys_check_promise=$.Deferred();keys_check_promises.push(keys_check_promise)
window.bof_offline.db.get(key).then(item_w=>{var item=item_w.item;if(item.state=="done"&&promise.state()=="pending"){promise.resolve(item)}
keys_check_promise.resolve()})}}
if(keys_check_promises.length){$.when.apply($,keys_check_promises).done(function(){if(promise.state()=="pending")
promise.reject("no_done_key");})}else{promise.reject("no_related_key")}});return promise},get_first_pending:function(){var promise=$.Deferred();window.bof_offline.db.list().done(list=>{if(!list){promise.reject();return}
for(var i=0;i<Object.values(list).length;i++){var item=Object.values(list)[i];if(item.state=="pending"){promise.resolve(item);return}}
promise.reject()});return promise},delete:function(dl_code){var dl_db=window.bof_offline.db._get();dl_db.removeItem(dl_code).then(function(){window.bof_offline.count()});var new_order_list=[];window.bof_offline.db.order.get().done(function(order_list){if(order_list){for(var z=0;z<order_list.length;z++){var _key=order_list[z];if(_key!=dl_code)
new_order_list.push(order_list[z]);}}
window.bof_offline.db.order.set(new_order_list);if(!new_order_list.length)
window.bof_dropdown.close();})}},mode:{on:function(){if(window.m2_queue.ui.isOpen()){window.m2_queue.ui.destroy()}
window.ui.body.addClass("offline_mode",!0);window.ui.body.removeClass("noParts",!0);window.bof_offline.ui.list({target:!1}).done(html=>{$("body").append("<div class='bof_offline_page'>\
          <div class='off_title'>"+window.lang.return("downloads",{ucfirst:!0})+"</div>\
          <div class='file_list'>"+html+"</div>\
          <div class='off_pop'>\
            <span class='mdi mdi-wifi-off'></span>\
            <div class='off_pop_title'>"+window.lang.return("your_offline",{ucfirst:!0})+"</div>\
            <div class='off_pop_desc'>"+window.lang.return("your_offline_desc",{ucfirst:!0})+"</div>\
            <div class='off_pop_btn btn bn' onClick='$(document).find(\".bof_offline_page\").toggleClass(\"inied\")'>"+window.lang.return("your_offline_btn",{ucfirst:!0})+"</div>\
          </div>\
        </div>")})},off:function(){window.app.becli.alert(!0,window.lang.return("your_online",{ucfirst:!0}));window.ui.body.removeClass("offline_mode",!0);$(document).find(".bof_offline_page").remove();if($("body").hasClass("offline_start")){window.ui.body.removeClass("offline_start",!0);window.ui.link.navigate("/")}}},}
window.bof_offline_cli={running:!1,running_cache:{},_markStart:function(){window.bof_offline_cli.running=!0;window.bof_offline_cli.running_cache={item:{}};window.ui.body.addClass("bof_offline_downloading",!0)},_markStop:function(){window.bof_offline_cli.running=!1;window.ui.body.removeClass("bof_offline_downloading",!0)},_getWorker:function(){var promise=$.Deferred();window.bof._loadExtension({name:"bof_offline_sw",path:"app/bof_offline_sw.js",}).done(()=>{promise.resolve(window.bof_offline_sw)});return promise},exe:function(){if(window.bof_offline_cli.running)return;window.bof_offline_cli._markStart();window.bof_offline.db.get_first_pending().done(item=>{window.bof_offline_cli.running_cache.item=item;window.bof_offline_cli._getWorker().done(core=>{core.set(item);core.start()})}).fail(()=>{window.bof_offline_cli._markStop()})},delete:function(item){window.bof_offline_cli._getWorker().done(core=>{core.delete(item)});window.bof_offline.db.delete(item.key)},pause:function(){window.bof_offline_cli._getWorker().done(core=>{core.pause()})},getRunning:function(){var promise=$.Deferred();window.bof_offline.db.get(window.bof_offline_cli.running_cache.item.key).then(item_w=>{promise.resolve(item_w.item)});return promise},updateRunning:{getItem:function(){var dl_db=window.bof_offline.db._get();return dl_db.getItem(window.bof_offline_cli.running_cache.item.key)},item:function(data){return window.bof_offline.db.update(window.bof_offline_cli.running_cache.item.key,data)},dled:function(dl_size){dl_size=parseInt(dl_size);window.bof_offline_cli.updateRunning.getItem().then(item=>{item.data.size_dled=item.data.size_dled?parseInt(item.data.size_dled):0;item.data.size_dled=item.data.size_dled+dl_size
var donePercentage=item.data.size_dled&&item.data.size?(Math.round(item.data.size_dled/item.data.size*100)):0;donePercentage=donePercentage>100?100:donePercentage;$(document).find(".file.key_"+window.bof_offline_cli.running_cache.item.key).find(".progress_t").text(donePercentage+"%");$(document).find(".file.key_"+window.bof_offline_cli.running_cache.item.key).find(".progress_e").css("width",donePercentage+"%");item.data.percentage_dled=donePercentage;window.bof_offline_cli.updateRunning.item(item)})},state:function(state){if(window.bof_offline_cli.running_cache.item)
$(document).find(".file.key_"+window.bof_offline_cli.running_cache.item.key).removeClass("sta_done sta_failed sta_pending sta_downloading sta_paused").addClass("sta_"+state);window.bof_offline_cli.updateRunning.getItem().then(item=>{item.state=state;window.bof_offline_cli.updateRunning.item(item).then(()=>{if(state=="done"){window.bof_offline_cli._markStop();window.bof_offline_cli.exe()}})})},},}
window.bof_offline_sw={cache:{},set:function(item){window.bof_offline_sw.cache.item=item;window.bof_offline_sw.cache.promise=$.Deferred();window.bof_offline_sw.cache.sta="paused";window.bof_offline_sw.cache.controller=null;window.bof_offline_sw.cache.dl_tries={}},start:function(){window.bof_offline_sw.cache.sta="downloading";window.bof_offline_sw.download(!0)},download:function($start){if(window.bof_offline_sw.cache.sta!="downloading")
return;window.bof_offline_cli.getRunning().then(item=>{if(item.untouched_links?item.untouched_links.length&&item.untouched_links[0]:!1){if($start)
window.bof_offline_cli.updateRunning.state("downloading");window.bof_offline_sw.download_a_part(item.untouched_links[0])}else{window.bof_offline_cli.updateRunning.state("done")}})},download_a_part:function($link){if(Object.keys(window.bof_offline_sw.cache.dl_tries).includes($link)){window.bof_offline_sw.cache.dl_tries[$link]=window.bof_offline_sw.cache.dl_tries[$link]+1;if(window.bof_offline_sw.cache.dl_tries[$link]>5){window.bof_offline_cli.updateRunning.state("paused");return}}else{window.bof_offline_sw.cache.dl_tries[$link]=1}
window.bof_offline_sw.cache.controller=new AbortController();fetch($link,{signal:window.bof_offline_sw.cache.controller.signal,mode:"no-cors"}).then(response=>{window.bof_offline_cli.updateRunning.dled(response.headers.get("content-length"));window.bof_offline_sw.download()})},delete:function($item){window.bof.log("bof_offline_sw: delete");navigator.serviceWorker.controller.postMessage({action:"clean",url:$item.files_pure})},deleteBofClient:function(){window.bof.log("bof_offline_sw: deleteBofClient");if('serviceWorker' in navigator){navigator.serviceWorker.controller.postMessage({action:"cleanBofClient",})}},deleteAll:function(){window.bof.log("bof_offline_sw: deleteAll");if('serviceWorker' in navigator){navigator.serviceWorker.controller.postMessage({action:"cleanAll",})}},pause:function(){window.bof.log("bof_offline_sw: pause");window.bof_offline_cli.updateRunning.state("paused");window.bof_offline_sw.cache.sta="paused";window.bof_offline_sw.cache.controller.abort()},}
window.pageBuilder={widget:{item:{dynaButtonXHR:null,getExtenders:{},open:!1,pos:{x:null,y:null,},get:function($id){var Extenders=window.pageBuilder.widget.item.getExtenders;if(Object.keys(Extenders).length){for(var i=0;i<Object.keys(Extenders).length;i++){var Extender=Object.values(Extenders)[i];if(typeof Extender==="function"){var runExtender=Extender($id);if(runExtender)
return runExtender}}}
if($id=="main"){var mainData=window.ui.page.curr().data.becli.single.data;mainData.widget="page";return mainData}
if($id=="muse_active")
return window.m2_queue.active.get().data;if($id.substr(0,6)=="queue_"){var _q=window.m2_queue.getItem($id.substr(6));return _q?.data}
var widgets=window.ui.page.curr().data.becli.single.widgets;return window.pageBuilder.widget.item.getHelper($id,widgets)},getHelper:function($id,widgets){for(var i=0;i<widgets.length;i++){var items={};var _w=widgets[i];if(_w.items){for(var z=0;z<Object.keys(_w.items).length;z++){var _ik=Object.keys(_w.items)[z];var _i=_w.items[_ik];if(Array.isArray(_i)){for(var y=0;y<Object.keys(_i).length;y++){var __ik=Object.keys(_i)[y];var __i=_i[__ik];items[__i.id]=__i}}else{items[_i.id]=_i}}
if(_w.display&&items?_w.display.type=="table":!1){for(var z=0;z<Object.keys(items).length;z++){var __item_k=Object.keys(items)[z];var __item=items[__item_k];if(__item.tds){var __itemTDs=__item.tds;for(var y=0;y<__itemTDs.length;y++){var __itemTD=__itemTDs[y];if(__itemTD.class&&__itemTD.val){if(__itemTD.class.includes("title"))
items[__item_k].title=window._g.decode_htmlspecialchars(__itemTD.val);if(__itemTD.class.includes("cover"))
items[__item_k].cover=__itemTD.val}}}}}
if(_w.display?_w.display.type=="grid":!1){var chck_gWidgets=window.pageBuilder.widget.item.getHelper($id,_w.display.widgets);if(chck_gWidgets)return chck_gWidgets}
if(items[$id]){var foundItem=items[$id];if(!foundItem.buttons)
foundItem.buttons=window.pageBuilder.widget.item.parseWidgetButtons(foundItem,_w.buttons);foundItem.widget=_w;return foundItem}}}
return!1},setButtons:function($id,$buttons){if($id=="main"){window.ui.page.curr().data.becli.single.data.buttons.items=$buttons
return}
if($id=="muse_active"){return}
if($id?$id.substr(0,6)=="queue_":!1){return}
var widgets=window.ui.page.curr().data.becli.single.widgets;for(var i=0;i<widgets.length;i++){var items={};var _w=widgets[i];if(_w.items){for(var z=0;z<Object.keys(_w.items).length;z++){var _ik=Object.keys(_w.items)[z];var _i=_w.items[_ik];if(Array.isArray(_i)){for(var y=0;y<Object.keys(_i).length;y++){var __ik=Object.keys(_i)[y];var __i=_i[__ik];items[__i.id]=__i}}else{items[_i.id]=_i}}
if(_w.display&&items?_w.display.type=="table":!1){for(var z=0;z<Object.keys(items).length;z++){var __item_k=Object.keys(items)[z];var __item=items[__item_k];if(__item.tds){var __itemTDs=__item.tds;for(var y=0;y<__itemTDs.length;y++){var __itemTD=__itemTDs[y];if(__itemTD.class&&__itemTD.val){if(__itemTD.class.includes("title"))
items[__item_k].title=window._g.decode_htmlspecialchars(__itemTD.val);if(__itemTD.class.includes("cover"))
items[__item_k].cover=__itemTD.val}}}}}
if(items[$id]){items[$id].buttons.items=$buttons;return}}}
return null},renderMenu:function(buttons,x,y,loading){$(document).find(".widgetItemButtons_hover").remove();var promise=$.Deferred();window.ui.theme.load("theme/parts/widget_item_buttons",{dir:!1,base:$_bof_config.assets_address}).done(function(buttons_template){window.render.mix(buttons_template,{class:loading?"loading":"",buttons:buttons,x:x,y:y}).done(function(buttons_html){promise.resolve(buttons_html)})});return promise},parseWidgetButtons:function($item,$widgetButtons){var buttons={};for(var i=0;i<Object.keys($widgetButtons).length;i++){var _k=Object.keys($widgetButtons)[i];var _t=$widgetButtons[_k];if(_t=="organic"){if(_k=="play"&&$item.ot&&$item.hash){buttons.play={icon:"play",title:window.lang.return("play",{ucfirst:!0}),action:"play",class:"_play bof_"+$item.ot+"_"+$item.hash,attr:"data-play='"+$item.hash+"'"};buttons.play_next={icon:"playlist-music",title:window.lang.return("play_next",{ucfirst:!0}),action:"play_next",attr:"data-play='"+$item.hash+"'"};buttons.play_last={icon:"playlist-music-outline",title:window.lang.return("add_to_queue",{ucfirst:!0}),action:"play_last",attr:"data-play='"+$item.hash+"'"}}
if(_k=="like"&&$item.ot&&$item.hash){buttons.like={icon:"heart",dynamic:!0,title:"<i>"+window.lang.return("loading",{ucfirst:!0})+"</i>",attr:"id='dyna_like'"}}
if(_k=="subscribe"&&$item.ot&&$item.hash){buttons.subscribe={icon:"heart",dynamic:!0,title:"<i>"+window.lang.return("loading",{ucfirst:!0})+"</i>",attr:"id='dyna_subscribe'"}}
if(_k=="playlist"&&$item.ot&&$item.hash){buttons.playlist={icon:"playlist-plus",title:window.lang.return("add_to_playlist",{ucfirst:!0}),action:"playlist",class:"with_child",}}
if(_k=="share"&&$widgetButtons.link=="organic"&&$item.ot&&$item.hash){buttons.share={icon:"share",title:window.lang.return("share",{ucfirst:!0}),action:"share",}}
if(_k=="link"&&$item.url){buttons.link={icon:"open-in-app",title:window.lang.return("open",{ucfirst:!0}),action:$item.url,}}}else if(_t=="dynamic"){buttons[_k]={dynamic:!0,icon:"loading",title:"<i>"+window.lang.return("loading",{ucfirst:!0})+"</i>",attr:"id='dyna_"+_k+"'"}}}
return{data:{_title:$item.title?$item.title:$item.name,_cover:$item.cover},items:buttons}},openMenu:function($id,x,y){var Data=window.pageBuilder.widget.item.get($id);var buttons=Data.buttons.items;var position=window.pageBuilder.widget.item.positionMenu(buttons,x,y,!0);var target_top=position.top;var target_left=position.left;window.pageBuilder.widget.item.closeMenu();window.ui.body.addClass("fullMenuOpened");var $hasDynamicButton=!1;for(var i=0;i<Object.keys(buttons).length;i++){var _key=Object.keys(buttons)[i];var _but=buttons[_key];if(_but.dynamic)$hasDynamicButton=!0}
if($hasDynamicButton){window.becli.exe({endpoint:"bofClient/buttons/"+Data.ot+"/",post:{hash:Data.hash,buttons:Object.keys(buttons).join(",")},callBack:function(sta,data,args){if(sta?data.buttons.items:!1){if($id.substr(0,"queue_".length)=="queue_"){data.buttons.items=$.extend({play:{icon:"play",title:window.lang.return("play",{ucfirst:!0}),action:"que_play",class:"bof_"+Data.ot+"_"+Data.hash+" play _play",attr:" data-que='"+$id.substr("queue_".length)+"' "},remove_from_que:{icon:"delete",title:window.lang.return("remove_from_que",{ucfirst:!0}),action:"que_remove",attr:" data-que='"+$id.substr("queue_".length)+"' "}},data.buttons.items)}
window.pageBuilder.widget.item.replaceMenu(data.buttons.items,!1,data)}else{for(var i=0;i<Object.keys(buttons).length;i++){var _key=Object.keys(buttons)[i];var _but=buttons[_key];if(_but.dynamic){$(document).find(".widgetItemButtons .button#dyna_"+_key).remove()}}}}})}
if($id.substr(0,"queue_".length)=="queue_"){Data.buttons.items=$.extend({play:{icon:"play",title:window.lang.return("play",{ucfirst:!0}),action:"que_play",class:"bof_"+Data.ot+"_"+Data.hash+" play _play"}},Data.buttons.items)}
window.pageBuilder.widget.item.renderMenu(Data.buttons,target_left,target_top,$hasDynamicButton).done(function(buttons_html){$("body").append(buttons_html);window.m2_focus.ui.hook()
window.pageBuilder.widget.item.open=$.extend(Data.buttons.data,{id:$id});window.pageBuilder.widget.item.pos={x:x,y:y}
$(document).on("click",window.pageBuilder.widget.item.menuCloserListener);$("#main").on("scroll",window.pageBuilder.widget.item.closeMenu);$(document).on("click",".widgetItemButtons .button",function(e){var action=$(this).attr("data-action");if(action=="playlist"){var newButtons=[];newButtons.push({icon:"keyboard-backspace",title:window.lang.return("back",{ucfirst:!0}),action:"menu",attr:" data-x='"+window.pageBuilder.widget.item.pos.x+"' data-y='"+window.pageBuilder.widget.item.pos.y+"' "});newButtons.push({title:null,class:"seperate"});newButtons.push({title:window.lang.return("select",{ucfirst:!0}),class:"_title"});if(window.app.config.user?window.app.config.user.data.playlists:!1){for(var i=0;i<Object.keys(window.app.config.user.data.playlists).length;i++){var playlist=window.app.config.user.data.playlists[i];newButtons.push({icon:"playlist-music",title:playlist.name,action:"playlist_select",attr:"data-playlist='"+playlist.hash+"'"})}}else{newButtons.push({icon:"emoticon-sad-outline",title:window.lang.return("nothing_found",{ucfirst:!0}),class:"nada"})}
newButtons.push({title:null,class:"seperate"});newButtons.push({icon:"plus-circle-outline",title:window.lang.return("create_new",{ucfirst:!0}),action:"playlist_create_ini",});window.pageBuilder.widget.item.replaceMenu(newButtons)}else if(action=="playlist_create_ini"){var newButtons=[];newButtons.push({icon:"keyboard-backspace",title:window.lang.return("back",{ucfirst:!0}),action:"playlist",});newButtons.push({title:null,class:"seperate"});newButtons.push({html:"<input type='text' class='bof_input' placeholder='"+window.lang.return("enter_a_name",{ucfirst:!0})+"' id='new_playlist_name'><div class='button btn btn-primary' id='new_playlist_button' data-action='playlist_create'>"+window.lang.return("create",{ucfirst:!0})+"</div>",class:"html"});window.pageBuilder.widget.item.replaceMenu(newButtons)}else if(action=="playlist_select"){window.app.becli.exe("alert",{},{endpoint:"playlist_extend",post:{playlist:$(this).data("playlist"),object_type:Data.ot,object:Data.hash},c_callback:function(sta,data){window.pageBuilder.widget.item.closeMenu();navigator.serviceWorker.controller.postMessage({action:"clean",url:window.config.endpoint_address+"bofClient/single/ugc_playlist/?bof_cache=120&slug="+data.playlist.url})}})}else if(action=="playlist_create"){window.app.becli.exe("alert",{},{endpoint:"playlist_create",post:{playlist:$(document).find("#new_playlist_name").val(),object_type:Data.ot,object:Data.hash},c_callback:function(sta,data,args){if(sta){window.app.getConfig(!0);window.pageBuilder.widget.item.closeMenu()}}})}else if(action=="playlist_edit"){window.app.actions.user.playlist.edit_start(Data.hash,Data);window.pageBuilder.widget.item.closeMenu()}else if(action=="playlist_delete_confirm"){window.app.actions.user.playlist.delete_confirm(Data.hash,Data);window.pageBuilder.widget.item.closeMenu()}else if(action=="playlist_keep"){window.app.actions.user.playlist.keep(Data.hash,Data);window.pageBuilder.widget.item.closeMenu()}else if(action=="playlist_lose"){window.app.actions.user.playlist.lose(Data.hash,Data);window.pageBuilder.widget.item.closeMenu()}else if(action=="playlist_shorten"){window.app.actions.user.playlist.shorten($(this).attr("data-play"),$(this).attr("data-item_ot"),$(this).attr("data-item"),Data.i);window.pageBuilder.widget.item.closeMenu()}else if(action=="item_single_edit"){window.app.actions.user.item_single_edit.edit_start(Data.ot,Data.hash,Data);window.pageBuilder.widget.item.closeMenu()}else if(action=="item_single_edit_delete"){window.app.actions.user.item_single_edit.delete_confirm(Data.ot,Data.hash,Data);window.pageBuilder.widget.item.closeMenu()}else if(action=="share"){window.app.actions.share.ini(Data)}else if(action=="play"){if(Data.ot&&Data.hash){window.m2.user.request("focus",Data.ot,Data.hash,Data.sources,Data)}}else if(action=="que_play"){var queID=$(this).data("que");if(queID!==window.muse.queue.active._id){}}else if(action=="que_remove"){var queID=$(this).data("que");window.m2_queue.removeItem(queID)}else if(action=="play_next"){if(Data.ot&&Data.hash){window.m2.user.request("next",Data.ot,Data.hash,Data.sources,Data)}}else if(action=="play_last"){if(Data.ot&&Data.hash){window.m2.user.request("last",Data.ot,Data.hash,Data.sources,Data)}}else if(action=="download"){var requed_type=$(this).attr("data-download-action");var download_sources=Data.buttons.items.download.sources;if(!download_sources?!0:!download_sources.in&&!download_sources.out)
return!1;var newButtons=[];download_sources.in=download_sources.in?Object.values(download_sources.in):download_sources.in;download_sources.out=download_sources.out?Object.values(download_sources.out):download_sources.out;if(download_sources.in&&download_sources.out&&!requed_type){newButtons.push({icon:"keyboard-backspace",title:window.lang.return("back",{ucfirst:!0}),action:"menu",attr:" data-x='"+window.pageBuilder.widget.item.pos.x+"' data-y='"+window.pageBuilder.widget.item.pos.y+"' "});newButtons.push({title:null,class:"seperate"});newButtons.push({icon:"playlist-music",title:"To Device",action:"download",attr:"data-download-action='out'"});newButtons.push({icon:"playlist-music",title:"To App",action:"download",attr:"data-download-action='in'"})}else if(download_sources.in&&requed_type!="out"){newButtons.push({icon:"keyboard-backspace",title:window.lang.return("back",{ucfirst:!0}),action:download_sources.in&&download_sources.out?"download":"menu",attr:" data-x='"+window.pageBuilder.widget.item.pos.x+"' data-y='"+window.pageBuilder.widget.item.pos.y+"' "});newButtons.push({title:null,class:"seperate"});newButtons.push({title:"Download to app",class:"_title"});if(download_sources.in.length==1){window.bof_offline.download(Data.ot,Data.hash,download_sources.in[0].hash,"in");window.pageBuilder.widget.item.closeMenu()}else{for(var i=0;i<download_sources.in.length;i++){var dl_src=download_sources.in[i];newButtons.push({icon:"playlist-music",title:dl_src.title,action:"download_in",attr:"data-hash='"+dl_src.hash+"'"})}}}else if(download_sources.out&&requed_type!="in"){newButtons.push({icon:"keyboard-backspace",title:window.lang.return("back",{ucfirst:!0}),action:download_sources.in&&download_sources.out?"download":"menu",attr:" data-x='"+window.pageBuilder.widget.item.pos.x+"' data-y='"+window.pageBuilder.widget.item.pos.y+"' "});newButtons.push({title:null,class:"seperate"});newButtons.push({title:"Download to device",class:"_title"});for(var i=0;i<download_sources.out.length;i++){var dl_src=download_sources.out[i];newButtons.push({icon:"playlist-music",title:dl_src.title,action:"download_out",attr:"data-hash='"+dl_src.hash+"'"})}}
window.pageBuilder.widget.item.replaceMenu(newButtons)}else if(action=="download_child"){var requed_type=$(this).attr("data-download-action");var download_sources=Data.buttons.items.download_child.sources;if(!download_sources?!0:!download_sources.in&&!download_sources.out)
return!1;var newButtons=[];download_sources.in=download_sources.in?Object.values(download_sources.in):download_sources.in;download_sources.out=download_sources.out?Object.values(download_sources.out):download_sources.out;if(download_sources.in&&download_sources.out&&!requed_type){newButtons.push({icon:"keyboard-backspace",title:window.lang.return("back",{ucfirst:!0}),action:"menu",attr:" data-x='"+window.pageBuilder.widget.item.pos.x+"' data-y='"+window.pageBuilder.widget.item.pos.y+"' "});newButtons.push({title:null,class:"seperate"});newButtons.push({icon:"playlist-music",title:"To Device",action:"download_child",attr:"data-download-action='out'"});newButtons.push({icon:"playlist-music",title:"To App",action:"download_child",attr:"data-download-action='in'"})}else if(download_sources.in&&requed_type!="out"){window.bof_offline.downloadGroup(download_sources.in,!0);window.pageBuilder.widget.item.closeMenu()}else if(download_sources.out&&requed_type!="in"){for(var i=0;i<download_sources.out.length;i++){var dl_src=download_sources.out[i];window.bof_offline.download(dl_src.real_ot,dl_src.real_oh,dl_src.hash,"out",i>0)}
window.pageBuilder.widget.item.closeMenu()}
window.pageBuilder.widget.item.replaceMenu(newButtons)}else if(action=="download_in"){window.bof_offline.download(Data.ot,Data.hash,$(this).data("hash"),"in");window.pageBuilder.widget.item.closeMenu()}else if(action=="download_out"){window.bof_offline.download(Data.ot,Data.hash,$(this).data("hash"),"out");window.pageBuilder.widget.item.closeMenu()}else if(action=="purchase"){window.app.actions.get_unlock_solution(Data.ot,Data.hash);window.pageBuilder.widget.item.closeMenu()}else if(action=="view_bio"){window.app.actions.view_bio(Data.ot,Data.hash);window.pageBuilder.widget.item.closeMenu()}else if(action=="menu"){window.pageBuilder.widget.item.openMenu($id,$(this).data("x")?$(this).data("x"):x,$(this).data("y")?$(this).data("y"):y)}else if(action=="like"){window.app.actions.user.like(!0,Data.ot,Data.hash);window.pageBuilder.widget.item.closeMenu()}else if(action=="unlike"){window.app.actions.user.like(!1,Data.ot,Data.hash);window.pageBuilder.widget.item.closeMenu()}else if(action=="subscribe"){window.app.actions.user.subscribe(!0,Data.ot,Data.hash);window.pageBuilder.widget.item.closeMenu()}else if(action=="unsubscribe"){window.app.actions.user.subscribe(!1,Data.ot,Data.hash);window.pageBuilder.widget.item.closeMenu()}else if($(this).find(".children").length){var children=$(this).find(".children .child");var newButtons=[];newButtons.push({icon:"keyboard-backspace",title:window.lang.return("back",{ucfirst:!0}),action:"menu",attr:" data-x='"+window.pageBuilder.widget.item.pos.x+"' data-y='"+window.pageBuilder.widget.item.pos.y+"' "});newButtons.push({title:null,class:"seperate"});if($(this).data("menu-name")){children=Data.buttons.items[$(this).data("menu-name")].childs;for(var x=0;x<children.length;x++){var child=children[x];newButtons.push({icon:child.icon,title:child.title,action:child.action,attr:child.attr,url:child.url,})}}else{for(var x=0;x<children.length;x++){var child=children[x];var childDatas=$(child).data();var childDatasString="";for(var i=0;i<Object.keys(childDatas).length;i++){var childDataKey=Object.keys(childDatas)[i];var childDataVal=childDatas[childDataKey];if(childDataKey!="action")
childDatasString+=" data-"+childDataKey+"=\""+childDataVal+"\" "}
newButtons.push({icon:"open-in-app",title:$(child).text().trim(),action:$(child).data("action"),attr:childDatasString?childDatasString:!1,url:$(child).attr("href"),})}}
window.pageBuilder.widget.item.replaceMenu(newButtons)}
window.m2_focus.ui.hook()});window.pageBuilder.widget.item.menuMCRun()})},replaceMenu:function(newButtons,Data,menuData){Data=Data?Data:window.pageBuilder.widget.item.open;if(menuData)
window.pageBuilder.widget.item.setButtons(window.pageBuilder.widget.item.open.id,newButtons);window.pageBuilder.widget.item.renderMenu({items:newButtons,data:Data},window.pageBuilder.widget.item.pos.x,window.pageBuilder.widget.item.pos.y).done(function(newButtonsHTML){$(document).find(".widgetItemButtons").replaceWith(newButtonsHTML);window.pageBuilder.widget.item.positionMenu(newButtons,window.pageBuilder.widget.item.pos.x,window.pageBuilder.widget.item.pos.y)})},menuMC:null,menuMCRun:function(){if(window.app.config.mobile){var mc=new Hammer(document.querySelector(".widgetItemButtons .data"));window.pageBuilder.widget.item.menuMC=mc;mc.add(new Hammer.Pan({direction:Hammer.DIRECTION_ALL,threshold:0}));var WHeight=$(window).height();var SMaxHeight=300;var SFullHeight=$(document).find(".widgetItemButtons .buttons")[0].scrollHeight;var Top=$(document).find(".widgetItemButtons").offset().top;var Height=$(document).find(".widgetItemButtons").height();var SHeight=$(document).find(".widgetItemButtons .buttons").outerHeight()
var Bottom=WHeight-Height-Top;var LM=0;mc.on('pan',function(e){var C_Top=$(document).find(".widgetItemButtons").offset().top;var C_Height=$(document).find(".widgetItemButtons").height();var C_SHeight=$(document).find(".widgetItemButtons .buttons").outerHeight()
var C_Bottom=WHeight-C_Height-C_Top;if(e.isFinal){if(C_Bottom<-50){window.pageBuilder.widget.item.closeMenu()}else{$(document).find(".widgetItemButtons").css("bottom","0px")}
Top=$(document).find(".widgetItemButtons").offset().top;Height=$(document).find(".widgetItemButtons").height();SHeight=$(document).find(".widgetItemButtons .buttons").outerHeight()
Bottom=WHeight-Height-Top;LM=0;return}
var M=LM-e.deltaY;LM=e.deltaY;if(M<0){$(document).find(".widgetItemButtons").css("bottom",(C_Bottom+M)+"px")}else{if(C_Bottom<0){$(document).find(".widgetItemButtons").css("bottom",(C_Bottom+M)+"px")}else if(SFullHeight>C_SHeight-6&&e.direction==8){$(document).find(".widgetItemButtons .buttons").css("max-height",(C_SHeight+M)+"px")}}})}},positionMenu:function(buttons,x,y,returnOnly){var window_width=$(window).width();var window_height=$(window).height();var target_width=240;var target_height=returnOnly?(buttons?Object.keys(buttons).length*37:0):$(document).find(".widgetItemButtons").height();var target_top=0;var target_left=0;var base_top=y
var base_left=x;target_left=base_left;target_top=base_top;if(target_left+target_width>window_width-30)
target_left=window_width-(target_width+30);if(target_top+target_height>window_height-80)
target_top=base_top-target_height;if(target_top<30)
target_top=30;if(target_left<30)
target_left=30;if(returnOnly){return{top:target_top,left:target_left}}
$(document).find(".widgetItemButtons").css("top",target_top+"px");$(document).find(".widgetItemButtons").css("left",target_left+"px");window.pageBuilder.widget.item.menuMCRun()},closeMenu:function(){if(window.pageBuilder.widget.item.menuMC)
window.pageBuilder.widget.item.menuMC.destroy();$(document).find(".widgetItemButtons").remove();$(document).find(".widgetItemButtons_hover").remove();$(document).off("click",window.pageBuilder.widget.item.menuCloserListener);$("#main").off("scroll",window.pageBuilder.widget.item.closeMenu);$(document).off("click",".widgetItemButtons .button");window.ui.body.removeClass("fullMenuOpened");window.pageBuilder.widget.item.open=!1},menuCloserListener:function(e){if($(e.target).parents(".button_wrapper").length)
return;if($(e.target).parents(".widgetItemButtons").length)
return;window.pageBuilder.widget.item.closeMenu()},listen:function(){if(window.app.config.mobile){if(window.bof._isExtensionLoaded("hammer_min_js")){document.querySelectorAll(".item:not(.hammered)").forEach(function(item){item.classList.add('hammered');item.querySelectorAll("a").forEach(function(a){if(!$(a).parents(".button_wrapper").length&&!$(a).hasClass("button_wrapper")&&!$(a).hasClass("more_a")&&$(a).attr("target")!="_blank")
a.removeAttribute("href");});var manager=new Hammer(item);var Hold=new Hammer.Press({event:'hold',time:550});var DoubleTap=new Hammer.Tap({event:'doubletap',taps:2,threshold:20});var SingleTap=new Hammer.Tap({event:'tap'});manager.add([DoubleTap,SingleTap,Hold]);DoubleTap.recognizeWith(SingleTap);SingleTap.requireFailure(DoubleTap);manager.on('doubletap',window.pageBuilder.widget.item.react);manager.on('tap',window.pageBuilder.widget.item.react);manager.on('hold',window.pageBuilder.widget.item.react)})}}},react:function(e){window.app.ui.clickReact(e,$(e.target),"mobile",e.type)}}},}
window.localhost=!1;window.config={localhost:!1,production:$_bof_config.production,version:$_bof_config.version,endpoint_address:$_bof_config.endpoint_address,platform:"web",cache_prefix:"dm_",web:{_formatize_url:function(urlString){return urlString.substr(urlString.length-1)=="/"?urlString:urlString+"/"},address:$_bof_config.web_address,},javas:function(){var general=$.Deferred();var muse=$.Deferred();$.when(window.bof._loadExtension({name:"pageBuilder",path:"app/"+($_bof_config.production?"minified/":"")+"bof_pageBuilder.js",}),window.bof._loadExtension({name:"bof_modal",path:"app/"+($_bof_config.production?"minified/":"")+"bof_modal.js",}),window.bof._loadExtension({name:"bof_input",path:"app/"+($_bof_config.production?"minified/":"")+"bof_input.js",}),window.bof._loadExtension({name:"bof_dropdown",path:"app/"+($_bof_config.production?"minified/":"")+"bof_dropdown.js",}),window.bof._loadExtension({path:"https://cdnjs.cloudflare.com/ajax/libs/localforage/1.10.0/localforage.min.js",name:"localforage.min.js",dir:!1,skipNameCheck:!0,version:!1}),).done(function(){general.resolve()}).fail(function(){general.reject()})
if(window.app.config.no_muse?window.app.config.no_muse===!0:!1){muse.resolve()}else{var _promises=!1
if($_bof_config.production){_promises=$.when(window.bof._loadExtension({name:"m2",path:"js/bof/bof_mini_muse.js",dir:"js",base:"bof_assets"}),window.bof._loadExtension({name:"bof_offline",path:"app/"+($_bof_config.production?"minified/":"")+"bof_offline.js",}),window.bof._loadExtension({name:"bof_offline_cli",path:"app/"+($_bof_config.production?"minified/":"")+"bof_offline_cli.js",}),)}else{_promises=$.when(window.bof._loadExtension({name:"m2",path:"app/"+($_bof_config.production?"minified/":"")+"bof_muse2.js",}),window.bof._loadExtension({name:"m2c_audio",path:"app/"+($_bof_config.production?"minified/":"")+"bof_muse2_cli_audio.js",skipNameCheck:!0,}),window.bof._loadExtension({name:"m2c_video",path:"app/"+($_bof_config.production?"minified/":"")+"bof_muse2_cli_video.js",skipNameCheck:!0,}),window.bof._loadExtension({name:"m2c_youtube",path:"app/"+($_bof_config.production?"minified/":"")+"bof_muse2_cli_youtube.js",skipNameCheck:!0,}),window.bof._loadExtension({name:"m2c_soundcloud",path:"app/"+($_bof_config.production?"minified/":"")+"bof_muse2_cli_soundcloud.js",skipNameCheck:!0,}),window.bof._loadExtension({name:"m2_focus",path:"app/"+($_bof_config.production?"minified/":"")+"bof_muse2_focus.js",}),window.bof._loadExtension({name:"m2_infinite",path:"app/"+($_bof_config.production?"minified/":"")+"bof_muse2_infinite.js",}),window.bof._loadExtension({name:"m2_cli",path:"app/"+($_bof_config.production?"minified/":"")+"bof_muse2_cli.js",skipNameCheck:!0,}),window.bof._loadExtension({name:"m2_queue",path:"app/"+($_bof_config.production?"minified/":"")+"bof_muse2_queue.js",}),window.bof._loadExtension({name:"m2_source",path:"app/"+($_bof_config.production?"minified/":"")+"bof_muse2_source.js",}),window.bof._loadExtension({name:"m2_thingie",path:"app/"+($_bof_config.production?"minified/":"")+"bof_muse2_thingie.js",}),window.bof._loadExtension({name:"bof_offline",path:"app/"+($_bof_config.production?"minified/":"")+"bof_offline.js",}),window.bof._loadExtension({name:"bof_offline_cli",path:"app/"+($_bof_config.production?"minified/":"")+"bof_offline_cli.js",}),)}
_promises.done(function(){muse.resolve()}).fail(function(){muse.reject()})}
return $.when(muse,general)},events:{page_unloading:function(){window.pageBuilder.widget.item.closeMenu();if(window.m2_queue)
window.m2_queue.ui.destroy();window.app.ui.playHead.unset();window.bof_input.unhook();window.bof_dropdown.close();window.app.actions.search.unhook()},page_ready:function(){if(window.m2_focus)
window.m2_focus.ui.hook()
window.pageBuilder.widget.item.listen();window.bof_input.hook();window.app.ads.hook();if($(document).find("#search_query").length){window.app.actions.search.ini()}
window.app.ui.actions.hideSliderArrows();if(window.ui.page.curr().data.becli?.single?.data?.head_play_title){window.app.ui.playHead.set(window.ui.page.curr().data.becli.single.data)}},page_rendering:function(){},}};if(window.config.web.address){window.config.web.address=window.config.web._formatize_url(window.config.web.address);window.config.web.prefix=new URL(window.config.web.address).pathname}
window.lang={cache:{},code:null,get:function(){var promise=$.Deferred();window.becli.exe({endpoint:"client_translations",liquid:!0,callBack:function(sta,data){if(sta){window.lang.cache=data.translations
window.lang.code=data.code
window.ui.body.removeClass("dir_rtl",!0).removeClass("dir_ltr",!0).addClass("dir_"+data.direction,!0);promise.resolve(data.translations)}else{promise.reject()}}});return promise},return:function($hook,$args){var cache=window.lang?(window.lang.cache?window.lang.cache:{}):{};var output=$hook+"?";if(cache[$hook]){output=cache[$hook];$args=$args?$args:{};if($args.ucfirst)
output=output.charAt(0).toUpperCase()+output.slice(1);}
return output}}
bof.load()